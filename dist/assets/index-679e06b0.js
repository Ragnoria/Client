var rf=Object.defineProperty;var nf=(t,e,s)=>e in t?rf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var G=(t,e,s)=>(nf(t,typeof e!="symbol"?e+"":e,s),s),Bl=(t,e,s)=>{if(!e.has(t))throw TypeError("Cannot "+s)};var ot=(t,e,s)=>(Bl(t,e,"read from private field"),s?s.call(t):e.get(t)),at=(t,e,s)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,s)};var Pt=(t,e,s)=>(Bl(t,e,"access private method"),s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function s(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(i){if(i.ep)return;i.ep=!0;const n=s(i);fetch(i.href,n)}})();function Ya(t,e){const s=Object.create(null),r=t.split(",");for(let i=0;i<r.length;i++)s[r[i]]=!0;return e?i=>!!s[i.toLowerCase()]:i=>!!s[i]}const Fe={},Sr=[],Ht=()=>{},of=()=>!1,af=/^on[^a-z]/,Jn=t=>af.test(t),Ja=t=>t.startsWith("onUpdate:"),it=Object.assign,el=(t,e)=>{const s=t.indexOf(e);s>-1&&t.splice(s,1)},lf=Object.prototype.hasOwnProperty,ye=(t,e)=>lf.call(t,e),ee=Array.isArray,Cr=t=>to(t)==="[object Map]",Ou=t=>to(t)==="[object Set]",ae=t=>typeof t=="function",Ge=t=>typeof t=="string",eo=t=>typeof t=="symbol",Be=t=>t!==null&&typeof t=="object",Mu=t=>(Be(t)||ae(t))&&ae(t.then)&&ae(t.catch),Nu=Object.prototype.toString,to=t=>Nu.call(t),hf=t=>to(t).slice(8,-1),Bu=t=>to(t)==="[object Object]",tl=t=>Ge(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,hn=Ya(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),so=t=>{const e=Object.create(null);return s=>e[s]||(e[s]=t(s))},uf=/-(\w)/g,ss=so(t=>t.replace(uf,(e,s)=>s?s.toUpperCase():"")),cf=/\B([A-Z])/g,Vr=so(t=>t.replace(cf,"-$1").toLowerCase()),ro=so(t=>t.charAt(0).toUpperCase()+t.slice(1)),go=so(t=>t?`on${ro(t)}`:""),Br=(t,e)=>!Object.is(t,e),vo=(t,e)=>{for(let s=0;s<t.length;s++)t[s](e)},xn=(t,e,s)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:s})},df=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let Ll;const ea=()=>Ll||(Ll=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function er(t){if(ee(t)){const e={};for(let s=0;s<t.length;s++){const r=t[s],i=Ge(r)?yf(r):er(r);if(i)for(const n in i)e[n]=i[n]}return e}else if(Ge(t)||Be(t))return t}const ff=/;(?![^(]*\))/g,pf=/:([^]+)/,mf=/\/\*[^]*?\*\//g;function yf(t){const e={};return t.replace(mf,"").split(ff).forEach(s=>{if(s){const r=s.split(pf);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function ki(t){let e="";if(Ge(t))e=t;else if(ee(t))for(let s=0;s<t.length;s++){const r=ki(t[s]);r&&(e+=r+" ")}else if(Be(t))for(const s in t)t[s]&&(e+=s+" ");return e.trim()}const gf="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",vf=Ya(gf);function Lu(t){return!!t||t===""}const fr=t=>Ge(t)?t:t==null?"":ee(t)||Be(t)&&(t.toString===Nu||!ae(t.toString))?JSON.stringify(t,ku,2):String(t),ku=(t,e)=>e&&e.__v_isRef?ku(t,e.value):Cr(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((s,[r,i])=>(s[`${r} =>`]=i,s),{})}:Ou(e)?{[`Set(${e.size})`]:[...e.values()]}:Be(e)&&!ee(e)&&!Bu(e)?String(e):e;let Mt;class _f{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Mt,!e&&Mt&&(this.index=(Mt.scopes||(Mt.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const s=Mt;try{return Mt=this,e()}finally{Mt=s}}}on(){Mt=this}off(){Mt=this.parent}stop(e){if(this._active){let s,r;for(s=0,r=this.effects.length;s<r;s++)this.effects[s].stop();for(s=0,r=this.cleanups.length;s<r;s++)this.cleanups[s]();if(this.scopes)for(s=0,r=this.scopes.length;s<r;s++)this.scopes[s].stop(!0);if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0,this._active=!1}}}function bf(t,e=Mt){e&&e.active&&e.effects.push(t)}function xf(){return Mt}const sl=t=>{const e=new Set(t);return e.w=0,e.n=0,e},Uu=t=>(t.w&Es)>0,Du=t=>(t.n&Es)>0,Af=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=Es},Tf=t=>{const{deps:e}=t;if(e.length){let s=0;for(let r=0;r<e.length;r++){const i=e[r];Uu(i)&&!Du(i)?i.delete(t):e[s++]=i,i.w&=~Es,i.n&=~Es}e.length=s}},ta=new WeakMap;let ri=0,Es=1;const sa=30;let Lt;const Ks=Symbol(""),ra=Symbol("");class rl{constructor(e,s=null,r){this.fn=e,this.scheduler=s,this.active=!0,this.deps=[],this.parent=void 0,bf(this,r)}run(){if(!this.active)return this.fn();let e=Lt,s=As;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=Lt,Lt=this,As=!0,Es=1<<++ri,ri<=sa?Af(this):kl(this),this.fn()}finally{ri<=sa&&Tf(this),Es=1<<--ri,Lt=this.parent,As=s,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Lt===this?this.deferStop=!0:this.active&&(kl(this),this.onStop&&this.onStop(),this.active=!1)}}function kl(t){const{deps:e}=t;if(e.length){for(let s=0;s<e.length;s++)e[s].delete(t);e.length=0}}let As=!0;const Gu=[];function qr(){Gu.push(As),As=!1}function Wr(){const t=Gu.pop();As=t===void 0?!0:t}function mt(t,e,s){if(As&&Lt){let r=ta.get(t);r||ta.set(t,r=new Map);let i=r.get(s);i||r.set(s,i=sl()),Hu(i)}}function Hu(t,e){let s=!1;ri<=sa?Du(t)||(t.n|=Es,s=!Uu(t)):s=!t.has(Lt),s&&(t.add(Lt),Lt.deps.push(t))}function us(t,e,s,r,i,n){const o=ta.get(t);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(s==="length"&&ee(t)){const l=Number(r);o.forEach((h,u)=>{(u==="length"||!eo(u)&&u>=l)&&a.push(h)})}else switch(s!==void 0&&a.push(o.get(s)),e){case"add":ee(t)?tl(s)&&a.push(o.get("length")):(a.push(o.get(Ks)),Cr(t)&&a.push(o.get(ra)));break;case"delete":ee(t)||(a.push(o.get(Ks)),Cr(t)&&a.push(o.get(ra)));break;case"set":Cr(t)&&a.push(o.get(Ks));break}if(a.length===1)a[0]&&ia(a[0]);else{const l=[];for(const h of a)h&&l.push(...h);ia(sl(l))}}function ia(t,e){const s=ee(t)?t:[...t];for(const r of s)r.computed&&Ul(r);for(const r of s)r.computed||Ul(r)}function Ul(t,e){(t!==Lt||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const wf=Ya("__proto__,__v_isRef,__isVue"),$u=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(eo)),Dl=Ef();function Ef(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...s){const r=Te(this);for(let n=0,o=this.length;n<o;n++)mt(r,"get",n+"");const i=r[e](...s);return i===-1||i===!1?r[e](...s.map(Te)):i}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...s){qr();const r=Te(this)[e].apply(this,s);return Wr(),r}}),t}function If(t){const e=Te(this);return mt(e,"has",t),e.hasOwnProperty(t)}class Vu{constructor(e=!1,s=!1){this._isReadonly=e,this._shallow=s}get(e,s,r){const i=this._isReadonly,n=this._shallow;if(s==="__v_isReactive")return!i;if(s==="__v_isReadonly")return i;if(s==="__v_isShallow")return n;if(s==="__v_raw"&&r===(i?n?Df:zu:n?ju:Wu).get(e))return e;const o=ee(e);if(!i){if(o&&ye(Dl,s))return Reflect.get(Dl,s,r);if(s==="hasOwnProperty")return If}const a=Reflect.get(e,s,r);return(eo(s)?$u.has(s):wf(s))||(i||mt(e,"get",s),n)?a:ut(a)?o&&tl(s)?a:a.value:Be(a)?i?Xu(a):ol(a):a}}class qu extends Vu{constructor(e=!1){super(!1,e)}set(e,s,r,i){let n=e[s];if(bi(n)&&ut(n)&&!ut(r))return!1;if(!this._shallow&&(!na(r)&&!bi(r)&&(n=Te(n),r=Te(r)),!ee(e)&&ut(n)&&!ut(r)))return n.value=r,!0;const o=ee(e)&&tl(s)?Number(s)<e.length:ye(e,s),a=Reflect.set(e,s,r,i);return e===Te(i)&&(o?Br(r,n)&&us(e,"set",s,r):us(e,"add",s,r)),a}deleteProperty(e,s){const r=ye(e,s);e[s];const i=Reflect.deleteProperty(e,s);return i&&r&&us(e,"delete",s,void 0),i}has(e,s){const r=Reflect.has(e,s);return(!eo(s)||!$u.has(s))&&mt(e,"has",s),r}ownKeys(e){return mt(e,"iterate",ee(e)?"length":Ks),Reflect.ownKeys(e)}}class Sf extends Vu{constructor(e=!1){super(!0,e)}set(e,s){return!0}deleteProperty(e,s){return!0}}const Cf=new qu,Rf=new Sf,Pf=new qu(!0),il=t=>t,io=t=>Reflect.getPrototypeOf(t);function Di(t,e,s=!1,r=!1){t=t.__v_raw;const i=Te(t),n=Te(e);s||(Br(e,n)&&mt(i,"get",e),mt(i,"get",n));const{has:o}=io(i),a=r?il:s?hl:ll;if(o.call(i,e))return a(t.get(e));if(o.call(i,n))return a(t.get(n));t!==i&&t.get(e)}function Gi(t,e=!1){const s=this.__v_raw,r=Te(s),i=Te(t);return e||(Br(t,i)&&mt(r,"has",t),mt(r,"has",i)),t===i?s.has(t):s.has(t)||s.has(i)}function Hi(t,e=!1){return t=t.__v_raw,!e&&mt(Te(t),"iterate",Ks),Reflect.get(t,"size",t)}function Gl(t){t=Te(t);const e=Te(this);return io(e).has.call(e,t)||(e.add(t),us(e,"add",t,t)),this}function Hl(t,e){e=Te(e);const s=Te(this),{has:r,get:i}=io(s);let n=r.call(s,t);n||(t=Te(t),n=r.call(s,t));const o=i.call(s,t);return s.set(t,e),n?Br(e,o)&&us(s,"set",t,e):us(s,"add",t,e),this}function $l(t){const e=Te(this),{has:s,get:r}=io(e);let i=s.call(e,t);i||(t=Te(t),i=s.call(e,t)),r&&r.call(e,t);const n=e.delete(t);return i&&us(e,"delete",t,void 0),n}function Vl(){const t=Te(this),e=t.size!==0,s=t.clear();return e&&us(t,"clear",void 0,void 0),s}function $i(t,e){return function(r,i){const n=this,o=n.__v_raw,a=Te(o),l=e?il:t?hl:ll;return!t&&mt(a,"iterate",Ks),o.forEach((h,u)=>r.call(i,l(h),l(u),n))}}function Vi(t,e,s){return function(...r){const i=this.__v_raw,n=Te(i),o=Cr(n),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,h=i[t](...r),u=s?il:e?hl:ll;return!e&&mt(n,"iterate",l?ra:Ks),{next(){const{value:c,done:d}=h.next();return d?{value:c,done:d}:{value:a?[u(c[0]),u(c[1])]:u(c),done:d}},[Symbol.iterator](){return this}}}}function ps(t){return function(...e){return t==="delete"?!1:this}}function Ff(){const t={get(n){return Di(this,n)},get size(){return Hi(this)},has:Gi,add:Gl,set:Hl,delete:$l,clear:Vl,forEach:$i(!1,!1)},e={get(n){return Di(this,n,!1,!0)},get size(){return Hi(this)},has:Gi,add:Gl,set:Hl,delete:$l,clear:Vl,forEach:$i(!1,!0)},s={get(n){return Di(this,n,!0)},get size(){return Hi(this,!0)},has(n){return Gi.call(this,n,!0)},add:ps("add"),set:ps("set"),delete:ps("delete"),clear:ps("clear"),forEach:$i(!0,!1)},r={get(n){return Di(this,n,!0,!0)},get size(){return Hi(this,!0)},has(n){return Gi.call(this,n,!0)},add:ps("add"),set:ps("set"),delete:ps("delete"),clear:ps("clear"),forEach:$i(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(n=>{t[n]=Vi(n,!1,!1),s[n]=Vi(n,!0,!1),e[n]=Vi(n,!1,!0),r[n]=Vi(n,!0,!0)}),[t,s,e,r]}const[Of,Mf,Nf,Bf]=Ff();function nl(t,e){const s=e?t?Bf:Nf:t?Mf:Of;return(r,i,n)=>i==="__v_isReactive"?!t:i==="__v_isReadonly"?t:i==="__v_raw"?r:Reflect.get(ye(s,i)&&i in r?s:r,i,n)}const Lf={get:nl(!1,!1)},kf={get:nl(!1,!0)},Uf={get:nl(!0,!1)},Wu=new WeakMap,ju=new WeakMap,zu=new WeakMap,Df=new WeakMap;function Gf(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Hf(t){return t.__v_skip||!Object.isExtensible(t)?0:Gf(hf(t))}function ol(t){return bi(t)?t:al(t,!1,Cf,Lf,Wu)}function $f(t){return al(t,!1,Pf,kf,ju)}function Xu(t){return al(t,!0,Rf,Uf,zu)}function al(t,e,s,r,i){if(!Be(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const n=i.get(t);if(n)return n;const o=Hf(t);if(o===0)return t;const a=new Proxy(t,o===2?r:s);return i.set(t,a),a}function Rr(t){return bi(t)?Rr(t.__v_raw):!!(t&&t.__v_isReactive)}function bi(t){return!!(t&&t.__v_isReadonly)}function na(t){return!!(t&&t.__v_isShallow)}function Ku(t){return Rr(t)||bi(t)}function Te(t){const e=t&&t.__v_raw;return e?Te(e):t}function Zu(t){return xn(t,"__v_skip",!0),t}const ll=t=>Be(t)?ol(t):t,hl=t=>Be(t)?Xu(t):t;function Vf(t){As&&Lt&&(t=Te(t),Hu(t.dep||(t.dep=sl())))}function qf(t,e){t=Te(t);const s=t.dep;s&&ia(s)}function ut(t){return!!(t&&t.__v_isRef===!0)}function Wf(t){return ut(t)?t.value:t}const jf={get:(t,e,s)=>Wf(Reflect.get(t,e,s)),set:(t,e,s,r)=>{const i=t[e];return ut(i)&&!ut(s)?(i.value=s,!0):Reflect.set(t,e,s,r)}};function Qu(t){return Rr(t)?t:new Proxy(t,jf)}class zf{constructor(e,s,r,i){this._setter=s,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new rl(e,()=>{this._dirty||(this._dirty=!0,qf(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=r}get value(){const e=Te(this);return Vf(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function Xf(t,e,s=!1){let r,i;const n=ae(t);return n?(r=t,i=Ht):(r=t.get,i=t.set),new zf(r,i,n||!i,s)}function Ts(t,e,s,r){let i;try{i=r?t(...r):t()}catch(n){no(n,e,s)}return i}function $t(t,e,s,r){if(ae(t)){const n=Ts(t,e,s,r);return n&&Mu(n)&&n.catch(o=>{no(o,e,s)}),n}const i=[];for(let n=0;n<t.length;n++)i.push($t(t[n],e,s,r));return i}function no(t,e,s,r=!0){const i=e?e.vnode:null;if(e){let n=e.parent;const o=e.proxy,a=s;for(;n;){const h=n.ec;if(h){for(let u=0;u<h.length;u++)if(h[u](t,o,a)===!1)return}n=n.parent}const l=e.appContext.config.errorHandler;if(l){Ts(l,null,10,[t,o,a]);return}}Kf(t,s,i,r)}function Kf(t,e,s,r=!0){console.error(t)}let xi=!1,oa=!1;const rt=[];let Qt=0;const Pr=[];let as=null,Gs=0;const Yu=Promise.resolve();let ul=null;function Zf(t){const e=ul||Yu;return t?e.then(this?t.bind(this):t):e}function Qf(t){let e=Qt+1,s=rt.length;for(;e<s;){const r=e+s>>>1,i=rt[r],n=Ai(i);n<t||n===t&&i.pre?e=r+1:s=r}return e}function cl(t){(!rt.length||!rt.includes(t,xi&&t.allowRecurse?Qt+1:Qt))&&(t.id==null?rt.push(t):rt.splice(Qf(t.id),0,t),Ju())}function Ju(){!xi&&!oa&&(oa=!0,ul=Yu.then(tc))}function Yf(t){const e=rt.indexOf(t);e>Qt&&rt.splice(e,1)}function Jf(t){ee(t)?Pr.push(...t):(!as||!as.includes(t,t.allowRecurse?Gs+1:Gs))&&Pr.push(t),Ju()}function ql(t,e=xi?Qt+1:0){for(;e<rt.length;e++){const s=rt[e];s&&s.pre&&(rt.splice(e,1),e--,s())}}function ec(t){if(Pr.length){const e=[...new Set(Pr)];if(Pr.length=0,as){as.push(...e);return}for(as=e,as.sort((s,r)=>Ai(s)-Ai(r)),Gs=0;Gs<as.length;Gs++)as[Gs]();as=null,Gs=0}}const Ai=t=>t.id==null?1/0:t.id,ep=(t,e)=>{const s=Ai(t)-Ai(e);if(s===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return s};function tc(t){oa=!1,xi=!0,rt.sort(ep);const e=Ht;try{for(Qt=0;Qt<rt.length;Qt++){const s=rt[Qt];s&&s.active!==!1&&Ts(s,null,14)}}finally{Qt=0,rt.length=0,ec(),xi=!1,ul=null,(rt.length||Pr.length)&&tc()}}function tp(t,e,...s){if(t.isUnmounted)return;const r=t.vnode.props||Fe;let i=s;const n=e.startsWith("update:"),o=n&&e.slice(7);if(o&&o in r){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:c,trim:d}=r[u]||Fe;d&&(i=s.map(p=>Ge(p)?p.trim():p)),c&&(i=s.map(df))}let a,l=r[a=go(e)]||r[a=go(ss(e))];!l&&n&&(l=r[a=go(Vr(e))]),l&&$t(l,t,6,i);const h=r[a+"Once"];if(h){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,$t(h,t,6,i)}}function sc(t,e,s=!1){const r=e.emitsCache,i=r.get(t);if(i!==void 0)return i;const n=t.emits;let o={},a=!1;if(!ae(t)){const l=h=>{const u=sc(h,e,!0);u&&(a=!0,it(o,u))};!s&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!n&&!a?(Be(t)&&r.set(t,null),null):(ee(n)?n.forEach(l=>o[l]=null):it(o,n),Be(t)&&r.set(t,o),o)}function oo(t,e){return!t||!Jn(e)?!1:(e=e.slice(2).replace(/Once$/,""),ye(t,e[0].toLowerCase()+e.slice(1))||ye(t,Vr(e))||ye(t,e))}let Ut=null,rc=null;function An(t){const e=Ut;return Ut=t,rc=t&&t.type.__scopeId||null,e}function sp(t,e=Ut,s){if(!e||t._n)return t;const r=(...i)=>{r._d&&th(-1);const n=An(e);let o;try{o=t(...i)}finally{An(n),r._d&&th(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function _o(t){const{type:e,vnode:s,proxy:r,withProxy:i,props:n,propsOptions:[o],slots:a,attrs:l,emit:h,render:u,renderCache:c,data:d,setupState:p,ctx:_,inheritAttrs:w}=t;let E,y;const v=An(t);try{if(s.shapeFlag&4){const b=i||r;E=Kt(u.call(b,b,c,n,p,d,_)),y=l}else{const b=e;E=Kt(b.length>1?b(n,{attrs:l,slots:a,emit:h}):b(n,null)),y=e.props?l:rp(l)}}catch(b){di.length=0,no(b,t,1),E=se(tr)}let g=E;if(y&&w!==!1){const b=Object.keys(y),{shapeFlag:T}=g;b.length&&T&7&&(o&&b.some(Ja)&&(y=ip(y,o)),g=Lr(g,y))}return s.dirs&&(g=Lr(g),g.dirs=g.dirs?g.dirs.concat(s.dirs):s.dirs),s.transition&&(g.transition=s.transition),E=g,An(v),E}const rp=t=>{let e;for(const s in t)(s==="class"||s==="style"||Jn(s))&&((e||(e={}))[s]=t[s]);return e},ip=(t,e)=>{const s={};for(const r in t)(!Ja(r)||!(r.slice(9)in e))&&(s[r]=t[r]);return s};function np(t,e,s){const{props:r,children:i,component:n}=t,{props:o,children:a,patchFlag:l}=e,h=n.emitsOptions;if(e.dirs||e.transition)return!0;if(s&&l>=0){if(l&1024)return!0;if(l&16)return r?Wl(r,o,h):!!o;if(l&8){const u=e.dynamicProps;for(let c=0;c<u.length;c++){const d=u[c];if(o[d]!==r[d]&&!oo(h,d))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?Wl(r,o,h):!0:!!o;return!1}function Wl(t,e,s){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let i=0;i<r.length;i++){const n=r[i];if(e[n]!==t[n]&&!oo(s,n))return!0}return!1}function op({vnode:t,parent:e},s){for(;e&&e.subTree===t;)(t=e.vnode).el=s,e=e.parent}const ap=t=>t.__isSuspense;function lp(t,e){e&&e.pendingBranch?ee(t)?e.effects.push(...t):e.effects.push(t):Jf(t)}const qi={};function bo(t,e,s){return ic(t,e,s)}function ic(t,e,{immediate:s,deep:r,flush:i,onTrack:n,onTrigger:o}=Fe){var a;const l=xf()===((a=Qe)==null?void 0:a.scope)?Qe:null;let h,u=!1,c=!1;if(ut(t)?(h=()=>t.value,u=na(t)):Rr(t)?(h=()=>t,r=!0):ee(t)?(c=!0,u=t.some(b=>Rr(b)||na(b)),h=()=>t.map(b=>{if(ut(b))return b.value;if(Rr(b))return xr(b);if(ae(b))return Ts(b,l,2)})):ae(t)?e?h=()=>Ts(t,l,2):h=()=>{if(!(l&&l.isUnmounted))return d&&d(),$t(t,l,3,[p])}:h=Ht,e&&r){const b=h;h=()=>xr(b())}let d,p=b=>{d=v.onStop=()=>{Ts(b,l,4)}},_;if(wi)if(p=Ht,e?s&&$t(e,l,3,[h(),c?[]:void 0,p]):h(),i==="sync"){const b=am();_=b.__watcherHandles||(b.__watcherHandles=[])}else return Ht;let w=c?new Array(t.length).fill(qi):qi;const E=()=>{if(v.active)if(e){const b=v.run();(r||u||(c?b.some((T,A)=>Br(T,w[A])):Br(b,w)))&&(d&&d(),$t(e,l,3,[b,w===qi?void 0:c&&w[0]===qi?[]:w,p]),w=b)}else v.run()};E.allowRecurse=!!e;let y;i==="sync"?y=E:i==="post"?y=()=>pt(E,l&&l.suspense):(E.pre=!0,l&&(E.id=l.uid),y=()=>cl(E));const v=new rl(h,y);e?s?E():w=v.run():i==="post"?pt(v.run.bind(v),l&&l.suspense):v.run();const g=()=>{v.stop(),l&&l.scope&&el(l.scope.effects,v)};return _&&_.push(g),g}function hp(t,e,s){const r=this.proxy,i=Ge(t)?t.includes(".")?nc(r,t):()=>r[t]:t.bind(r,r);let n;ae(e)?n=e:(n=e.handler,s=e);const o=Qe;kr(this);const a=ic(i,n.bind(r),s);return o?kr(o):Zs(),a}function nc(t,e){const s=e.split(".");return()=>{let r=t;for(let i=0;i<s.length&&r;i++)r=r[s[i]];return r}}function xr(t,e){if(!Be(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),ut(t))xr(t.value,e);else if(ee(t))for(let s=0;s<t.length;s++)xr(t[s],e);else if(Ou(t)||Cr(t))t.forEach(s=>{xr(s,e)});else if(Bu(t))for(const s in t)xr(t[s],e);return t}function Ps(t,e,s,r){const i=t.dirs,n=e&&e.dirs;for(let o=0;o<i.length;o++){const a=i[o];n&&(a.oldValue=n[o].value);let l=a.dir[r];l&&(qr(),$t(l,s,8,[t.el,a,t,e]),Wr())}}const un=t=>!!t.type.__asyncLoader,oc=t=>t.type.__isKeepAlive;function up(t,e){ac(t,"a",e)}function cp(t,e){ac(t,"da",e)}function ac(t,e,s=Qe){const r=t.__wdc||(t.__wdc=()=>{let i=s;for(;i;){if(i.isDeactivated)return;i=i.parent}return t()});if(ao(e,r,s),s){let i=s.parent;for(;i&&i.parent;)oc(i.parent.vnode)&&dp(r,e,s,i),i=i.parent}}function dp(t,e,s,r){const i=ao(e,t,r,!0);lc(()=>{el(r[e],i)},s)}function ao(t,e,s=Qe,r=!1){if(s){const i=s[t]||(s[t]=[]),n=e.__weh||(e.__weh=(...o)=>{if(s.isUnmounted)return;qr(),kr(s);const a=$t(e,s,t,o);return Zs(),Wr(),a});return r?i.unshift(n):i.push(n),n}}const fs=t=>(e,s=Qe)=>(!wi||t==="sp")&&ao(t,(...r)=>e(...r),s),fp=fs("bm"),pp=fs("m"),mp=fs("bu"),yp=fs("u"),gp=fs("bum"),lc=fs("um"),vp=fs("sp"),_p=fs("rtg"),bp=fs("rtc");function xp(t,e=Qe){ao("ec",t,e)}const hc="components";function Hs(t,e){return Tp(hc,t,!0,e)||t}const Ap=Symbol.for("v-ndc");function Tp(t,e,s=!0,r=!1){const i=Ut||Qe;if(i){const n=i.type;if(t===hc){const a=rm(n,!1);if(a&&(a===e||a===ss(e)||a===ro(ss(e))))return n}const o=jl(i[t]||n[t],e)||jl(i.appContext[t],e);return!o&&r?n:o}}function jl(t,e){return t&&(t[e]||t[ss(e)]||t[ro(ss(e))])}function wp(t,e,s,r){let i;const n=s&&s[r];if(ee(t)||Ge(t)){i=new Array(t.length);for(let o=0,a=t.length;o<a;o++)i[o]=e(t[o],o,void 0,n&&n[o])}else if(typeof t=="number"){i=new Array(t);for(let o=0;o<t;o++)i[o]=e(o+1,o,void 0,n&&n[o])}else if(Be(t))if(t[Symbol.iterator])i=Array.from(t,(o,a)=>e(o,a,void 0,n&&n[a]));else{const o=Object.keys(t);i=new Array(o.length);for(let a=0,l=o.length;a<l;a++){const h=o[a];i[a]=e(t[h],h,a,n&&n[a])}}else i=[];return s&&(s[r]=i),i}const aa=t=>t?bc(t)?yl(t)||t.proxy:aa(t.parent):null,ci=it(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>aa(t.parent),$root:t=>aa(t.root),$emit:t=>t.emit,$options:t=>dl(t),$forceUpdate:t=>t.f||(t.f=()=>cl(t.update)),$nextTick:t=>t.n||(t.n=Zf.bind(t.proxy)),$watch:t=>hp.bind(t)}),xo=(t,e)=>t!==Fe&&!t.__isScriptSetup&&ye(t,e),Ep={get({_:t},e){const{ctx:s,setupState:r,data:i,props:n,accessCache:o,type:a,appContext:l}=t;let h;if(e[0]!=="$"){const p=o[e];if(p!==void 0)switch(p){case 1:return r[e];case 2:return i[e];case 4:return s[e];case 3:return n[e]}else{if(xo(r,e))return o[e]=1,r[e];if(i!==Fe&&ye(i,e))return o[e]=2,i[e];if((h=t.propsOptions[0])&&ye(h,e))return o[e]=3,n[e];if(s!==Fe&&ye(s,e))return o[e]=4,s[e];la&&(o[e]=0)}}const u=ci[e];let c,d;if(u)return e==="$attrs"&&mt(t,"get",e),u(t);if((c=a.__cssModules)&&(c=c[e]))return c;if(s!==Fe&&ye(s,e))return o[e]=4,s[e];if(d=l.config.globalProperties,ye(d,e))return d[e]},set({_:t},e,s){const{data:r,setupState:i,ctx:n}=t;return xo(i,e)?(i[e]=s,!0):r!==Fe&&ye(r,e)?(r[e]=s,!0):ye(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(n[e]=s,!0)},has({_:{data:t,setupState:e,accessCache:s,ctx:r,appContext:i,propsOptions:n}},o){let a;return!!s[o]||t!==Fe&&ye(t,o)||xo(e,o)||(a=n[0])&&ye(a,o)||ye(r,o)||ye(ci,o)||ye(i.config.globalProperties,o)},defineProperty(t,e,s){return s.get!=null?t._.accessCache[e]=0:ye(s,"value")&&this.set(t,e,s.value,null),Reflect.defineProperty(t,e,s)}};function zl(t){return ee(t)?t.reduce((e,s)=>(e[s]=null,e),{}):t}let la=!0;function Ip(t){const e=dl(t),s=t.proxy,r=t.ctx;la=!1,e.beforeCreate&&Xl(e.beforeCreate,t,"bc");const{data:i,computed:n,methods:o,watch:a,provide:l,inject:h,created:u,beforeMount:c,mounted:d,beforeUpdate:p,updated:_,activated:w,deactivated:E,beforeDestroy:y,beforeUnmount:v,destroyed:g,unmounted:b,render:T,renderTracked:A,renderTriggered:x,errorCaptured:N,serverPrefetch:V,expose:W,inheritAttrs:ue,components:ie,directives:be,filters:fe}=e;if(h&&Sp(h,r,null),o)for(const Ae in o){const we=o[Ae];ae(we)&&(r[Ae]=we.bind(s))}if(i){const Ae=i.call(s,s);Be(Ae)&&(t.data=ol(Ae))}if(la=!0,n)for(const Ae in n){const we=n[Ae],rs=ae(we)?we.bind(s,s):ae(we.get)?we.get.bind(s,s):Ht,q=!ae(we)&&ae(we.set)?we.set.bind(s):Ht,Z=nm({get:rs,set:q});Object.defineProperty(r,Ae,{enumerable:!0,configurable:!0,get:()=>Z.value,set:re=>Z.value=re})}if(a)for(const Ae in a)uc(a[Ae],r,s,Ae);if(l){const Ae=ae(l)?l.call(s):l;Reflect.ownKeys(Ae).forEach(we=>{Mp(we,Ae[we])})}u&&Xl(u,t,"c");function pe(Ae,we){ee(we)?we.forEach(rs=>Ae(rs.bind(s))):we&&Ae(we.bind(s))}if(pe(fp,c),pe(pp,d),pe(mp,p),pe(yp,_),pe(up,w),pe(cp,E),pe(xp,N),pe(bp,A),pe(_p,x),pe(gp,v),pe(lc,b),pe(vp,V),ee(W))if(W.length){const Ae=t.exposed||(t.exposed={});W.forEach(we=>{Object.defineProperty(Ae,we,{get:()=>s[we],set:rs=>s[we]=rs})})}else t.exposed||(t.exposed={});T&&t.render===Ht&&(t.render=T),ue!=null&&(t.inheritAttrs=ue),ie&&(t.components=ie),be&&(t.directives=be)}function Sp(t,e,s=Ht){ee(t)&&(t=ha(t));for(const r in t){const i=t[r];let n;Be(i)?"default"in i?n=cn(i.from||r,i.default,!0):n=cn(i.from||r):n=cn(i),ut(n)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>n.value,set:o=>n.value=o}):e[r]=n}}function Xl(t,e,s){$t(ee(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,s)}function uc(t,e,s,r){const i=r.includes(".")?nc(s,r):()=>s[r];if(Ge(t)){const n=e[t];ae(n)&&bo(i,n)}else if(ae(t))bo(i,t.bind(s));else if(Be(t))if(ee(t))t.forEach(n=>uc(n,e,s,r));else{const n=ae(t.handler)?t.handler.bind(s):e[t.handler];ae(n)&&bo(i,n,t)}}function dl(t){const e=t.type,{mixins:s,extends:r}=e,{mixins:i,optionsCache:n,config:{optionMergeStrategies:o}}=t.appContext,a=n.get(e);let l;return a?l=a:!i.length&&!s&&!r?l=e:(l={},i.length&&i.forEach(h=>Tn(l,h,o,!0)),Tn(l,e,o)),Be(e)&&n.set(e,l),l}function Tn(t,e,s,r=!1){const{mixins:i,extends:n}=e;n&&Tn(t,n,s,!0),i&&i.forEach(o=>Tn(t,o,s,!0));for(const o in e)if(!(r&&o==="expose")){const a=Cp[o]||s&&s[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const Cp={data:Kl,props:Zl,emits:Zl,methods:ii,computed:ii,beforeCreate:lt,created:lt,beforeMount:lt,mounted:lt,beforeUpdate:lt,updated:lt,beforeDestroy:lt,beforeUnmount:lt,destroyed:lt,unmounted:lt,activated:lt,deactivated:lt,errorCaptured:lt,serverPrefetch:lt,components:ii,directives:ii,watch:Pp,provide:Kl,inject:Rp};function Kl(t,e){return e?t?function(){return it(ae(t)?t.call(this,this):t,ae(e)?e.call(this,this):e)}:e:t}function Rp(t,e){return ii(ha(t),ha(e))}function ha(t){if(ee(t)){const e={};for(let s=0;s<t.length;s++)e[t[s]]=t[s];return e}return t}function lt(t,e){return t?[...new Set([].concat(t,e))]:e}function ii(t,e){return t?it(Object.create(null),t,e):e}function Zl(t,e){return t?ee(t)&&ee(e)?[...new Set([...t,...e])]:it(Object.create(null),zl(t),zl(e??{})):e}function Pp(t,e){if(!t)return e;if(!e)return t;const s=it(Object.create(null),t);for(const r in e)s[r]=lt(t[r],e[r]);return s}function cc(){return{app:null,config:{isNativeTag:of,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Fp=0;function Op(t,e){return function(r,i=null){ae(r)||(r=it({},r)),i!=null&&!Be(i)&&(i=null);const n=cc(),o=new WeakSet;let a=!1;const l=n.app={_uid:Fp++,_component:r,_props:i,_container:null,_context:n,_instance:null,version:lm,get config(){return n.config},set config(h){},use(h,...u){return o.has(h)||(h&&ae(h.install)?(o.add(h),h.install(l,...u)):ae(h)&&(o.add(h),h(l,...u))),l},mixin(h){return n.mixins.includes(h)||n.mixins.push(h),l},component(h,u){return u?(n.components[h]=u,l):n.components[h]},directive(h,u){return u?(n.directives[h]=u,l):n.directives[h]},mount(h,u,c){if(!a){const d=se(r,i);return d.appContext=n,u&&e?e(d,h):t(d,h,c),a=!0,l._container=h,h.__vue_app__=l,yl(d.component)||d.component.proxy}},unmount(){a&&(t(null,l._container),delete l._container.__vue_app__)},provide(h,u){return n.provides[h]=u,l},runWithContext(h){wn=l;try{return h()}finally{wn=null}}};return l}}let wn=null;function Mp(t,e){if(Qe){let s=Qe.provides;const r=Qe.parent&&Qe.parent.provides;r===s&&(s=Qe.provides=Object.create(r)),s[t]=e}}function cn(t,e,s=!1){const r=Qe||Ut;if(r||wn){const i=r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:wn._context.provides;if(i&&t in i)return i[t];if(arguments.length>1)return s&&ae(e)?e.call(r&&r.proxy):e}}function Np(t,e,s,r=!1){const i={},n={};xn(n,ho,1),t.propsDefaults=Object.create(null),dc(t,e,i,n);for(const o in t.propsOptions[0])o in i||(i[o]=void 0);s?t.props=r?i:$f(i):t.type.props?t.props=i:t.props=n,t.attrs=n}function Bp(t,e,s,r){const{props:i,attrs:n,vnode:{patchFlag:o}}=t,a=Te(i),[l]=t.propsOptions;let h=!1;if((r||o>0)&&!(o&16)){if(o&8){const u=t.vnode.dynamicProps;for(let c=0;c<u.length;c++){let d=u[c];if(oo(t.emitsOptions,d))continue;const p=e[d];if(l)if(ye(n,d))p!==n[d]&&(n[d]=p,h=!0);else{const _=ss(d);i[_]=ua(l,a,_,p,t,!1)}else p!==n[d]&&(n[d]=p,h=!0)}}}else{dc(t,e,i,n)&&(h=!0);let u;for(const c in a)(!e||!ye(e,c)&&((u=Vr(c))===c||!ye(e,u)))&&(l?s&&(s[c]!==void 0||s[u]!==void 0)&&(i[c]=ua(l,a,c,void 0,t,!0)):delete i[c]);if(n!==a)for(const c in n)(!e||!ye(e,c))&&(delete n[c],h=!0)}h&&us(t,"set","$attrs")}function dc(t,e,s,r){const[i,n]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(hn(l))continue;const h=e[l];let u;i&&ye(i,u=ss(l))?!n||!n.includes(u)?s[u]=h:(a||(a={}))[u]=h:oo(t.emitsOptions,l)||(!(l in r)||h!==r[l])&&(r[l]=h,o=!0)}if(n){const l=Te(s),h=a||Fe;for(let u=0;u<n.length;u++){const c=n[u];s[c]=ua(i,l,c,h[c],t,!ye(h,c))}}return o}function ua(t,e,s,r,i,n){const o=t[s];if(o!=null){const a=ye(o,"default");if(a&&r===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&ae(l)){const{propsDefaults:h}=i;s in h?r=h[s]:(kr(i),r=h[s]=l.call(null,e),Zs())}else r=l}o[0]&&(n&&!a?r=!1:o[1]&&(r===""||r===Vr(s))&&(r=!0))}return r}function fc(t,e,s=!1){const r=e.propsCache,i=r.get(t);if(i)return i;const n=t.props,o={},a=[];let l=!1;if(!ae(t)){const u=c=>{l=!0;const[d,p]=fc(c,e,!0);it(o,d),p&&a.push(...p)};!s&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!n&&!l)return Be(t)&&r.set(t,Sr),Sr;if(ee(n))for(let u=0;u<n.length;u++){const c=ss(n[u]);Ql(c)&&(o[c]=Fe)}else if(n)for(const u in n){const c=ss(u);if(Ql(c)){const d=n[u],p=o[c]=ee(d)||ae(d)?{type:d}:it({},d);if(p){const _=eh(Boolean,p.type),w=eh(String,p.type);p[0]=_>-1,p[1]=w<0||_<w,(_>-1||ye(p,"default"))&&a.push(c)}}}const h=[o,a];return Be(t)&&r.set(t,h),h}function Ql(t){return t[0]!=="$"}function Yl(t){const e=t&&t.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:t===null?"null":""}function Jl(t,e){return Yl(t)===Yl(e)}function eh(t,e){return ee(e)?e.findIndex(s=>Jl(s,t)):ae(e)&&Jl(e,t)?0:-1}const pc=t=>t[0]==="_"||t==="$stable",fl=t=>ee(t)?t.map(Kt):[Kt(t)],Lp=(t,e,s)=>{if(e._n)return e;const r=sp((...i)=>fl(e(...i)),s);return r._c=!1,r},mc=(t,e,s)=>{const r=t._ctx;for(const i in t){if(pc(i))continue;const n=t[i];if(ae(n))e[i]=Lp(i,n,r);else if(n!=null){const o=fl(n);e[i]=()=>o}}},yc=(t,e)=>{const s=fl(e);t.slots.default=()=>s},kp=(t,e)=>{if(t.vnode.shapeFlag&32){const s=e._;s?(t.slots=Te(e),xn(e,"_",s)):mc(e,t.slots={})}else t.slots={},e&&yc(t,e);xn(t.slots,ho,1)},Up=(t,e,s)=>{const{vnode:r,slots:i}=t;let n=!0,o=Fe;if(r.shapeFlag&32){const a=e._;a?s&&a===1?n=!1:(it(i,e),!s&&a===1&&delete i._):(n=!e.$stable,mc(e,i)),o=e}else e&&(yc(t,e),o={default:1});if(n)for(const a in i)!pc(a)&&o[a]==null&&delete i[a]};function ca(t,e,s,r,i=!1){if(ee(t)){t.forEach((d,p)=>ca(d,e&&(ee(e)?e[p]:e),s,r,i));return}if(un(r)&&!i)return;const n=r.shapeFlag&4?yl(r.component)||r.component.proxy:r.el,o=i?null:n,{i:a,r:l}=t,h=e&&e.r,u=a.refs===Fe?a.refs={}:a.refs,c=a.setupState;if(h!=null&&h!==l&&(Ge(h)?(u[h]=null,ye(c,h)&&(c[h]=null)):ut(h)&&(h.value=null)),ae(l))Ts(l,a,12,[o,u]);else{const d=Ge(l),p=ut(l);if(d||p){const _=()=>{if(t.f){const w=d?ye(c,l)?c[l]:u[l]:l.value;i?ee(w)&&el(w,n):ee(w)?w.includes(n)||w.push(n):d?(u[l]=[n],ye(c,l)&&(c[l]=u[l])):(l.value=[n],t.k&&(u[t.k]=l.value))}else d?(u[l]=o,ye(c,l)&&(c[l]=o)):p&&(l.value=o,t.k&&(u[t.k]=o))};o?(_.id=-1,pt(_,s)):_()}}}const pt=lp;function Dp(t){return Gp(t)}function Gp(t,e){const s=ea();s.__VUE__=!0;const{insert:r,remove:i,patchProp:n,createElement:o,createText:a,createComment:l,setText:h,setElementText:u,parentNode:c,nextSibling:d,setScopeId:p=Ht,insertStaticContent:_}=t,w=(f,m,I,S=null,C=null,O=null,k=!1,P=null,B=!!m.dynamicChildren)=>{if(f===m)return;f&&!Yr(f,m)&&(S=$e(f),re(f,C,O,!0),f=null),m.patchFlag===-2&&(B=!1,m.dynamicChildren=null);const{type:R,ref:j,shapeFlag:H}=m;switch(R){case lo:E(f,m,I,S);break;case tr:y(f,m,I,S);break;case Ao:f==null&&v(m,I,S,k);break;case xt:ie(f,m,I,S,C,O,k,P,B);break;default:H&1?T(f,m,I,S,C,O,k,P,B):H&6?be(f,m,I,S,C,O,k,P,B):(H&64||H&128)&&R.process(f,m,I,S,C,O,k,P,B,Ze)}j!=null&&C&&ca(j,f&&f.ref,O,m||f,!m)},E=(f,m,I,S)=>{if(f==null)r(m.el=a(m.children),I,S);else{const C=m.el=f.el;m.children!==f.children&&h(C,m.children)}},y=(f,m,I,S)=>{f==null?r(m.el=l(m.children||""),I,S):m.el=f.el},v=(f,m,I,S)=>{[f.el,f.anchor]=_(f.children,m,I,S,f.el,f.anchor)},g=({el:f,anchor:m},I,S)=>{let C;for(;f&&f!==m;)C=d(f),r(f,I,S),f=C;r(m,I,S)},b=({el:f,anchor:m})=>{let I;for(;f&&f!==m;)I=d(f),i(f),f=I;i(m)},T=(f,m,I,S,C,O,k,P,B)=>{k=k||m.type==="svg",f==null?A(m,I,S,C,O,k,P,B):V(f,m,C,O,k,P,B)},A=(f,m,I,S,C,O,k,P)=>{let B,R;const{type:j,props:H,shapeFlag:z,transition:te,dirs:ce}=f;if(B=f.el=o(f.type,O,H&&H.is,H),z&8?u(B,f.children):z&16&&N(f.children,B,null,S,C,O&&j!=="foreignObject",k,P),ce&&Ps(f,null,S,"created"),x(B,f,f.scopeId,k,S),H){for(const Ee in H)Ee!=="value"&&!hn(Ee)&&n(B,Ee,null,H[Ee],O,f.children,S,C,Ie);"value"in H&&n(B,"value",null,H.value),(R=H.onVnodeBeforeMount)&&Wt(R,S,f)}ce&&Ps(f,null,S,"beforeMount");const Ce=Hp(C,te);Ce&&te.beforeEnter(B),r(B,m,I),((R=H&&H.onVnodeMounted)||Ce||ce)&&pt(()=>{R&&Wt(R,S,f),Ce&&te.enter(B),ce&&Ps(f,null,S,"mounted")},C)},x=(f,m,I,S,C)=>{if(I&&p(f,I),S)for(let O=0;O<S.length;O++)p(f,S[O]);if(C){let O=C.subTree;if(m===O){const k=C.vnode;x(f,k,k.scopeId,k.slotScopeIds,C.parent)}}},N=(f,m,I,S,C,O,k,P,B=0)=>{for(let R=B;R<f.length;R++){const j=f[R]=P?vs(f[R]):Kt(f[R]);w(null,j,m,I,S,C,O,k,P)}},V=(f,m,I,S,C,O,k)=>{const P=m.el=f.el;let{patchFlag:B,dynamicChildren:R,dirs:j}=m;B|=f.patchFlag&16;const H=f.props||Fe,z=m.props||Fe;let te;I&&Fs(I,!1),(te=z.onVnodeBeforeUpdate)&&Wt(te,I,m,f),j&&Ps(m,f,I,"beforeUpdate"),I&&Fs(I,!0);const ce=C&&m.type!=="foreignObject";if(R?W(f.dynamicChildren,R,P,I,S,ce,O):k||we(f,m,P,null,I,S,ce,O,!1),B>0){if(B&16)ue(P,m,H,z,I,S,C);else if(B&2&&H.class!==z.class&&n(P,"class",null,z.class,C),B&4&&n(P,"style",H.style,z.style,C),B&8){const Ce=m.dynamicProps;for(let Ee=0;Ee<Ce.length;Ee++){const Ue=Ce[Ee],Rt=H[Ue],ar=z[Ue];(ar!==Rt||Ue==="value")&&n(P,Ue,Rt,ar,C,f.children,I,S,Ie)}}B&1&&f.children!==m.children&&u(P,m.children)}else!k&&R==null&&ue(P,m,H,z,I,S,C);((te=z.onVnodeUpdated)||j)&&pt(()=>{te&&Wt(te,I,m,f),j&&Ps(m,f,I,"updated")},S)},W=(f,m,I,S,C,O,k)=>{for(let P=0;P<m.length;P++){const B=f[P],R=m[P],j=B.el&&(B.type===xt||!Yr(B,R)||B.shapeFlag&70)?c(B.el):I;w(B,R,j,null,S,C,O,k,!0)}},ue=(f,m,I,S,C,O,k)=>{if(I!==S){if(I!==Fe)for(const P in I)!hn(P)&&!(P in S)&&n(f,P,I[P],null,k,m.children,C,O,Ie);for(const P in S){if(hn(P))continue;const B=S[P],R=I[P];B!==R&&P!=="value"&&n(f,P,R,B,k,m.children,C,O,Ie)}"value"in S&&n(f,"value",I.value,S.value)}},ie=(f,m,I,S,C,O,k,P,B)=>{const R=m.el=f?f.el:a(""),j=m.anchor=f?f.anchor:a("");let{patchFlag:H,dynamicChildren:z,slotScopeIds:te}=m;te&&(P=P?P.concat(te):te),f==null?(r(R,I,S),r(j,I,S),N(m.children,I,j,C,O,k,P,B)):H>0&&H&64&&z&&f.dynamicChildren?(W(f.dynamicChildren,z,I,C,O,k,P),(m.key!=null||C&&m===C.subTree)&&gc(f,m,!0)):we(f,m,I,j,C,O,k,P,B)},be=(f,m,I,S,C,O,k,P,B)=>{m.slotScopeIds=P,f==null?m.shapeFlag&512?C.ctx.activate(m,I,S,k,B):fe(m,I,S,C,O,k,B):He(f,m,B)},fe=(f,m,I,S,C,O,k)=>{const P=f.component=Yp(f,S,C);if(oc(f)&&(P.ctx.renderer=Ze),Jp(P),P.asyncDep){if(C&&C.registerDep(P,pe),!f.el){const B=P.subTree=se(tr);y(null,B,m,I)}return}pe(P,f,m,I,C,O,k)},He=(f,m,I)=>{const S=m.component=f.component;if(np(f,m,I))if(S.asyncDep&&!S.asyncResolved){Ae(S,m,I);return}else S.next=m,Yf(S.update),S.update();else m.el=f.el,S.vnode=m},pe=(f,m,I,S,C,O,k)=>{const P=()=>{if(f.isMounted){let{next:j,bu:H,u:z,parent:te,vnode:ce}=f,Ce=j,Ee;Fs(f,!1),j?(j.el=ce.el,Ae(f,j,k)):j=ce,H&&vo(H),(Ee=j.props&&j.props.onVnodeBeforeUpdate)&&Wt(Ee,te,j,ce),Fs(f,!0);const Ue=_o(f),Rt=f.subTree;f.subTree=Ue,w(Rt,Ue,c(Rt.el),$e(Rt),f,C,O),j.el=Ue.el,Ce===null&&op(f,Ue.el),z&&pt(z,C),(Ee=j.props&&j.props.onVnodeUpdated)&&pt(()=>Wt(Ee,te,j,ce),C)}else{let j;const{el:H,props:z}=m,{bm:te,m:ce,parent:Ce}=f,Ee=un(m);if(Fs(f,!1),te&&vo(te),!Ee&&(j=z&&z.onVnodeBeforeMount)&&Wt(j,Ce,m),Fs(f,!0),H&&ke){const Ue=()=>{f.subTree=_o(f),ke(H,f.subTree,f,C,null)};Ee?m.type.__asyncLoader().then(()=>!f.isUnmounted&&Ue()):Ue()}else{const Ue=f.subTree=_o(f);w(null,Ue,I,S,f,C,O),m.el=Ue.el}if(ce&&pt(ce,C),!Ee&&(j=z&&z.onVnodeMounted)){const Ue=m;pt(()=>Wt(j,Ce,Ue),C)}(m.shapeFlag&256||Ce&&un(Ce.vnode)&&Ce.vnode.shapeFlag&256)&&f.a&&pt(f.a,C),f.isMounted=!0,m=I=S=null}},B=f.effect=new rl(P,()=>cl(R),f.scope),R=f.update=()=>B.run();R.id=f.uid,Fs(f,!0),R()},Ae=(f,m,I)=>{m.component=f;const S=f.vnode.props;f.vnode=m,f.next=null,Bp(f,m.props,S,I),Up(f,m.children,I),qr(),ql(),Wr()},we=(f,m,I,S,C,O,k,P,B=!1)=>{const R=f&&f.children,j=f?f.shapeFlag:0,H=m.children,{patchFlag:z,shapeFlag:te}=m;if(z>0){if(z&128){q(R,H,I,S,C,O,k,P,B);return}else if(z&256){rs(R,H,I,S,C,O,k,P,B);return}}te&8?(j&16&&Ie(R,C,O),H!==R&&u(I,H)):j&16?te&16?q(R,H,I,S,C,O,k,P,B):Ie(R,C,O,!0):(j&8&&u(I,""),te&16&&N(H,I,S,C,O,k,P,B))},rs=(f,m,I,S,C,O,k,P,B)=>{f=f||Sr,m=m||Sr;const R=f.length,j=m.length,H=Math.min(R,j);let z;for(z=0;z<H;z++){const te=m[z]=B?vs(m[z]):Kt(m[z]);w(f[z],te,I,null,C,O,k,P,B)}R>j?Ie(f,C,O,!0,!1,H):N(m,I,S,C,O,k,P,B,H)},q=(f,m,I,S,C,O,k,P,B)=>{let R=0;const j=m.length;let H=f.length-1,z=j-1;for(;R<=H&&R<=z;){const te=f[R],ce=m[R]=B?vs(m[R]):Kt(m[R]);if(Yr(te,ce))w(te,ce,I,null,C,O,k,P,B);else break;R++}for(;R<=H&&R<=z;){const te=f[H],ce=m[z]=B?vs(m[z]):Kt(m[z]);if(Yr(te,ce))w(te,ce,I,null,C,O,k,P,B);else break;H--,z--}if(R>H){if(R<=z){const te=z+1,ce=te<j?m[te].el:S;for(;R<=z;)w(null,m[R]=B?vs(m[R]):Kt(m[R]),I,ce,C,O,k,P,B),R++}}else if(R>z)for(;R<=H;)re(f[R],C,O,!0),R++;else{const te=R,ce=R,Ce=new Map;for(R=ce;R<=z;R++){const gt=m[R]=B?vs(m[R]):Kt(m[R]);gt.key!=null&&Ce.set(gt.key,R)}let Ee,Ue=0;const Rt=z-ce+1;let ar=!1,Ol=0;const Qr=new Array(Rt);for(R=0;R<Rt;R++)Qr[R]=0;for(R=te;R<=H;R++){const gt=f[R];if(Ue>=Rt){re(gt,C,O,!0);continue}let qt;if(gt.key!=null)qt=Ce.get(gt.key);else for(Ee=ce;Ee<=z;Ee++)if(Qr[Ee-ce]===0&&Yr(gt,m[Ee])){qt=Ee;break}qt===void 0?re(gt,C,O,!0):(Qr[qt-ce]=R+1,qt>=Ol?Ol=qt:ar=!0,w(gt,m[qt],I,null,C,O,k,P,B),Ue++)}const Ml=ar?$p(Qr):Sr;for(Ee=Ml.length-1,R=Rt-1;R>=0;R--){const gt=ce+R,qt=m[gt],Nl=gt+1<j?m[gt+1].el:S;Qr[R]===0?w(null,qt,I,Nl,C,O,k,P,B):ar&&(Ee<0||R!==Ml[Ee]?Z(qt,I,Nl,2):Ee--)}}},Z=(f,m,I,S,C=null)=>{const{el:O,type:k,transition:P,children:B,shapeFlag:R}=f;if(R&6){Z(f.component.subTree,m,I,S);return}if(R&128){f.suspense.move(m,I,S);return}if(R&64){k.move(f,m,I,Ze);return}if(k===xt){r(O,m,I);for(let H=0;H<B.length;H++)Z(B[H],m,I,S);r(f.anchor,m,I);return}if(k===Ao){g(f,m,I);return}if(S!==2&&R&1&&P)if(S===0)P.beforeEnter(O),r(O,m,I),pt(()=>P.enter(O),C);else{const{leave:H,delayLeave:z,afterLeave:te}=P,ce=()=>r(O,m,I),Ce=()=>{H(O,()=>{ce(),te&&te()})};z?z(O,ce,Ce):Ce()}else r(O,m,I)},re=(f,m,I,S=!1,C=!1)=>{const{type:O,props:k,ref:P,children:B,dynamicChildren:R,shapeFlag:j,patchFlag:H,dirs:z}=f;if(P!=null&&ca(P,null,I,f,!0),j&256){m.ctx.deactivate(f);return}const te=j&1&&z,ce=!un(f);let Ce;if(ce&&(Ce=k&&k.onVnodeBeforeUnmount)&&Wt(Ce,m,f),j&6)Ke(f.component,I,S);else{if(j&128){f.suspense.unmount(I,S);return}te&&Ps(f,null,m,"beforeUnmount"),j&64?f.type.remove(f,m,I,C,Ze,S):R&&(O!==xt||H>0&&H&64)?Ie(R,m,I,!1,!0):(O===xt&&H&384||!C&&j&16)&&Ie(B,m,I),S&&Se(f)}(ce&&(Ce=k&&k.onVnodeUnmounted)||te)&&pt(()=>{Ce&&Wt(Ce,m,f),te&&Ps(f,null,m,"unmounted")},I)},Se=f=>{const{type:m,el:I,anchor:S,transition:C}=f;if(m===xt){Oe(I,S);return}if(m===Ao){b(f);return}const O=()=>{i(I),C&&!C.persisted&&C.afterLeave&&C.afterLeave()};if(f.shapeFlag&1&&C&&!C.persisted){const{leave:k,delayLeave:P}=C,B=()=>k(I,O);P?P(f.el,O,B):B()}else O()},Oe=(f,m)=>{let I;for(;f!==m;)I=d(f),i(f),f=I;i(m)},Ke=(f,m,I)=>{const{bum:S,scope:C,update:O,subTree:k,um:P}=f;S&&vo(S),C.stop(),O&&(O.active=!1,re(k,f,m,I)),P&&pt(P,m),pt(()=>{f.isUnmounted=!0},m),m&&m.pendingBranch&&!m.isUnmounted&&f.asyncDep&&!f.asyncResolved&&f.suspenseId===m.pendingId&&(m.deps--,m.deps===0&&m.resolve())},Ie=(f,m,I,S=!1,C=!1,O=0)=>{for(let k=O;k<f.length;k++)re(f[k],m,I,S,C)},$e=f=>f.shapeFlag&6?$e(f.component.subTree):f.shapeFlag&128?f.suspense.next():d(f.anchor||f.el),dt=(f,m,I)=>{f==null?m._vnode&&re(m._vnode,null,null,!0):w(m._vnode||null,f,m,null,null,null,I),ql(),ec(),m._vnode=f},Ze={p:w,um:re,m:Z,r:Se,mt:fe,mc:N,pc:we,pbc:W,n:$e,o:t};let yt,ke;return e&&([yt,ke]=e(Ze)),{render:dt,hydrate:yt,createApp:Op(dt,yt)}}function Fs({effect:t,update:e},s){t.allowRecurse=e.allowRecurse=s}function Hp(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function gc(t,e,s=!1){const r=t.children,i=e.children;if(ee(r)&&ee(i))for(let n=0;n<r.length;n++){const o=r[n];let a=i[n];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[n]=vs(i[n]),a.el=o.el),s||gc(o,a)),a.type===lo&&(a.el=o.el)}}function $p(t){const e=t.slice(),s=[0];let r,i,n,o,a;const l=t.length;for(r=0;r<l;r++){const h=t[r];if(h!==0){if(i=s[s.length-1],t[i]<h){e[r]=i,s.push(r);continue}for(n=0,o=s.length-1;n<o;)a=n+o>>1,t[s[a]]<h?n=a+1:o=a;h<t[s[n]]&&(n>0&&(e[r]=s[n-1]),s[n]=r)}}for(n=s.length,o=s[n-1];n-- >0;)s[n]=o,o=e[o];return s}const Vp=t=>t.__isTeleport,xt=Symbol.for("v-fgt"),lo=Symbol.for("v-txt"),tr=Symbol.for("v-cmt"),Ao=Symbol.for("v-stc"),di=[];let Dt=null;function st(t=!1){di.push(Dt=t?null:[])}function qp(){di.pop(),Dt=di[di.length-1]||null}let Ti=1;function th(t){Ti+=t}function vc(t){return t.dynamicChildren=Ti>0?Dt||Sr:null,qp(),Ti>0&&Dt&&Dt.push(t),t}function Jt(t,e,s,r,i,n){return vc(_e(t,e,s,r,i,n,!0))}function pr(t,e,s,r,i){return vc(se(t,e,s,r,i,!0))}function Wp(t){return t?t.__v_isVNode===!0:!1}function Yr(t,e){return t.type===e.type&&t.key===e.key}const ho="__vInternal",_c=({key:t})=>t??null,dn=({ref:t,ref_key:e,ref_for:s})=>(typeof t=="number"&&(t=""+t),t!=null?Ge(t)||ut(t)||ae(t)?{i:Ut,r:t,k:e,f:!!s}:t:null);function _e(t,e=null,s=null,r=0,i=null,n=t===xt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&_c(e),ref:e&&dn(e),scopeId:rc,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:n,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Ut};return a?(pl(l,s),n&128&&t.normalize(l)):s&&(l.shapeFlag|=Ge(s)?8:16),Ti>0&&!o&&Dt&&(l.patchFlag>0||n&6)&&l.patchFlag!==32&&Dt.push(l),l}const se=jp;function jp(t,e=null,s=null,r=0,i=null,n=!1){if((!t||t===Ap)&&(t=tr),Wp(t)){const a=Lr(t,e,!0);return s&&pl(a,s),Ti>0&&!n&&Dt&&(a.shapeFlag&6?Dt[Dt.indexOf(t)]=a:Dt.push(a)),a.patchFlag|=-2,a}if(im(t)&&(t=t.__vccOpts),e){e=zp(e);let{class:a,style:l}=e;a&&!Ge(a)&&(e.class=ki(a)),Be(l)&&(Ku(l)&&!ee(l)&&(l=it({},l)),e.style=er(l))}const o=Ge(t)?1:ap(t)?128:Vp(t)?64:Be(t)?4:ae(t)?2:0;return _e(t,e,s,r,i,o,n,!0)}function zp(t){return t?Ku(t)||ho in t?it({},t):t:null}function Lr(t,e,s=!1){const{props:r,ref:i,patchFlag:n,children:o}=t,a=e?Kp(r||{},e):r;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&_c(a),ref:e&&e.ref?s&&i?ee(i)?i.concat(dn(e)):[i,dn(e)]:dn(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==xt?n===-1?16:n|16:n,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Lr(t.ssContent),ssFallback:t.ssFallback&&Lr(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce}}function Xp(t=" ",e=0){return se(lo,null,t,e)}function $s(t="",e=!1){return e?(st(),pr(tr,null,t)):se(tr,null,t)}function Kt(t){return t==null||typeof t=="boolean"?se(tr):ee(t)?se(xt,null,t.slice()):typeof t=="object"?vs(t):se(lo,null,String(t))}function vs(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Lr(t)}function pl(t,e){let s=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(ee(e))s=16;else if(typeof e=="object")if(r&65){const i=e.default;i&&(i._c&&(i._d=!1),pl(t,i()),i._c&&(i._d=!0));return}else{s=32;const i=e._;!i&&!(ho in e)?e._ctx=Ut:i===3&&Ut&&(Ut.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else ae(e)?(e={default:e,_ctx:Ut},s=32):(e=String(e),r&64?(s=16,e=[Xp(e)]):s=8);t.children=e,t.shapeFlag|=s}function Kp(...t){const e={};for(let s=0;s<t.length;s++){const r=t[s];for(const i in r)if(i==="class")e.class!==r.class&&(e.class=ki([e.class,r.class]));else if(i==="style")e.style=er([e.style,r.style]);else if(Jn(i)){const n=e[i],o=r[i];o&&n!==o&&!(ee(n)&&n.includes(o))&&(e[i]=n?[].concat(n,o):o)}else i!==""&&(e[i]=r[i])}return e}function Wt(t,e,s,r=null){$t(t,e,7,[s,r])}const Zp=cc();let Qp=0;function Yp(t,e,s){const r=t.type,i=(e?e.appContext:t.appContext)||Zp,n={uid:Qp++,vnode:t,type:r,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new _f(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:fc(r,i),emitsOptions:sc(r,i),emit:null,emitted:null,propsDefaults:Fe,inheritAttrs:r.inheritAttrs,ctx:Fe,data:Fe,props:Fe,attrs:Fe,slots:Fe,refs:Fe,setupState:Fe,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return n.ctx={_:n},n.root=e?e.root:n,n.emit=tp.bind(null,n),t.ce&&t.ce(n),n}let Qe=null,ml,lr,sh="__VUE_INSTANCE_SETTERS__";(lr=ea()[sh])||(lr=ea()[sh]=[]),lr.push(t=>Qe=t),ml=t=>{lr.length>1?lr.forEach(e=>e(t)):lr[0](t)};const kr=t=>{ml(t),t.scope.on()},Zs=()=>{Qe&&Qe.scope.off(),ml(null)};function bc(t){return t.vnode.shapeFlag&4}let wi=!1;function Jp(t,e=!1){wi=e;const{props:s,children:r}=t.vnode,i=bc(t);Np(t,s,i,e),kp(t,r);const n=i?em(t,e):void 0;return wi=!1,n}function em(t,e){const s=t.type;t.accessCache=Object.create(null),t.proxy=Zu(new Proxy(t.ctx,Ep));const{setup:r}=s;if(r){const i=t.setupContext=r.length>1?sm(t):null;kr(t),qr();const n=Ts(r,t,0,[t.props,i]);if(Wr(),Zs(),Mu(n)){if(n.then(Zs,Zs),e)return n.then(o=>{rh(t,o,e)}).catch(o=>{no(o,t,0)});t.asyncDep=n}else rh(t,n,e)}else xc(t,e)}function rh(t,e,s){ae(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Be(e)&&(t.setupState=Qu(e)),xc(t,s)}let ih;function xc(t,e,s){const r=t.type;if(!t.render){if(!e&&ih&&!r.render){const i=r.template||dl(t).template;if(i){const{isCustomElement:n,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:l}=r,h=it(it({isCustomElement:n,delimiters:a},o),l);r.render=ih(i,h)}}t.render=r.render||Ht}{kr(t),qr();try{Ip(t)}finally{Wr(),Zs()}}}function tm(t){return t.attrsProxy||(t.attrsProxy=new Proxy(t.attrs,{get(e,s){return mt(t,"get","$attrs"),e[s]}}))}function sm(t){const e=s=>{t.exposed=s||{}};return{get attrs(){return tm(t)},slots:t.slots,emit:t.emit,expose:e}}function yl(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(Qu(Zu(t.exposed)),{get(e,s){if(s in e)return e[s];if(s in ci)return ci[s](t)},has(e,s){return s in e||s in ci}}))}function rm(t,e=!0){return ae(t)?t.displayName||t.name:t.name||e&&t.__name}function im(t){return ae(t)&&"__vccOpts"in t}const nm=(t,e)=>Xf(t,e,wi),om=Symbol.for("v-scx"),am=()=>cn(om),lm="3.3.7",hm="http://www.w3.org/2000/svg",Vs=typeof document<"u"?document:null,nh=Vs&&Vs.createElement("template"),um={insert:(t,e,s)=>{e.insertBefore(t,s||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,s,r)=>{const i=e?Vs.createElementNS(hm,t):Vs.createElement(t,s?{is:s}:void 0);return t==="select"&&r&&r.multiple!=null&&i.setAttribute("multiple",r.multiple),i},createText:t=>Vs.createTextNode(t),createComment:t=>Vs.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Vs.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,s,r,i,n){const o=s?s.previousSibling:e.lastChild;if(i&&(i===n||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),s),!(i===n||!(i=i.nextSibling)););else{nh.innerHTML=r?`<svg>${t}</svg>`:t;const a=nh.content;if(r){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,s)}return[o?o.nextSibling:e.firstChild,s?s.previousSibling:e.lastChild]}},cm=Symbol("_vtc");function dm(t,e,s){const r=t[cm];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):s?t.setAttribute("class",e):t.className=e}const fm=Symbol("_vod");function pm(t,e,s){const r=t.style,i=Ge(s);if(s&&!i){if(e&&!Ge(e))for(const n in e)s[n]==null&&da(r,n,"");for(const n in s)da(r,n,s[n])}else{const n=r.display;i?e!==s&&(r.cssText=s):e&&t.removeAttribute("style"),fm in t&&(r.display=n)}}const oh=/\s*!important$/;function da(t,e,s){if(ee(s))s.forEach(r=>da(t,e,r));else if(s==null&&(s=""),e.startsWith("--"))t.setProperty(e,s);else{const r=mm(t,e);oh.test(s)?t.setProperty(Vr(r),s.replace(oh,""),"important"):t[r]=s}}const ah=["Webkit","Moz","ms"],To={};function mm(t,e){const s=To[e];if(s)return s;let r=ss(e);if(r!=="filter"&&r in t)return To[e]=r;r=ro(r);for(let i=0;i<ah.length;i++){const n=ah[i]+r;if(n in t)return To[e]=n}return e}const lh="http://www.w3.org/1999/xlink";function ym(t,e,s,r,i){if(r&&e.startsWith("xlink:"))s==null?t.removeAttributeNS(lh,e.slice(6,e.length)):t.setAttributeNS(lh,e,s);else{const n=vf(e);s==null||n&&!Lu(s)?t.removeAttribute(e):t.setAttribute(e,n?"":s)}}function gm(t,e,s,r,i,n,o){if(e==="innerHTML"||e==="textContent"){r&&o(r,i,n),t[e]=s??"";return}const a=t.tagName;if(e==="value"&&a!=="PROGRESS"&&!a.includes("-")){t._value=s;const h=a==="OPTION"?t.getAttribute("value"):t.value,u=s??"";h!==u&&(t.value=u),s==null&&t.removeAttribute(e);return}let l=!1;if(s===""||s==null){const h=typeof t[e];h==="boolean"?s=Lu(s):s==null&&h==="string"?(s="",l=!0):h==="number"&&(s=0,l=!0)}try{t[e]=s}catch{}l&&t.removeAttribute(e)}function vm(t,e,s,r){t.addEventListener(e,s,r)}function _m(t,e,s,r){t.removeEventListener(e,s,r)}const hh=Symbol("_vei");function bm(t,e,s,r,i=null){const n=t[hh]||(t[hh]={}),o=n[e];if(r&&o)o.value=r;else{const[a,l]=xm(e);if(r){const h=n[e]=wm(r,i);vm(t,a,h,l)}else o&&(_m(t,a,o,l),n[e]=void 0)}}const uh=/(?:Once|Passive|Capture)$/;function xm(t){let e;if(uh.test(t)){e={};let r;for(;r=t.match(uh);)t=t.slice(0,t.length-r[0].length),e[r[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Vr(t.slice(2)),e]}let wo=0;const Am=Promise.resolve(),Tm=()=>wo||(Am.then(()=>wo=0),wo=Date.now());function wm(t,e){const s=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=s.attached)return;$t(Em(r,s.value),e,5,[r])};return s.value=t,s.attached=Tm(),s}function Em(t,e){if(ee(e)){const s=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{s.call(t),t._stopped=!0},e.map(r=>i=>!i._stopped&&r&&r(i))}else return e}const ch=/^on[a-z]/,Im=(t,e,s,r,i=!1,n,o,a,l)=>{e==="class"?dm(t,r,i):e==="style"?pm(t,s,r):Jn(e)?Ja(e)||bm(t,e,s,r,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Sm(t,e,r,i))?gm(t,e,r,n,o,a,l):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),ym(t,e,r,i))};function Sm(t,e,s,r){return r?!!(e==="innerHTML"||e==="textContent"||e in t&&ch.test(e)&&ae(s)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||ch.test(e)&&Ge(s)?!1:e in t}const Cm=it({patchProp:Im},um);let dh;function Rm(){return dh||(dh=Dp(Cm))}const Pm=(...t)=>{const e=Rm().createApp(...t),{mount:s}=e;return e.mount=r=>{const i=Fm(r);if(!i)return;const n=e._component;!ae(n)&&!n.render&&!n.template&&(n.template=i.innerHTML),i.innerHTML="";const o=s(i,!1,i instanceof SVGElement);return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e};function Fm(t){return Ge(t)?document.querySelector(t):t}var fa,K,gs,Re,fn;const jr=()=>({setApp:t=>fa=t,setHero:t=>K=t,setVitality:t=>gs=t,setInventory:t=>Re=t,setEquipment:t=>fn=t}),Om=function(t){return Math.floor(Math.random()*(t+1))},wt=function(t){return Math.floor(Math.random()*t)+1===t},Ac=function(t){return window.btoa(String.fromCharCode(...window.crypto.getRandomValues(new Uint8Array(t*2)))).replace(/[+/]/g,"").substring(0,t)},X=function(t,e={}){window.dispatchEvent(new CustomEvent(t,{detail:e}))},Wi=function(){return"#000000".replace(/0/g,function(){return(~~(Math.random()*16)).toString(16)})},fh=function(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);if(!e)throw new Error("Could not convert hexToRGB");return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]},Mm=function(t,e){const s={};Object.keys(e).forEach(n=>{s[fh(n).toString()]=fh(e[n])});const r=document.createElement("canvas").getContext("2d")??(()=>{throw Error("Could not get canvas 2d context")})();r.canvas.width=t.width,r.canvas.height=t.height,r.drawImage(t,0,0);const i=r.getImageData(0,0,r.canvas.width,r.canvas.height);for(let n=0;n<i.data.length;n+=4){const o=[i.data[n],i.data[n+1],i.data[n+2]].toString();if(o in s){const a=s[o];i.data[n]=a[0],i.data[n+1]=a[1],i.data[n+2]=a[2],i.data[n+3]=255}}return r.putImageData(i,0,0),r.canvas},ph=async function(t){return new Promise(e=>{const s=new Image;s.onload=()=>e(s),s.src=t})},Nm=async function(t,e,s){return new Promise(r=>{if(!e)return t;const i=["#ff0000","#ff00ff","#0000ff","#ffff00","#00ffff","#ff00ff"],n={};s.forEach((h,u)=>{n[i[u]]=h});const o=Mm(e,n),a=document.createElement("canvas").getContext("2d")??(()=>{throw Error("Could not get canvas 2d context")})();a.canvas.width=t.width,a.canvas.height=t.height,a.drawImage(t,0,0),a.globalCompositeOperation="overlay",a.drawImage(o,0,0);const l=new Image;l.onload=()=>r(l),l.src=a.canvas.toDataURL("image/png")})};var Ni;const js=class js{constructor(e,s){G(this,"id",null);G(this,"image",null);G(this,"originImage",null);G(this,"mask",null);G(this,"speed",null);G(this,"states",null);G(this,"canvas",null);G(this,"ctx",null);G(this,"interval",null);G(this,"currentState",null);G(this,"currentFrame",null);G(this,"lastFrame",null);G(this,"customData",{});e&&(ot(js,Ni)[e]=this),this.id=e,this.image=s.image,this.originImage=s.image,this.mask=s.mask||null,this.speed=s.speed||null,this.states=s.states||{},this.states.origin=[{x:0,y:0,w:this.image.width,h:this.image.height}],this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.currentState=this.getDefaultState(),this.currentFrame=1}static async load(e){try{const r=await(await fetch(e)).json();await Promise.all(Object.entries(r).map(async([i,n])=>{const a={image:await ph(n.base),speed:n.speed||null,states:n.states||null};n.mask&&(a.mask=await ph(n.mask)),new js(i,a)}))}catch(s){console.error("Error loading sprites:",s)}}static get(e){return ot(js,Ni)[e]??null}clone(){return new js(null,{originImage:this.originImage,image:this.image,mask:this.mask,speed:this.speed,states:this.states})}async play(e=null){return new Promise(s=>{e=e||this.getDefaultState(),this.stop(),this.rewind(),this.currentState=e;const r=this.states[e].length;r>1&&this.speed&&(this.interval=setInterval(()=>{++this.currentFrame>r&&(this.stop(),s())},this.speed))})}stop(){clearInterval(this.interval),this.interval=null}rewind(){this.currentFrame=1}loop(e=null){if(e=e||this.getDefaultState(),this.interval&&this.currentState===e)return;this.stop(),this.rewind(),this.currentState=e;const s=this.states[e].length;s>1&&this.speed&&(this.interval=setInterval(()=>{++this.currentFrame>s&&(this.currentFrame=1)},this.speed))}async dye(e){this.image=await Nm(this.originImage,this.mask,e),this.lastFrame=null}getDefaultState(){return Object.keys(this.states)[0]}getFrame(){const e=this.states[this.currentState][this.currentFrame-1];return this.lastFrame===e?this.canvas:(this.lastFrame=e,this.canvas.width=e.w,this.canvas.height=e.h,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.image,e.x,e.y,e.w,e.h,0,0,e.w,e.h),this.canvas)}};Ni=new WeakMap,at(js,Ni,{});let ds=js;var Bi;const Ir=class Ir{constructor(e){G(this,"id");G(this,"name");G(this,"type");G(this,"altitude");G(this,"sprite");G(this,"isUsable");G(this,"isMovable");G(this,"isPickupable");G(this,"isBlockingCreatures");G(this,"isBlockingItems");G(this,"isEquipable");ot(Ir,Bi)[e.id]=this,this.id=e.id,this.name=e.name,this.type=e.type,this.altitude=e.altitude,this.isUsable=e.isUsable,this.isMovable=e.isMovable,this.isPickupable=e.isPickupable,this.isBlockingCreatures=e.isBlockingCreatures,this.isBlockingItems=e.isBlockingItems,this.isEquipable=e.isEquipable,this.sprite=ds.get(e.sprite),this.sprite.loop()}static async load(e){try{const r=await(await fetch(e)).json();return new Promise(i=>{Object.values(r).forEach(n=>new Ir(n)),i()})}catch(s){console.error("Error loading items:",s)}}static get(e){const s=ot(Ir,Bi)[e];if(!s)throw`Could not load structure for item ${e}.`;return s}};Bi=new WeakMap,at(Ir,Bi,{});let bt=Ir;var Li,Nt;const Je=class Je{constructor(e){G(this,"id");G(this,"sprite");ot(Je,Li)[e.id]=this,this.id=e.id,e.colors?(this.sprite=ds.get(e.sprite).clone(),this.sprite.dye(e.colors)):this.sprite=ds.get(e.sprite)}static async load(e){try{const r=await(await fetch(e)).json();return new Promise(i=>{Object.values(r).forEach(n=>{new Je(n)}),window.addEventListener("run-effect",n=>{Je.get(n.detail.effect).run(n.detail.position,n.detail.onCreature??!1)}),i()})}catch(s){console.error("Error while loading effects:",s)}}static get(e){const s=ot(Je,Li)[e];if(!s)throw`Could not load effect for item ${e}.`;return s}static getRunning(e){return ot(Je,Nt)[JSON.stringify(e)]??[]}run(e,s=!1){const r=JSON.stringify(e),i=this.sprite.clone();ot(Je,Nt)[r]||(ot(Je,Nt)[r]=[]),i.customData={onCreature:s},ot(Je,Nt)[r].push(i),i.play().then(()=>{ot(Je,Nt)[r]=ot(Je,Nt)[r].filter(n=>n!=i),ot(Je,Nt)[r].length===0&&delete ot(Je,Nt)[r]})}};Li=new WeakMap,Nt=new WeakMap,at(Je,Li,{}),at(Je,Nt,{});let Ur=Je;var Bm=Object.defineProperty,Lm=(t,e,s)=>e in t?Bm(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,me=(t,e,s)=>(Lm(t,typeof e!="symbol"?e+"":e,s),s);let Tc=class{constructor(e){me(this,"_onPressed"),me(this,"_onPressedWithRepeat"),me(this,"_onReleased"),me(this,"_isPressed"),me(this,"_identity"),this._isPressed=!1,this._identity=e,typeof e=="function"?this._onPressedWithRepeat=e:(this._onPressed=e.onPressed,this._onPressedWithRepeat=e.onPressedWithRepeat,this._onReleased=e.onReleased)}get isEmpty(){return!this._onPressed&&!this._onPressedWithRepeat&&!this._onReleased}isOwnHandler(e){return this._identity===e}executePressed(e){var s,r;this._isPressed||(s=this._onPressed)==null||s.call(this,e),this._isPressed=!0,(r=this._onPressedWithRepeat)==null||r.call(this,e)}executeReleased(e){var s;this._isPressed&&((s=this._onReleased)==null||s.call(this,e)),this._isPressed=!1}};const pa=class os{constructor(e,s,r={}){me(this,"_normalizedKeyCombo"),me(this,"_parsedKeyCombo"),me(this,"_handlerState"),me(this,"_keyComboEventMapper"),me(this,"_movingToNextSequenceAt"),me(this,"_sequenceIndex"),me(this,"_unitIndex"),me(this,"_lastActiveKeyPresses"),me(this,"_lastActiveKeyCount"),me(this,"_isPressedWithFinalUnit"),this._normalizedKeyCombo=os.normalizeKeyCombo(e),this._parsedKeyCombo=os.parseKeyCombo(e),this._handlerState=new Tc(r),this._keyComboEventMapper=s,this._movingToNextSequenceAt=0,this._sequenceIndex=0,this._unitIndex=0,this._lastActiveKeyPresses=[],this._lastActiveKeyCount=0,this._isPressedWithFinalUnit=null}static parseKeyCombo(e){if(os._parseCache[e])return os._parseCache[e];const s=e.toLowerCase();let r="",i=[],n=[i],o=[n];const a=[o];let l=!1;for(let u=0;u<e.length;u+=1)if(s[u]==="\\")l=!0;else if((s[u]==="+"||s[u]===">"||s[u]===",")&&!l){if(r)throw new Error("cannot have two operators in a row");r=s[u]}else s[u].match(/[^\s]/)&&(r&&(r===","?(i=[],n=[i],o=[n],a.push(o)):r===">"?(i=[],n=[i],o.push(n)):r==="+"&&(i=[],n.push(i)),r=""),l=!1,i.push(s[u]));const h=a.map(u=>u.map(c=>c.map(d=>d.join(""))));return os._parseCache[e]=h,h}static stringifyKeyCombo(e){return e.map(s=>s.map(r=>r.map(i=>i==="+"?"\\+":i===">"?"\\>":i===","?"\\,":i).join("+")).join(">")).join(",")}static normalizeKeyCombo(e){if(os._normalizationCache[e])return os._normalizationCache[e];const s=this.stringifyKeyCombo(this.parseKeyCombo(e));return os._normalizationCache[e]=s,s}get isPressed(){return!!this._isPressedWithFinalUnit}get sequenceIndex(){return this.isPressed?this._parsedKeyCombo.length:this._sequenceIndex}isOwnHandler(e){return this._handlerState.isOwnHandler(e)}executePressed(e){var s;(s=this._isPressedWithFinalUnit)!=null&&s.has(e.key)&&this._handlerState.executePressed(this._wrapEvent(this._lastActiveKeyPresses,{key:e.key,event:e}))}executeReleased(e){var s;(s=this._isPressedWithFinalUnit)!=null&&s.has(e.key)&&(this._handlerState.executeReleased(this._wrapEvent(this._lastActiveKeyPresses,{key:e.key,event:e})),this._isPressedWithFinalUnit=null)}updateState(e,s){const r=e.length,i=r<this._lastActiveKeyCount;this._lastActiveKeyCount=r;const n=this._parsedKeyCombo[this._sequenceIndex],o=n.slice(0,this._unitIndex),a=n.slice(this._unitIndex),l=()=>{this._movingToNextSequenceAt=0,this._sequenceIndex=0,this._unitIndex=0,this._lastActiveKeyPresses.length=0,this._handlerState.isEmpty&&(this._isPressedWithFinalUnit=null)};let h=0;if(i){if(this._movingToNextSequenceAt===0)return l();if(this._movingToNextSequenceAt+s<Date.now()||r!==0)return;this._movingToNextSequenceAt=0,this._sequenceIndex+=1,this._unitIndex=0;return}for(const u of o){for(const c of u){let d=!1;for(let p=h;p<e.length&&p<h+u.length;p+=1)if(e[p].key===c){d=!0;break}if(!d)return l()}h+=u.length}if(this._movingToNextSequenceAt===0){for(const u of a){for(const c of u){let d=!1;for(let p=h;p<e.length&&p<h+u.length;p+=1)if(e[p].key===c){d=!0;break}if(!d)return}this._unitIndex+=1,h+=u.length}if(h<r-1)return l();if(this._lastActiveKeyPresses[this._sequenceIndex]=e.slice(0),this._sequenceIndex<this._parsedKeyCombo.length-1){this._movingToNextSequenceAt=Date.now();return}this._isPressedWithFinalUnit=new Set(n[n.length-1])}}_wrapEvent(e,s){return{...this._keyComboEventMapper(e,s),keyCombo:this._normalizedKeyCombo,keyEvents:e.flat().map(r=>r.event),finalKeyEvent:s.event}}};me(pa,"_parseCache",{}),me(pa,"_normalizationCache",{});let bs=pa;const km={addEventListener:(...t)=>{},removeEventListener:(...t)=>{},dispatchEvent:(...t)=>{}},Um={userAgent:""},Ei=()=>typeof document<"u"?document:km,Dm=()=>typeof navigator<"u"?navigator:Um,Gm=()=>Dm().userAgent.toLocaleLowerCase().includes("mac");let ma=!1;const Hm=t=>{!Gm()||t.key!=="Meta"||(ma=!0)},$m=t=>{!ma||t.key!=="Meta"||(ma=!1,wc())},En=new Map,Vm=t=>{En.set(t.key,t)},qm=t=>{En.delete(t.key)},wc=()=>{for(const t of En.values()){const e=new KeyboardEvent("keyup",{key:t.key,code:t.code,bubbles:!0,cancelable:!0});Ei().dispatchEvent(e)}En.clear()},Wm=t=>{try{const e=()=>t();return addEventListener("focus",e),()=>{removeEventListener("focus",e)}}catch{}},jm=t=>{try{const e=()=>{wc(),t()};return addEventListener("blur",e),()=>removeEventListener("blur",e)}catch{}},zm=t=>{try{const e=s=>(Vm(s),Hm(s),t({key:s.key,originalEvent:s,composedPath:()=>s.composedPath(),preventDefault:()=>s.preventDefault()}));return Ei().addEventListener("keydown",e),()=>Ei().removeEventListener("keydown",e)}catch{}},Xm=t=>{try{const e=s=>(qm(s),$m(s),t({key:s.key,originalEvent:s,composedPath:()=>s.composedPath(),preventDefault:()=>s.preventDefault()}));return Ei().addEventListener("keyup",e),()=>Ei().removeEventListener("keyup",e)}catch{}},Km=1e3;let Zm=class{constructor(e={}){me(this,"sequenceTimeout"),me(this,"_isActive"),me(this,"_unbinder"),me(this,"_onActiveBinder"),me(this,"_onInactiveBinder"),me(this,"_onKeyPressedBinder"),me(this,"_onKeyReleasedBinder"),me(this,"_keyComboEventMapper"),me(this,"_selfReleasingKeys"),me(this,"_keyRemap"),me(this,"_handlerStates"),me(this,"_keyComboStates"),me(this,"_keyComboStatesArray"),me(this,"_activeKeyPresses"),me(this,"_activeKeyMap"),me(this,"_watchedKeyComboStates"),this.sequenceTimeout=Km,this._isActive=!0,this._onActiveBinder=()=>{},this._onInactiveBinder=()=>{},this._onKeyPressedBinder=()=>{},this._onKeyReleasedBinder=()=>{},this._keyComboEventMapper=()=>({}),this._selfReleasingKeys=[],this._keyRemap={},this._handlerStates={},this._keyComboStates={},this._keyComboStatesArray=[],this._activeKeyPresses=[],this._activeKeyMap=new Map,this._watchedKeyComboStates={},this.bindEnvironment(e)}get pressedKeys(){return this._activeKeyPresses.map(e=>e.key)}bindKey(e,s){var r;e=e.toLowerCase();const i=new Tc(s);(r=this._handlerStates)[e]??(r[e]=[]),this._handlerStates[e].push(i)}unbindKey(e,s){e=e.toLowerCase();const r=this._handlerStates[e];if(r)if(s)for(let i=0;i<r.length;i+=1)r[i].isOwnHandler(s)&&(r.splice(i,1),i-=1);else r.length=0}bindKeyCombo(e,s){var r;e=bs.normalizeKeyCombo(e);const i=new bs(e,this._keyComboEventMapper,s);(r=this._keyComboStates)[e]??(r[e]=[]),this._keyComboStates[e].push(i),this._keyComboStatesArray.push(i)}unbindKeyCombo(e,s){e=bs.normalizeKeyCombo(e);const r=this._keyComboStates[e];if(r)if(s){for(let i=0;i<r.length;i+=1)if(r[i].isOwnHandler(s)){for(let n=0;n<this._keyComboStatesArray.length;n+=1)this._keyComboStatesArray[n]===r[i]&&(this._keyComboStatesArray.splice(n,1),n-=1);r.splice(i,1),i-=1}}else r.length=0}checkKey(e){return this._activeKeyMap.has(e.toLowerCase())}checkKeyCombo(e){return this._ensureCachedKeyComboState(e).isPressed}checkKeyComboSequenceIndex(e){return this._ensureCachedKeyComboState(e).sequenceIndex}bindEnvironment(e={}){this.unbindEnvironment(),this._onActiveBinder=e.onActive??Wm,this._onInactiveBinder=e.onInactive??jm,this._onKeyPressedBinder=e.onKeyPressed??zm,this._onKeyReleasedBinder=e.onKeyReleased??Xm,this._keyComboEventMapper=e.mapKeyComboEvent??(()=>({})),this._selfReleasingKeys=e.selfReleasingKeys??[],this._keyRemap=e.keyRemap??{};const s=this._onActiveBinder(()=>{this._isActive=!0}),r=this._onInactiveBinder(()=>{this._isActive=!1}),i=this._onKeyPressedBinder(o=>{this._handleKeyPress(o)}),n=this._onKeyReleasedBinder(o=>{this._handleKeyRelease(o)});this._unbinder=()=>{s==null||s(),r==null||r(),i==null||i(),n==null||n()}}unbindEnvironment(){var e;(e=this._unbinder)==null||e.call(this)}_ensureCachedKeyComboState(e){e=bs.normalizeKeyCombo(e),this._watchedKeyComboStates[e]||(this._watchedKeyComboStates[e]=new bs(e,this._keyComboEventMapper));const s=this._watchedKeyComboStates[e];return s.updateState(this._activeKeyPresses,this.sequenceTimeout),s}_handleKeyPress(e){if(!this._isActive)return;e={...e,key:e.key.toLowerCase()};const s=this._keyRemap[e.key];s&&(e.key=s);const r=this._handlerStates[e.key];if(r)for(const n of r)n.executePressed(e);const i=this._activeKeyMap.get(e.key);if(i)i.event=e;else{const n={key:e.key,event:e};this._activeKeyMap.set(e.key,n),this._activeKeyPresses.push(n)}this._updateKeyComboStates();for(const n of this._keyComboStatesArray)n.executePressed(e)}_handleKeyRelease(e){e={...e,key:e.key.toLowerCase()};const s=this._keyRemap[e.key];s&&(e.key=s);const r=this._handlerStates[e.key];if(r)for(const i of r)i.executeReleased(e);if(this._activeKeyMap.has(e.key)){this._activeKeyMap.delete(e.key);for(let i=0;i<this._activeKeyPresses.length;i+=1)if(this._activeKeyPresses[i].key===e.key){this._activeKeyPresses.splice(i,1),i-=1;break}}this._tryReleaseSelfReleasingKeys(),this._updateKeyComboStates();for(const i of this._keyComboStatesArray)i.executeReleased(e)}_updateKeyComboStates(){for(const e of this._keyComboStatesArray)e.updateState(this._activeKeyPresses,this.sequenceTimeout)}_tryReleaseSelfReleasingKeys(){for(const e of this._activeKeyPresses)for(const s of this._selfReleasingKeys)e.key===s&&this._handleKeyRelease(e.event)}},Qm,ya;const Ym=t=>{ya=t??new Zm(Qm)},Ec=()=>(ya||Ym(),ya),mh=(...t)=>Ec().bindKey(...t),ms=(...t)=>Ec().checkKey(...t);bs.normalizeKeyCombo;bs.stringifyKeyCombo;bs.parseKeyCombo;const _i=class _i{static init(){document.addEventListener("keydown",()=>setTimeout(_i.triggerKeyHoldingFunctions)),window.keyboardLoop=setInterval(_i.triggerKeyHoldingFunctions,200),mh("i",()=>{X("inventory-toggle")}),mh("u",()=>{X("equipment-toggle")})}};G(_i,"triggerKeyHoldingFunctions",()=>{(ms("ArrowUp")||ms("w"))&&X("move-north"),(ms("ArrowDown")||ms("s"))&&X("move-south"),(ms("ArrowLeft")||ms("a"))&&X("move-west"),(ms("ArrowRight")||ms("d"))&&X("move-east")});let ga=_i;const oe=32,ni=33,oi=19,Jm="data/sprites.json",ey="data/items.json",ty="data/effects.json",sy="ws://ragnoria.localhost:6001/",yh=2,gh=1.5,vh=800,Yt=function(t,e,s=1){const r=t.x-s,i=t.y-s,n=t.x+s,o=t.y+s;return e.x>=r&&e.x<=n&&e.y>=i&&e.y<=o},ws=function(t,e){return t.x===e.x&&t.y===e.y};let Ic;function ry(t){return Ic=t,t}function Ii(){return Ic}var ir=(t=>(t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2",t))(ir||{}),Sc=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS",t))(Sc||{}),va=(t=>(t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t))(va||{}),J=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR",t))(J||{}),In=(t=>(t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t))(In||{}),L=(t=>(t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t))(L||{}),Fr=(t=>(t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t))(Fr||{}),he=(t=>(t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT",t))(he||{}),U=(t=>(t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT",t))(U||{}),hs=(t=>(t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t))(hs||{}),gl=(t=>(t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t))(gl||{}),sr=(t=>(t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL",t))(sr||{}),Gt=(t=>(t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",t))(Gt||{}),Ms=(t=>(t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT",t))(Ms||{}),vl=(t=>(t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL",t))(vl||{}),It=(t=>(t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp",t))(It||{}),Ve=(t=>(t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE",t[t.COLOR=4]="COLOR",t))(Ve||{}),De=(t=>(t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH",t))(De||{}),es=(t=>(t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t))(es||{});const iy={createCanvas:(t,e)=>{const s=document.createElement("canvas");return s.width=t,s.height=e,s},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new DOMParser().parseFromString(t,"text/xml")},ne={ADAPTER:iy,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var Eo=/iPhone/i,_h=/iPod/i,bh=/iPad/i,xh=/\biOS-universal(?:.+)Mac\b/i,Io=/\bAndroid(?:.+)Mobile\b/i,Ah=/Android/i,hr=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,ji=/Silk/i,is=/Windows Phone/i,Th=/\bWindows(?:.+)ARM\b/i,wh=/BlackBerry/i,Eh=/BB10/i,Ih=/Opera Mini/i,Sh=/\b(CriOS|Chrome)(?:.+)Mobile/i,Ch=/Mobile(?:.+)Firefox\b/i,Rh=function(t){return typeof t<"u"&&t.platform==="MacIntel"&&typeof t.maxTouchPoints=="number"&&t.maxTouchPoints>1&&typeof MSStream>"u"};function ny(t){return function(e){return e.test(t)}}function Ph(t){var e={userAgent:"",platform:"",maxTouchPoints:0};!t&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof t=="string"?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0});var s=e.userAgent,r=s.split("[FBAN");typeof r[1]<"u"&&(s=r[0]),r=s.split("Twitter"),typeof r[1]<"u"&&(s=r[0]);var i=ny(s),n={apple:{phone:i(Eo)&&!i(is),ipod:i(_h),tablet:!i(Eo)&&(i(bh)||Rh(e))&&!i(is),universal:i(xh),device:(i(Eo)||i(_h)||i(bh)||i(xh)||Rh(e))&&!i(is)},amazon:{phone:i(hr),tablet:!i(hr)&&i(ji),device:i(hr)||i(ji)},android:{phone:!i(is)&&i(hr)||!i(is)&&i(Io),tablet:!i(is)&&!i(hr)&&!i(Io)&&(i(ji)||i(Ah)),device:!i(is)&&(i(hr)||i(ji)||i(Io)||i(Ah))||i(/\bokhttp\b/i)},windows:{phone:i(is),tablet:i(Th),device:i(is)||i(Th)},other:{blackberry:i(wh),blackberry10:i(Eh),opera:i(Ih),firefox:i(Ch),chrome:i(Sh),device:i(wh)||i(Eh)||i(Ih)||i(Ch)||i(Sh)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}const oy=Ph.default??Ph,Ar=oy(globalThis.navigator);ne.RETINA_PREFIX=/@([0-9\.]+)x/;ne.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var fi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ay(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function ly(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var s=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};s.prototype=e.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(s,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),s}var Cc={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,s="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(s=!1));function i(l,h,u){this.fn=l,this.context=h,this.once=u||!1}function n(l,h,u,c,d){if(typeof u!="function")throw new TypeError("The listener must be a function");var p=new i(u,c||l,d),_=s?s+h:h;return l._events[_]?l._events[_].fn?l._events[_]=[l._events[_],p]:l._events[_].push(p):(l._events[_]=p,l._eventsCount++),l}function o(l,h){--l._eventsCount===0?l._events=new r:delete l._events[h]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var h=[],u,c;if(this._eventsCount===0)return h;for(c in u=this._events)e.call(u,c)&&h.push(s?c.slice(1):c);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(u)):h},a.prototype.listeners=function(h){var u=s?s+h:h,c=this._events[u];if(!c)return[];if(c.fn)return[c.fn];for(var d=0,p=c.length,_=new Array(p);d<p;d++)_[d]=c[d].fn;return _},a.prototype.listenerCount=function(h){var u=s?s+h:h,c=this._events[u];return c?c.fn?1:c.length:0},a.prototype.emit=function(h,u,c,d,p,_){var w=s?s+h:h;if(!this._events[w])return!1;var E=this._events[w],y=arguments.length,v,g;if(E.fn){switch(E.once&&this.removeListener(h,E.fn,void 0,!0),y){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,u),!0;case 3:return E.fn.call(E.context,u,c),!0;case 4:return E.fn.call(E.context,u,c,d),!0;case 5:return E.fn.call(E.context,u,c,d,p),!0;case 6:return E.fn.call(E.context,u,c,d,p,_),!0}for(g=1,v=new Array(y-1);g<y;g++)v[g-1]=arguments[g];E.fn.apply(E.context,v)}else{var b=E.length,T;for(g=0;g<b;g++)switch(E[g].once&&this.removeListener(h,E[g].fn,void 0,!0),y){case 1:E[g].fn.call(E[g].context);break;case 2:E[g].fn.call(E[g].context,u);break;case 3:E[g].fn.call(E[g].context,u,c);break;case 4:E[g].fn.call(E[g].context,u,c,d);break;default:if(!v)for(T=1,v=new Array(y-1);T<y;T++)v[T-1]=arguments[T];E[g].fn.apply(E[g].context,v)}}return!0},a.prototype.on=function(h,u,c){return n(this,h,u,c,!1)},a.prototype.once=function(h,u,c){return n(this,h,u,c,!0)},a.prototype.removeListener=function(h,u,c,d){var p=s?s+h:h;if(!this._events[p])return this;if(!u)return o(this,p),this;var _=this._events[p];if(_.fn)_.fn===u&&(!d||_.once)&&(!c||_.context===c)&&o(this,p);else{for(var w=0,E=[],y=_.length;w<y;w++)(_[w].fn!==u||d&&!_[w].once||c&&_[w].context!==c)&&E.push(_[w]);E.length?this._events[p]=E.length===1?E[0]:E:o(this,p)}return this},a.prototype.removeAllListeners=function(h){var u;return h?(u=s?s+h:h,this._events[u]&&o(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=s,a.EventEmitter=a,t.exports=a})(Cc);var hy=Cc.exports;const Ss=ay(hy);var Rc={exports:{}};Rc.exports=uo;Rc.exports.default=uo;function uo(t,e,s){s=s||2;var r=e&&e.length,i=r?e[0]*s:t.length,n=Pc(t,0,i,s,!0),o=[];if(!n||n.next===n.prev)return o;var a,l,h,u,c,d,p;if(r&&(n=py(t,e,n,s)),t.length>80*s){a=h=t[0],l=u=t[1];for(var _=s;_<i;_+=s)c=t[_],d=t[_+1],c<a&&(a=c),d<l&&(l=d),c>h&&(h=c),d>u&&(u=d);p=Math.max(h-a,u-l),p=p!==0?32767/p:0}return Si(n,o,s,a,l,p,0),o}function Pc(t,e,s,r,i){var n,o;if(i===xa(t,e,s,r)>0)for(n=e;n<s;n+=r)o=Fh(n,t[n],t[n+1],o);else for(n=s-r;n>=e;n-=r)o=Fh(n,t[n],t[n+1],o);return o&&co(o,o.next)&&(Ri(o),o=o.next),o}function rr(t,e){if(!t)return t;e||(e=t);var s=t,r;do if(r=!1,!s.steiner&&(co(s,s.next)||Ne(s.prev,s,s.next)===0)){if(Ri(s),s=e=s.prev,s===s.next)break;r=!0}else s=s.next;while(r||s!==e);return e}function Si(t,e,s,r,i,n,o){if(t){!o&&n&&_y(t,r,i,n);for(var a=t,l,h;t.prev!==t.next;){if(l=t.prev,h=t.next,n?cy(t,r,i,n):uy(t)){e.push(l.i/s|0),e.push(t.i/s|0),e.push(h.i/s|0),Ri(t),t=h.next,a=h.next;continue}if(t=h,t===a){o?o===1?(t=dy(rr(t),e,s),Si(t,e,s,r,i,n,2)):o===2&&fy(t,e,s,r,i,n):Si(rr(t),e,s,r,i,n,1);break}}}}function uy(t){var e=t.prev,s=t,r=t.next;if(Ne(e,s,r)>=0)return!1;for(var i=e.x,n=s.x,o=r.x,a=e.y,l=s.y,h=r.y,u=i<n?i<o?i:o:n<o?n:o,c=a<l?a<h?a:h:l<h?l:h,d=i>n?i>o?i:o:n>o?n:o,p=a>l?a>h?a:h:l>h?l:h,_=r.next;_!==e;){if(_.x>=u&&_.x<=d&&_.y>=c&&_.y<=p&&Tr(i,a,n,l,o,h,_.x,_.y)&&Ne(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function cy(t,e,s,r){var i=t.prev,n=t,o=t.next;if(Ne(i,n,o)>=0)return!1;for(var a=i.x,l=n.x,h=o.x,u=i.y,c=n.y,d=o.y,p=a<l?a<h?a:h:l<h?l:h,_=u<c?u<d?u:d:c<d?c:d,w=a>l?a>h?a:h:l>h?l:h,E=u>c?u>d?u:d:c>d?c:d,y=_a(p,_,e,s,r),v=_a(w,E,e,s,r),g=t.prevZ,b=t.nextZ;g&&g.z>=y&&b&&b.z<=v;){if(g.x>=p&&g.x<=w&&g.y>=_&&g.y<=E&&g!==i&&g!==o&&Tr(a,u,l,c,h,d,g.x,g.y)&&Ne(g.prev,g,g.next)>=0||(g=g.prevZ,b.x>=p&&b.x<=w&&b.y>=_&&b.y<=E&&b!==i&&b!==o&&Tr(a,u,l,c,h,d,b.x,b.y)&&Ne(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;g&&g.z>=y;){if(g.x>=p&&g.x<=w&&g.y>=_&&g.y<=E&&g!==i&&g!==o&&Tr(a,u,l,c,h,d,g.x,g.y)&&Ne(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;b&&b.z<=v;){if(b.x>=p&&b.x<=w&&b.y>=_&&b.y<=E&&b!==i&&b!==o&&Tr(a,u,l,c,h,d,b.x,b.y)&&Ne(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function dy(t,e,s){var r=t;do{var i=r.prev,n=r.next.next;!co(i,n)&&Fc(i,r,r.next,n)&&Ci(i,n)&&Ci(n,i)&&(e.push(i.i/s|0),e.push(r.i/s|0),e.push(n.i/s|0),Ri(r),Ri(r.next),r=t=n),r=r.next}while(r!==t);return rr(r)}function fy(t,e,s,r,i,n){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&Ay(o,a)){var l=Oc(o,a);o=rr(o,o.next),l=rr(l,l.next),Si(o,e,s,r,i,n,0),Si(l,e,s,r,i,n,0);return}a=a.next}o=o.next}while(o!==t)}function py(t,e,s,r){var i=[],n,o,a,l,h;for(n=0,o=e.length;n<o;n++)a=e[n]*r,l=n<o-1?e[n+1]*r:t.length,h=Pc(t,a,l,r,!1),h===h.next&&(h.steiner=!0),i.push(xy(h));for(i.sort(my),n=0;n<i.length;n++)s=yy(i[n],s);return s}function my(t,e){return t.x-e.x}function yy(t,e){var s=gy(t,e);if(!s)return e;var r=Oc(s,t);return rr(r,r.next),rr(s,s.next)}function gy(t,e){var s=e,r=t.x,i=t.y,n=-1/0,o;do{if(i<=s.y&&i>=s.next.y&&s.next.y!==s.y){var a=s.x+(i-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(a<=r&&a>n&&(n=a,o=s.x<s.next.x?s:s.next,a===r))return o}s=s.next}while(s!==e);if(!o)return null;var l=o,h=o.x,u=o.y,c=1/0,d;s=o;do r>=s.x&&s.x>=h&&r!==s.x&&Tr(i<u?r:n,i,h,u,i<u?n:r,i,s.x,s.y)&&(d=Math.abs(i-s.y)/(r-s.x),Ci(s,t)&&(d<c||d===c&&(s.x>o.x||s.x===o.x&&vy(o,s)))&&(o=s,c=d)),s=s.next;while(s!==l);return o}function vy(t,e){return Ne(t.prev,t,e.prev)<0&&Ne(e.next,t,t.next)<0}function _y(t,e,s,r){var i=t;do i.z===0&&(i.z=_a(i.x,i.y,e,s,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,by(i)}function by(t){var e,s,r,i,n,o,a,l,h=1;do{for(s=t,t=null,n=null,o=0;s;){for(o++,r=s,a=0,e=0;e<h&&(a++,r=r.nextZ,!!r);e++);for(l=h;a>0||l>0&&r;)a!==0&&(l===0||!r||s.z<=r.z)?(i=s,s=s.nextZ,a--):(i=r,r=r.nextZ,l--),n?n.nextZ=i:t=i,i.prevZ=n,n=i;s=r}n.nextZ=null,h*=2}while(o>1);return t}function _a(t,e,s,r,i){return t=(t-s)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function xy(t){var e=t,s=t;do(e.x<s.x||e.x===s.x&&e.y<s.y)&&(s=e),e=e.next;while(e!==t);return s}function Tr(t,e,s,r,i,n,o,a){return(i-o)*(e-a)>=(t-o)*(n-a)&&(t-o)*(r-a)>=(s-o)*(e-a)&&(s-o)*(n-a)>=(i-o)*(r-a)}function Ay(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!Ty(t,e)&&(Ci(t,e)&&Ci(e,t)&&wy(t,e)&&(Ne(t.prev,t,e.prev)||Ne(t,e.prev,e))||co(t,e)&&Ne(t.prev,t,t.next)>0&&Ne(e.prev,e,e.next)>0)}function Ne(t,e,s){return(e.y-t.y)*(s.x-e.x)-(e.x-t.x)*(s.y-e.y)}function co(t,e){return t.x===e.x&&t.y===e.y}function Fc(t,e,s,r){var i=Xi(Ne(t,e,s)),n=Xi(Ne(t,e,r)),o=Xi(Ne(s,r,t)),a=Xi(Ne(s,r,e));return!!(i!==n&&o!==a||i===0&&zi(t,s,e)||n===0&&zi(t,r,e)||o===0&&zi(s,t,r)||a===0&&zi(s,e,r))}function zi(t,e,s){return e.x<=Math.max(t.x,s.x)&&e.x>=Math.min(t.x,s.x)&&e.y<=Math.max(t.y,s.y)&&e.y>=Math.min(t.y,s.y)}function Xi(t){return t>0?1:t<0?-1:0}function Ty(t,e){var s=t;do{if(s.i!==t.i&&s.next.i!==t.i&&s.i!==e.i&&s.next.i!==e.i&&Fc(s,s.next,t,e))return!0;s=s.next}while(s!==t);return!1}function Ci(t,e){return Ne(t.prev,t,t.next)<0?Ne(t,e,t.next)>=0&&Ne(t,t.prev,e)>=0:Ne(t,e,t.prev)<0||Ne(t,t.next,e)<0}function wy(t,e){var s=t,r=!1,i=(t.x+e.x)/2,n=(t.y+e.y)/2;do s.y>n!=s.next.y>n&&s.next.y!==s.y&&i<(s.next.x-s.x)*(n-s.y)/(s.next.y-s.y)+s.x&&(r=!r),s=s.next;while(s!==t);return r}function Oc(t,e){var s=new ba(t.i,t.x,t.y),r=new ba(e.i,e.x,e.y),i=t.next,n=e.prev;return t.next=e,e.prev=t,s.next=i,i.prev=s,r.next=s,s.prev=r,n.next=r,r.prev=n,r}function Fh(t,e,s,r){var i=new ba(t,e,s);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Ri(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function ba(t,e,s){this.i=t,this.x=e,this.y=s,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}uo.deviation=function(t,e,s,r){var i=e&&e.length,n=i?e[0]*s:t.length,o=Math.abs(xa(t,0,n,s));if(i)for(var a=0,l=e.length;a<l;a++){var h=e[a]*s,u=a<l-1?e[a+1]*s:t.length;o-=Math.abs(xa(t,h,u,s))}var c=0;for(a=0;a<r.length;a+=3){var d=r[a]*s,p=r[a+1]*s,_=r[a+2]*s;c+=Math.abs((t[d]-t[_])*(t[p+1]-t[d+1])-(t[d]-t[p])*(t[_+1]-t[d+1]))}return o===0&&c===0?0:Math.abs((c-o)/o)};function xa(t,e,s,r){for(var i=0,n=e,o=s-r;n<s;n+=r)i+=(t[o]-t[n])*(t[n+1]+t[o+1]),o=n;return i}uo.flatten=function(t){for(var e=t[0][0].length,s={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var n=0;n<t[i].length;n++)for(var o=0;o<e;o++)s.vertices.push(t[i][n][o]);i>0&&(r+=t[i-1].length,s.holes.push(r))}return s};var Sn={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */Sn.exports;(function(t,e){(function(s){var r=e&&!e.nodeType&&e,i=t&&!t.nodeType&&t,n=typeof fi=="object"&&fi;(n.global===n||n.window===n||n.self===n)&&(s=n);var o,a=2147483647,l=36,h=1,u=26,c=38,d=700,p=72,_=128,w="-",E=/^xn--/,y=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,g={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},b=l-h,T=Math.floor,A=String.fromCharCode,x;function N(q){throw new RangeError(g[q])}function V(q,Z){for(var re=q.length,Se=[];re--;)Se[re]=Z(q[re]);return Se}function W(q,Z){var re=q.split("@"),Se="";re.length>1&&(Se=re[0]+"@",q=re[1]),q=q.replace(v,".");var Oe=q.split("."),Ke=V(Oe,Z).join(".");return Se+Ke}function ue(q){for(var Z=[],re=0,Se=q.length,Oe,Ke;re<Se;)Oe=q.charCodeAt(re++),Oe>=55296&&Oe<=56319&&re<Se?(Ke=q.charCodeAt(re++),(Ke&64512)==56320?Z.push(((Oe&1023)<<10)+(Ke&1023)+65536):(Z.push(Oe),re--)):Z.push(Oe);return Z}function ie(q){return V(q,function(Z){var re="";return Z>65535&&(Z-=65536,re+=A(Z>>>10&1023|55296),Z=56320|Z&1023),re+=A(Z),re}).join("")}function be(q){return q-48<10?q-22:q-65<26?q-65:q-97<26?q-97:l}function fe(q,Z){return q+22+75*(q<26)-((Z!=0)<<5)}function He(q,Z,re){var Se=0;for(q=re?T(q/d):q>>1,q+=T(q/Z);q>b*u>>1;Se+=l)q=T(q/b);return T(Se+(b+1)*q/(q+c))}function pe(q){var Z=[],re=q.length,Se,Oe=0,Ke=_,Ie=p,$e,dt,Ze,yt,ke,f,m,I,S;for($e=q.lastIndexOf(w),$e<0&&($e=0),dt=0;dt<$e;++dt)q.charCodeAt(dt)>=128&&N("not-basic"),Z.push(q.charCodeAt(dt));for(Ze=$e>0?$e+1:0;Ze<re;){for(yt=Oe,ke=1,f=l;Ze>=re&&N("invalid-input"),m=be(q.charCodeAt(Ze++)),(m>=l||m>T((a-Oe)/ke))&&N("overflow"),Oe+=m*ke,I=f<=Ie?h:f>=Ie+u?u:f-Ie,!(m<I);f+=l)S=l-I,ke>T(a/S)&&N("overflow"),ke*=S;Se=Z.length+1,Ie=He(Oe-yt,Se,yt==0),T(Oe/Se)>a-Ke&&N("overflow"),Ke+=T(Oe/Se),Oe%=Se,Z.splice(Oe++,0,Ke)}return ie(Z)}function Ae(q){var Z,re,Se,Oe,Ke,Ie,$e,dt,Ze,yt,ke,f=[],m,I,S,C;for(q=ue(q),m=q.length,Z=_,re=0,Ke=p,Ie=0;Ie<m;++Ie)ke=q[Ie],ke<128&&f.push(A(ke));for(Se=Oe=f.length,Oe&&f.push(w);Se<m;){for($e=a,Ie=0;Ie<m;++Ie)ke=q[Ie],ke>=Z&&ke<$e&&($e=ke);for(I=Se+1,$e-Z>T((a-re)/I)&&N("overflow"),re+=($e-Z)*I,Z=$e,Ie=0;Ie<m;++Ie)if(ke=q[Ie],ke<Z&&++re>a&&N("overflow"),ke==Z){for(dt=re,Ze=l;yt=Ze<=Ke?h:Ze>=Ke+u?u:Ze-Ke,!(dt<yt);Ze+=l)C=dt-yt,S=l-yt,f.push(A(fe(yt+C%S,0))),dt=T(C/S);f.push(A(fe(dt,0))),Ke=He(re,I,Se==Oe),re=0,++Se}++re,++Z}return f.join("")}function we(q){return W(q,function(Z){return E.test(Z)?pe(Z.slice(4).toLowerCase()):Z})}function rs(q){return W(q,function(Z){return y.test(Z)?"xn--"+Ae(Z):Z})}if(o={version:"1.4.1",ucs2:{decode:ue,encode:ie},decode:pe,encode:Ae,toASCII:rs,toUnicode:we},r&&i)if(t.exports==r)i.exports=o;else for(x in o)o.hasOwnProperty(x)&&(r[x]=o[x]);else s.punycode=o})(fi)})(Sn,Sn.exports);var Ey=Sn.exports,Iy=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},s=Symbol("test"),r=Object(s);if(typeof s=="string"||Object.prototype.toString.call(s)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var i=42;e[s]=i;for(s in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var n=Object.getOwnPropertySymbols(e);if(n.length!==1||n[0]!==s||!Object.prototype.propertyIsEnumerable.call(e,s))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,s);if(o.value!==i||o.enumerable!==!0)return!1}return!0},Oh=typeof Symbol<"u"&&Symbol,Sy=Iy,Cy=function(){return typeof Oh!="function"||typeof Symbol!="function"||typeof Oh("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:Sy()},Mh={foo:{}},Ry=Object,Py=function(){return{__proto__:Mh}.foo===Mh.foo&&!({__proto__:null}instanceof Ry)},Fy="Function.prototype.bind called on incompatible ",Oy=Object.prototype.toString,My=Math.max,Ny="[object Function]",Nh=function(e,s){for(var r=[],i=0;i<e.length;i+=1)r[i]=e[i];for(var n=0;n<s.length;n+=1)r[n+e.length]=s[n];return r},By=function(e,s){for(var r=[],i=s||0,n=0;i<e.length;i+=1,n+=1)r[n]=e[i];return r},Ly=function(t,e){for(var s="",r=0;r<t.length;r+=1)s+=t[r],r+1<t.length&&(s+=e);return s},ky=function(e){var s=this;if(typeof s!="function"||Oy.apply(s)!==Ny)throw new TypeError(Fy+s);for(var r=By(arguments,1),i,n=function(){if(this instanceof i){var u=s.apply(this,Nh(r,arguments));return Object(u)===u?u:this}return s.apply(e,Nh(r,arguments))},o=My(0,s.length-r.length),a=[],l=0;l<o;l++)a[l]="$"+l;if(i=Function("binder","return function ("+Ly(a,",")+"){ return binder.apply(this,arguments); }")(n),s.prototype){var h=function(){};h.prototype=s.prototype,i.prototype=new h,h.prototype=null}return i},Uy=ky,_l=Function.prototype.bind||Uy,Dy=Function.prototype.call,Gy=Object.prototype.hasOwnProperty,Hy=_l,$y=Hy.call(Dy,Gy),de,Dr=SyntaxError,Mc=Function,Or=TypeError,So=function(t){try{return Mc('"use strict"; return ('+t+").constructor;")()}catch{}},Qs=Object.getOwnPropertyDescriptor;if(Qs)try{Qs({},"")}catch{Qs=null}var Co=function(){throw new Or},Vy=Qs?function(){try{return arguments.callee,Co}catch{try{return Qs(arguments,"callee").get}catch{return Co}}}():Co,ur=Cy(),qy=Py(),We=Object.getPrototypeOf||(qy?function(t){return t.__proto__}:null),mr={},Wy=typeof Uint8Array>"u"||!We?de:We(Uint8Array),Ys={"%AggregateError%":typeof AggregateError>"u"?de:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?de:ArrayBuffer,"%ArrayIteratorPrototype%":ur&&We?We([][Symbol.iterator]()):de,"%AsyncFromSyncIteratorPrototype%":de,"%AsyncFunction%":mr,"%AsyncGenerator%":mr,"%AsyncGeneratorFunction%":mr,"%AsyncIteratorPrototype%":mr,"%Atomics%":typeof Atomics>"u"?de:Atomics,"%BigInt%":typeof BigInt>"u"?de:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?de:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?de:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?de:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?de:Float32Array,"%Float64Array%":typeof Float64Array>"u"?de:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?de:FinalizationRegistry,"%Function%":Mc,"%GeneratorFunction%":mr,"%Int8Array%":typeof Int8Array>"u"?de:Int8Array,"%Int16Array%":typeof Int16Array>"u"?de:Int16Array,"%Int32Array%":typeof Int32Array>"u"?de:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":ur&&We?We(We([][Symbol.iterator]())):de,"%JSON%":typeof JSON=="object"?JSON:de,"%Map%":typeof Map>"u"?de:Map,"%MapIteratorPrototype%":typeof Map>"u"||!ur||!We?de:We(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?de:Promise,"%Proxy%":typeof Proxy>"u"?de:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?de:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?de:Set,"%SetIteratorPrototype%":typeof Set>"u"||!ur||!We?de:We(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?de:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":ur&&We?We(""[Symbol.iterator]()):de,"%Symbol%":ur?Symbol:de,"%SyntaxError%":Dr,"%ThrowTypeError%":Vy,"%TypedArray%":Wy,"%TypeError%":Or,"%Uint8Array%":typeof Uint8Array>"u"?de:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?de:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?de:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?de:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?de:WeakMap,"%WeakRef%":typeof WeakRef>"u"?de:WeakRef,"%WeakSet%":typeof WeakSet>"u"?de:WeakSet};if(We)try{null.error}catch(t){var jy=We(We(t));Ys["%Error.prototype%"]=jy}var zy=function t(e){var s;if(e==="%AsyncFunction%")s=So("async function () {}");else if(e==="%GeneratorFunction%")s=So("function* () {}");else if(e==="%AsyncGeneratorFunction%")s=So("async function* () {}");else if(e==="%AsyncGenerator%"){var r=t("%AsyncGeneratorFunction%");r&&(s=r.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=t("%AsyncGenerator%");i&&We&&(s=We(i.prototype))}return Ys[e]=s,s},Bh={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Ui=_l,Cn=$y,Xy=Ui.call(Function.call,Array.prototype.concat),Ky=Ui.call(Function.apply,Array.prototype.splice),Lh=Ui.call(Function.call,String.prototype.replace),Rn=Ui.call(Function.call,String.prototype.slice),Zy=Ui.call(Function.call,RegExp.prototype.exec),Qy=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Yy=/\\(\\)?/g,Jy=function(e){var s=Rn(e,0,1),r=Rn(e,-1);if(s==="%"&&r!=="%")throw new Dr("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&s!=="%")throw new Dr("invalid intrinsic syntax, expected opening `%`");var i=[];return Lh(e,Qy,function(n,o,a,l){i[i.length]=a?Lh(l,Yy,"$1"):o||n}),i},eg=function(e,s){var r=e,i;if(Cn(Bh,r)&&(i=Bh[r],r="%"+i[0]+"%"),Cn(Ys,r)){var n=Ys[r];if(n===mr&&(n=zy(r)),typeof n>"u"&&!s)throw new Or("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:r,value:n}}throw new Dr("intrinsic "+e+" does not exist!")},nr=function(e,s){if(typeof e!="string"||e.length===0)throw new Or("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof s!="boolean")throw new Or('"allowMissing" argument must be a boolean');if(Zy(/^%?[^%]*%?$/,e)===null)throw new Dr("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=Jy(e),i=r.length>0?r[0]:"",n=eg("%"+i+"%",s),o=n.name,a=n.value,l=!1,h=n.alias;h&&(i=h[0],Ky(r,Xy([0,1],h)));for(var u=1,c=!0;u<r.length;u+=1){var d=r[u],p=Rn(d,0,1),_=Rn(d,-1);if((p==='"'||p==="'"||p==="`"||_==='"'||_==="'"||_==="`")&&p!==_)throw new Dr("property names with quotes must have matching quotes");if((d==="constructor"||!c)&&(l=!0),i+="."+d,o="%"+i+"%",Cn(Ys,o))a=Ys[o];else if(a!=null){if(!(d in a)){if(!s)throw new Or("base intrinsic for "+e+" exists, but the property is not available.");return}if(Qs&&u+1>=r.length){var w=Qs(a,d);c=!!w,c&&"get"in w&&!("originalValue"in w.get)?a=w.get:a=a[d]}else c=Cn(a,d),a=a[d];c&&!l&&(Ys[o]=a)}}return a},Nc={exports:{}},tg=nr,Aa=tg("%Object.defineProperty%",!0),Ta=function(){if(Aa)try{return Aa({},"a",{value:1}),!0}catch{return!1}return!1};Ta.hasArrayLengthDefineBug=function(){if(!Ta())return null;try{return Aa([],"length",{value:1}).length!==1}catch{return!0}};var Bc=Ta,sg=nr,pn=sg("%Object.getOwnPropertyDescriptor%",!0);if(pn)try{pn([],"length")}catch{pn=null}var Lc=pn,rg=Bc(),bl=nr,pi=rg&&bl("%Object.defineProperty%",!0);if(pi)try{pi({},"a",{value:1})}catch{pi=!1}var ig=bl("%SyntaxError%"),cr=bl("%TypeError%"),kh=Lc,ng=function(e,s,r){if(!e||typeof e!="object"&&typeof e!="function")throw new cr("`obj` must be an object or a function`");if(typeof s!="string"&&typeof s!="symbol")throw new cr("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new cr("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new cr("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new cr("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new cr("`loose`, if provided, must be a boolean");var i=arguments.length>3?arguments[3]:null,n=arguments.length>4?arguments[4]:null,o=arguments.length>5?arguments[5]:null,a=arguments.length>6?arguments[6]:!1,l=!!kh&&kh(e,s);if(pi)pi(e,s,{configurable:o===null&&l?l.configurable:!o,enumerable:i===null&&l?l.enumerable:!i,value:r,writable:n===null&&l?l.writable:!n});else if(a||!i&&!n&&!o)e[s]=r;else throw new ig("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},kc=nr,Uh=ng,og=Bc(),Dh=Lc,Gh=kc("%TypeError%"),ag=kc("%Math.floor%"),lg=function(e,s){if(typeof e!="function")throw new Gh("`fn` is not a function");if(typeof s!="number"||s<0||s>4294967295||ag(s)!==s)throw new Gh("`length` must be a positive 32-bit integer");var r=arguments.length>2&&!!arguments[2],i=!0,n=!0;if("length"in e&&Dh){var o=Dh(e,"length");o&&!o.configurable&&(i=!1),o&&!o.writable&&(n=!1)}return(i||n||!r)&&(og?Uh(e,"length",s,!0,!0):Uh(e,"length",s)),e};(function(t){var e=_l,s=nr,r=lg,i=s("%TypeError%"),n=s("%Function.prototype.apply%"),o=s("%Function.prototype.call%"),a=s("%Reflect.apply%",!0)||e.call(o,n),l=s("%Object.defineProperty%",!0),h=s("%Math.max%");if(l)try{l({},"a",{value:1})}catch{l=null}t.exports=function(d){if(typeof d!="function")throw new i("a function is required");var p=a(e,o,arguments);return r(p,1+h(0,d.length-(arguments.length-1)),!0)};var u=function(){return a(e,n,arguments)};l?l(t.exports,"apply",{value:u}):t.exports.apply=u})(Nc);var hg=Nc.exports,Uc=nr,Dc=hg,ug=Dc(Uc("String.prototype.indexOf")),cg=function(e,s){var r=Uc(e,!!s);return typeof r=="function"&&ug(e,".prototype.")>-1?Dc(r):r};const dg={},fg=Object.freeze(Object.defineProperty({__proto__:null,default:dg},Symbol.toStringTag,{value:"Module"})),pg=ly(fg);var xl=typeof Map=="function"&&Map.prototype,Ro=Object.getOwnPropertyDescriptor&&xl?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Pn=xl&&Ro&&typeof Ro.get=="function"?Ro.get:null,Hh=xl&&Map.prototype.forEach,Al=typeof Set=="function"&&Set.prototype,Po=Object.getOwnPropertyDescriptor&&Al?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Fn=Al&&Po&&typeof Po.get=="function"?Po.get:null,$h=Al&&Set.prototype.forEach,mg=typeof WeakMap=="function"&&WeakMap.prototype,mi=mg?WeakMap.prototype.has:null,yg=typeof WeakSet=="function"&&WeakSet.prototype,yi=yg?WeakSet.prototype.has:null,gg=typeof WeakRef=="function"&&WeakRef.prototype,Vh=gg?WeakRef.prototype.deref:null,vg=Boolean.prototype.valueOf,_g=Object.prototype.toString,bg=Function.prototype.toString,xg=String.prototype.match,Tl=String.prototype.slice,xs=String.prototype.replace,Ag=String.prototype.toUpperCase,qh=String.prototype.toLowerCase,Gc=RegExp.prototype.test,Wh=Array.prototype.concat,Zt=Array.prototype.join,Tg=Array.prototype.slice,jh=Math.floor,wa=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Fo=Object.getOwnPropertySymbols,Ea=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Gr=typeof Symbol=="function"&&typeof Symbol.iterator=="object",nt=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Gr||"symbol")?Symbol.toStringTag:null,Hc=Object.prototype.propertyIsEnumerable,zh=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function Xh(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||Gc.call(/e/,e))return e;var s=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var r=t<0?-jh(-t):jh(t);if(r!==t){var i=String(r),n=Tl.call(e,i.length+1);return xs.call(i,s,"$&_")+"."+xs.call(xs.call(n,/([0-9]{3})/g,"$&_"),/_$/,"")}}return xs.call(e,s,"$&_")}var Ia=pg,Kh=Ia.custom,Zh=Vc(Kh)?Kh:null,wg=function t(e,s,r,i){var n=s||{};if(_s(n,"quoteStyle")&&n.quoteStyle!=="single"&&n.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(_s(n,"maxStringLength")&&(typeof n.maxStringLength=="number"?n.maxStringLength<0&&n.maxStringLength!==1/0:n.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=_s(n,"customInspect")?n.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(_s(n,"indent")&&n.indent!==null&&n.indent!=="	"&&!(parseInt(n.indent,10)===n.indent&&n.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(_s(n,"numericSeparator")&&typeof n.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=n.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return Wc(e,n);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var l=String(e);return a?Xh(e,l):l}if(typeof e=="bigint"){var h=String(e)+"n";return a?Xh(e,h):h}var u=typeof n.depth>"u"?5:n.depth;if(typeof r>"u"&&(r=0),r>=u&&u>0&&typeof e=="object")return Sa(e)?"[Array]":"[Object]";var c=$g(n,r);if(typeof i>"u")i=[];else if(qc(i,e)>=0)return"[Circular]";function d(be,fe,He){if(fe&&(i=Tg.call(i),i.push(fe)),He){var pe={depth:n.depth};return _s(n,"quoteStyle")&&(pe.quoteStyle=n.quoteStyle),t(be,pe,r+1,i)}return t(be,n,r+1,i)}if(typeof e=="function"&&!Qh(e)){var p=Mg(e),_=Ki(e,d);return"[Function"+(p?": "+p:" (anonymous)")+"]"+(_.length>0?" { "+Zt.call(_,", ")+" }":"")}if(Vc(e)){var w=Gr?xs.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):Ea.call(e);return typeof e=="object"&&!Gr?Jr(w):w}if(Dg(e)){for(var E="<"+qh.call(String(e.nodeName)),y=e.attributes||[],v=0;v<y.length;v++)E+=" "+y[v].name+"="+$c(Eg(y[v].value),"double",n);return E+=">",e.childNodes&&e.childNodes.length&&(E+="..."),E+="</"+qh.call(String(e.nodeName))+">",E}if(Sa(e)){if(e.length===0)return"[]";var g=Ki(e,d);return c&&!Hg(g)?"["+Ca(g,c)+"]":"[ "+Zt.call(g,", ")+" ]"}if(Sg(e)){var b=Ki(e,d);return!("cause"in Error.prototype)&&"cause"in e&&!Hc.call(e,"cause")?"{ ["+String(e)+"] "+Zt.call(Wh.call("[cause]: "+d(e.cause),b),", ")+" }":b.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+Zt.call(b,", ")+" }"}if(typeof e=="object"&&o){if(Zh&&typeof e[Zh]=="function"&&Ia)return Ia(e,{depth:u-r});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(Ng(e)){var T=[];return Hh&&Hh.call(e,function(be,fe){T.push(d(fe,e,!0)+" => "+d(be,e))}),Yh("Map",Pn.call(e),T,c)}if(kg(e)){var A=[];return $h&&$h.call(e,function(be){A.push(d(be,e))}),Yh("Set",Fn.call(e),A,c)}if(Bg(e))return Oo("WeakMap");if(Ug(e))return Oo("WeakSet");if(Lg(e))return Oo("WeakRef");if(Rg(e))return Jr(d(Number(e)));if(Fg(e))return Jr(d(wa.call(e)));if(Pg(e))return Jr(vg.call(e));if(Cg(e))return Jr(d(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(e===fi)return"{ [object globalThis] }";if(!Ig(e)&&!Qh(e)){var x=Ki(e,d),N=zh?zh(e)===Object.prototype:e instanceof Object||e.constructor===Object,V=e instanceof Object?"":"null prototype",W=!N&&nt&&Object(e)===e&&nt in e?Tl.call(Cs(e),8,-1):V?"Object":"",ue=N||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",ie=ue+(W||V?"["+Zt.call(Wh.call([],W||[],V||[]),": ")+"] ":"");return x.length===0?ie+"{}":c?ie+"{"+Ca(x,c)+"}":ie+"{ "+Zt.call(x,", ")+" }"}return String(e)};function $c(t,e,s){var r=(s.quoteStyle||e)==="double"?'"':"'";return r+t+r}function Eg(t){return xs.call(String(t),/"/g,"&quot;")}function Sa(t){return Cs(t)==="[object Array]"&&(!nt||!(typeof t=="object"&&nt in t))}function Ig(t){return Cs(t)==="[object Date]"&&(!nt||!(typeof t=="object"&&nt in t))}function Qh(t){return Cs(t)==="[object RegExp]"&&(!nt||!(typeof t=="object"&&nt in t))}function Sg(t){return Cs(t)==="[object Error]"&&(!nt||!(typeof t=="object"&&nt in t))}function Cg(t){return Cs(t)==="[object String]"&&(!nt||!(typeof t=="object"&&nt in t))}function Rg(t){return Cs(t)==="[object Number]"&&(!nt||!(typeof t=="object"&&nt in t))}function Pg(t){return Cs(t)==="[object Boolean]"&&(!nt||!(typeof t=="object"&&nt in t))}function Vc(t){if(Gr)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!Ea)return!1;try{return Ea.call(t),!0}catch{}return!1}function Fg(t){if(!t||typeof t!="object"||!wa)return!1;try{return wa.call(t),!0}catch{}return!1}var Og=Object.prototype.hasOwnProperty||function(t){return t in this};function _s(t,e){return Og.call(t,e)}function Cs(t){return _g.call(t)}function Mg(t){if(t.name)return t.name;var e=xg.call(bg.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function qc(t,e){if(t.indexOf)return t.indexOf(e);for(var s=0,r=t.length;s<r;s++)if(t[s]===e)return s;return-1}function Ng(t){if(!Pn||!t||typeof t!="object")return!1;try{Pn.call(t);try{Fn.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function Bg(t){if(!mi||!t||typeof t!="object")return!1;try{mi.call(t,mi);try{yi.call(t,yi)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function Lg(t){if(!Vh||!t||typeof t!="object")return!1;try{return Vh.call(t),!0}catch{}return!1}function kg(t){if(!Fn||!t||typeof t!="object")return!1;try{Fn.call(t);try{Pn.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function Ug(t){if(!yi||!t||typeof t!="object")return!1;try{yi.call(t,yi);try{mi.call(t,mi)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function Dg(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function Wc(t,e){if(t.length>e.maxStringLength){var s=t.length-e.maxStringLength,r="... "+s+" more character"+(s>1?"s":"");return Wc(Tl.call(t,0,e.maxStringLength),e)+r}var i=xs.call(xs.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,Gg);return $c(i,"single",e)}function Gg(t){var e=t.charCodeAt(0),s={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return s?"\\"+s:"\\x"+(e<16?"0":"")+Ag.call(e.toString(16))}function Jr(t){return"Object("+t+")"}function Oo(t){return t+" { ? }"}function Yh(t,e,s,r){var i=r?Ca(s,r):Zt.call(s,", ");return t+" ("+e+") {"+i+"}"}function Hg(t){for(var e=0;e<t.length;e++)if(qc(t[e],`
`)>=0)return!1;return!0}function $g(t,e){var s;if(t.indent==="	")s="	";else if(typeof t.indent=="number"&&t.indent>0)s=Zt.call(Array(t.indent+1)," ");else return null;return{base:s,prev:Zt.call(Array(e+1),s)}}function Ca(t,e){if(t.length===0)return"";var s=`
`+e.prev+e.base;return s+Zt.call(t,","+s)+`
`+e.prev}function Ki(t,e){var s=Sa(t),r=[];if(s){r.length=t.length;for(var i=0;i<t.length;i++)r[i]=_s(t,i)?e(t[i],t):""}var n=typeof Fo=="function"?Fo(t):[],o;if(Gr){o={};for(var a=0;a<n.length;a++)o["$"+n[a]]=n[a]}for(var l in t)_s(t,l)&&(s&&String(Number(l))===l&&l<t.length||Gr&&o["$"+l]instanceof Symbol||(Gc.call(/[^\w$]/,l)?r.push(e(l,t)+": "+e(t[l],t)):r.push(l+": "+e(t[l],t))));if(typeof Fo=="function")for(var h=0;h<n.length;h++)Hc.call(t,n[h])&&r.push("["+e(n[h])+"]: "+e(t[n[h]],t));return r}var wl=nr,zr=cg,Vg=wg,qg=wl("%TypeError%"),Zi=wl("%WeakMap%",!0),Qi=wl("%Map%",!0),Wg=zr("WeakMap.prototype.get",!0),jg=zr("WeakMap.prototype.set",!0),zg=zr("WeakMap.prototype.has",!0),Xg=zr("Map.prototype.get",!0),Kg=zr("Map.prototype.set",!0),Zg=zr("Map.prototype.has",!0),El=function(t,e){for(var s=t,r;(r=s.next)!==null;s=r)if(r.key===e)return s.next=r.next,r.next=t.next,t.next=r,r},Qg=function(t,e){var s=El(t,e);return s&&s.value},Yg=function(t,e,s){var r=El(t,e);r?r.value=s:t.next={key:e,next:t.next,value:s}},Jg=function(t,e){return!!El(t,e)},ev=function(){var e,s,r,i={assert:function(n){if(!i.has(n))throw new qg("Side channel does not contain "+Vg(n))},get:function(n){if(Zi&&n&&(typeof n=="object"||typeof n=="function")){if(e)return Wg(e,n)}else if(Qi){if(s)return Xg(s,n)}else if(r)return Qg(r,n)},has:function(n){if(Zi&&n&&(typeof n=="object"||typeof n=="function")){if(e)return zg(e,n)}else if(Qi){if(s)return Zg(s,n)}else if(r)return Jg(r,n);return!1},set:function(n,o){Zi&&n&&(typeof n=="object"||typeof n=="function")?(e||(e=new Zi),jg(e,n,o)):Qi?(s||(s=new Qi),Kg(s,n,o)):(r||(r={key:{},next:null}),Yg(r,n,o))}};return i},tv=String.prototype.replace,sv=/%20/g,Mo={RFC1738:"RFC1738",RFC3986:"RFC3986"},Il={default:Mo.RFC3986,formatters:{RFC1738:function(t){return tv.call(t,sv,"+")},RFC3986:function(t){return String(t)}},RFC1738:Mo.RFC1738,RFC3986:Mo.RFC3986},rv=Il,No=Object.prototype.hasOwnProperty,qs=Array.isArray,jt=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),iv=function(e){for(;e.length>1;){var s=e.pop(),r=s.obj[s.prop];if(qs(r)){for(var i=[],n=0;n<r.length;++n)typeof r[n]<"u"&&i.push(r[n]);s.obj[s.prop]=i}}},jc=function(e,s){for(var r=s&&s.plainObjects?Object.create(null):{},i=0;i<e.length;++i)typeof e[i]<"u"&&(r[i]=e[i]);return r},nv=function t(e,s,r){if(!s)return e;if(typeof s!="object"){if(qs(e))e.push(s);else if(e&&typeof e=="object")(r&&(r.plainObjects||r.allowPrototypes)||!No.call(Object.prototype,s))&&(e[s]=!0);else return[e,s];return e}if(!e||typeof e!="object")return[e].concat(s);var i=e;return qs(e)&&!qs(s)&&(i=jc(e,r)),qs(e)&&qs(s)?(s.forEach(function(n,o){if(No.call(e,o)){var a=e[o];a&&typeof a=="object"&&n&&typeof n=="object"?e[o]=t(a,n,r):e.push(n)}else e[o]=n}),e):Object.keys(s).reduce(function(n,o){var a=s[o];return No.call(n,o)?n[o]=t(n[o],a,r):n[o]=a,n},i)},ov=function(e,s){return Object.keys(s).reduce(function(r,i){return r[i]=s[i],r},e)},av=function(t,e,s){var r=t.replace(/\+/g," ");if(s==="iso-8859-1")return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch{return r}},lv=function(e,s,r,i,n){if(e.length===0)return e;var o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),r==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(u){return"%26%23"+parseInt(u.slice(2),16)+"%3B"});for(var a="",l=0;l<o.length;++l){var h=o.charCodeAt(l);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||n===rv.RFC1738&&(h===40||h===41)){a+=o.charAt(l);continue}if(h<128){a=a+jt[h];continue}if(h<2048){a=a+(jt[192|h>>6]+jt[128|h&63]);continue}if(h<55296||h>=57344){a=a+(jt[224|h>>12]+jt[128|h>>6&63]+jt[128|h&63]);continue}l+=1,h=65536+((h&1023)<<10|o.charCodeAt(l)&1023),a+=jt[240|h>>18]+jt[128|h>>12&63]+jt[128|h>>6&63]+jt[128|h&63]}return a},hv=function(e){for(var s=[{obj:{o:e},prop:"o"}],r=[],i=0;i<s.length;++i)for(var n=s[i],o=n.obj[n.prop],a=Object.keys(o),l=0;l<a.length;++l){var h=a[l],u=o[h];typeof u=="object"&&u!==null&&r.indexOf(u)===-1&&(s.push({obj:o,prop:h}),r.push(u))}return iv(s),e},uv=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},cv=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},dv=function(e,s){return[].concat(e,s)},fv=function(e,s){if(qs(e)){for(var r=[],i=0;i<e.length;i+=1)r.push(s(e[i]));return r}return s(e)},zc={arrayToObject:jc,assign:ov,combine:dv,compact:hv,decode:av,encode:lv,isBuffer:cv,isRegExp:uv,maybeMap:fv,merge:nv},Xc=ev,mn=zc,gi=Il,pv=Object.prototype.hasOwnProperty,Jh={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,s){return e+"["+s+"]"},repeat:function(e){return e}},ls=Array.isArray,mv=Array.prototype.push,Kc=function(t,e){mv.apply(t,ls(e)?e:[e])},yv=Date.prototype.toISOString,eu=gi.default,et={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:mn.encode,encodeValuesOnly:!1,format:eu,formatter:gi.formatters[eu],indices:!1,serializeDate:function(e){return yv.call(e)},skipNulls:!1,strictNullHandling:!1},gv=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},Bo={},vv=function t(e,s,r,i,n,o,a,l,h,u,c,d,p,_,w,E){for(var y=e,v=E,g=0,b=!1;(v=v.get(Bo))!==void 0&&!b;){var T=v.get(e);if(g+=1,typeof T<"u"){if(T===g)throw new RangeError("Cyclic object value");b=!0}typeof v.get(Bo)>"u"&&(g=0)}if(typeof l=="function"?y=l(s,y):y instanceof Date?y=c(y):r==="comma"&&ls(y)&&(y=mn.maybeMap(y,function(pe){return pe instanceof Date?c(pe):pe})),y===null){if(n)return a&&!_?a(s,et.encoder,w,"key",d):s;y=""}if(gv(y)||mn.isBuffer(y)){if(a){var A=_?s:a(s,et.encoder,w,"key",d);return[p(A)+"="+p(a(y,et.encoder,w,"value",d))]}return[p(s)+"="+p(String(y))]}var x=[];if(typeof y>"u")return x;var N;if(r==="comma"&&ls(y))_&&a&&(y=mn.maybeMap(y,a)),N=[{value:y.length>0?y.join(",")||null:void 0}];else if(ls(l))N=l;else{var V=Object.keys(y);N=h?V.sort(h):V}for(var W=i&&ls(y)&&y.length===1?s+"[]":s,ue=0;ue<N.length;++ue){var ie=N[ue],be=typeof ie=="object"&&typeof ie.value<"u"?ie.value:y[ie];if(!(o&&be===null)){var fe=ls(y)?typeof r=="function"?r(W,ie):W:W+(u?"."+ie:"["+ie+"]");E.set(e,g);var He=Xc();He.set(Bo,E),Kc(x,t(be,fe,r,i,n,o,r==="comma"&&_&&ls(y)?null:a,l,h,u,c,d,p,_,w,He))}}return x},_v=function(e){if(!e)return et;if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var s=e.charset||et.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=gi.default;if(typeof e.format<"u"){if(!pv.call(gi.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var i=gi.formatters[r],n=et.filter;return(typeof e.filter=="function"||ls(e.filter))&&(n=e.filter),{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:et.addQueryPrefix,allowDots:typeof e.allowDots>"u"?et.allowDots:!!e.allowDots,charset:s,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:et.charsetSentinel,delimiter:typeof e.delimiter>"u"?et.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:et.encode,encoder:typeof e.encoder=="function"?e.encoder:et.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:et.encodeValuesOnly,filter:n,format:r,formatter:i,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:et.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:et.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:et.strictNullHandling}},bv=function(t,e){var s=t,r=_v(e),i,n;typeof r.filter=="function"?(n=r.filter,s=n("",s)):ls(r.filter)&&(n=r.filter,i=n);var o=[];if(typeof s!="object"||s===null)return"";var a;e&&e.arrayFormat in Jh?a=e.arrayFormat:e&&"indices"in e?a=e.indices?"indices":"repeat":a="indices";var l=Jh[a];if(e&&"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var h=l==="comma"&&e&&e.commaRoundTrip;i||(i=Object.keys(s)),r.sort&&i.sort(r.sort);for(var u=Xc(),c=0;c<i.length;++c){var d=i[c];r.skipNulls&&s[d]===null||Kc(o,vv(s[d],d,l,h,r.strictNullHandling,r.skipNulls,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,u))}var p=o.join(r.delimiter),_=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?_+="utf8=%26%2310003%3B&":_+="utf8=%E2%9C%93&"),p.length>0?_+p:""},Hr=zc,Ra=Object.prototype.hasOwnProperty,xv=Array.isArray,qe={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:Hr.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},Av=function(t){return t.replace(/&#(\d+);/g,function(e,s){return String.fromCharCode(parseInt(s,10))})},Zc=function(t,e){return t&&typeof t=="string"&&e.comma&&t.indexOf(",")>-1?t.split(","):t},Tv="utf8=%26%2310003%3B",wv="utf8=%E2%9C%93",Ev=function(e,s){var r={__proto__:null},i=s.ignoreQueryPrefix?e.replace(/^\?/,""):e,n=s.parameterLimit===1/0?void 0:s.parameterLimit,o=i.split(s.delimiter,n),a=-1,l,h=s.charset;if(s.charsetSentinel)for(l=0;l<o.length;++l)o[l].indexOf("utf8=")===0&&(o[l]===wv?h="utf-8":o[l]===Tv&&(h="iso-8859-1"),a=l,l=o.length);for(l=0;l<o.length;++l)if(l!==a){var u=o[l],c=u.indexOf("]="),d=c===-1?u.indexOf("="):c+1,p,_;d===-1?(p=s.decoder(u,qe.decoder,h,"key"),_=s.strictNullHandling?null:""):(p=s.decoder(u.slice(0,d),qe.decoder,h,"key"),_=Hr.maybeMap(Zc(u.slice(d+1),s),function(w){return s.decoder(w,qe.decoder,h,"value")})),_&&s.interpretNumericEntities&&h==="iso-8859-1"&&(_=Av(_)),u.indexOf("[]=")>-1&&(_=xv(_)?[_]:_),Ra.call(r,p)?r[p]=Hr.combine(r[p],_):r[p]=_}return r},Iv=function(t,e,s,r){for(var i=r?e:Zc(e,s),n=t.length-1;n>=0;--n){var o,a=t[n];if(a==="[]"&&s.parseArrays)o=[].concat(i);else{o=s.plainObjects?Object.create(null):{};var l=a.charAt(0)==="["&&a.charAt(a.length-1)==="]"?a.slice(1,-1):a,h=parseInt(l,10);!s.parseArrays&&l===""?o={0:i}:!isNaN(h)&&a!==l&&String(h)===l&&h>=0&&s.parseArrays&&h<=s.arrayLimit?(o=[],o[h]=i):l!=="__proto__"&&(o[l]=i)}i=o}return i},Sv=function(e,s,r,i){if(e){var n=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,o=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,l=r.depth>0&&o.exec(n),h=l?n.slice(0,l.index):n,u=[];if(h){if(!r.plainObjects&&Ra.call(Object.prototype,h)&&!r.allowPrototypes)return;u.push(h)}for(var c=0;r.depth>0&&(l=a.exec(n))!==null&&c<r.depth;){if(c+=1,!r.plainObjects&&Ra.call(Object.prototype,l[1].slice(1,-1))&&!r.allowPrototypes)return;u.push(l[1])}return l&&u.push("["+n.slice(l.index)+"]"),Iv(u,s,r,i)}},Cv=function(e){if(!e)return qe;if(e.decoder!==null&&e.decoder!==void 0&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var s=typeof e.charset>"u"?qe.charset:e.charset;return{allowDots:typeof e.allowDots>"u"?qe.allowDots:!!e.allowDots,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:qe.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:qe.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:qe.arrayLimit,charset:s,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:qe.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:qe.comma,decoder:typeof e.decoder=="function"?e.decoder:qe.decoder,delimiter:typeof e.delimiter=="string"||Hr.isRegExp(e.delimiter)?e.delimiter:qe.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:qe.depth,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:qe.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:qe.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:qe.plainObjects,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:qe.strictNullHandling}},Rv=function(t,e){var s=Cv(e);if(t===""||t===null||typeof t>"u")return s.plainObjects?Object.create(null):{};for(var r=typeof t=="string"?Ev(t,s):t,i=s.plainObjects?Object.create(null):{},n=Object.keys(r),o=0;o<n.length;++o){var a=n[o],l=Sv(a,r[a],s,typeof t=="string");i=Hr.merge(i,l,s)}return s.allowSparse===!0?i:Hr.compact(i)},Pv=bv,Fv=Rv,Ov=Il,Mv={formats:Ov,parse:Fv,stringify:Pv},Nv=Ey;function cs(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Bv=/^([a-z0-9.+-]+:)/i,Lv=/:[0-9]*$/,kv=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,Uv=["<",">",'"',"`"," ","\r",`
`,"	"],Dv=["{","}","|","\\","^","`"].concat(Uv),Pa=["'"].concat(Dv),tu=["%","/","?",";","#"].concat(Pa),su=["/","?","#"],Gv=255,ru=/^[+a-z0-9A-Z_-]{0,63}$/,Hv=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,$v={javascript:!0,"javascript:":!0},Fa={javascript:!0,"javascript:":!0},Mr={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Oa=Mv;function Vv(t,e,s){if(t&&typeof t=="object"&&t instanceof cs)return t;var r=new cs;return r.parse(t,e,s),r}cs.prototype.parse=function(t,e,s){if(typeof t!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var r=t.indexOf("?"),i=r!==-1&&r<t.indexOf("#")?"?":"#",n=t.split(i),o=/\\/g;n[0]=n[0].replace(o,"/"),t=n.join(i);var a=t;if(a=a.trim(),!s&&t.split("#").length===1){var l=kv.exec(a);if(l)return this.path=a,this.href=a,this.pathname=l[1],l[2]?(this.search=l[2],e?this.query=Oa.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var h=Bv.exec(a);if(h){h=h[0];var u=h.toLowerCase();this.protocol=u,a=a.substr(h.length)}if(s||h||a.match(/^\/\/[^@/]+@[^@/]+/)){var c=a.substr(0,2)==="//";c&&!(h&&Fa[h])&&(a=a.substr(2),this.slashes=!0)}if(!Fa[h]&&(c||h&&!Mr[h])){for(var d=-1,p=0;p<su.length;p++){var _=a.indexOf(su[p]);_!==-1&&(d===-1||_<d)&&(d=_)}var w,E;d===-1?E=a.lastIndexOf("@"):E=a.lastIndexOf("@",d),E!==-1&&(w=a.slice(0,E),a=a.slice(E+1),this.auth=decodeURIComponent(w)),d=-1;for(var p=0;p<tu.length;p++){var _=a.indexOf(tu[p]);_!==-1&&(d===-1||_<d)&&(d=_)}d===-1&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var y=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!y)for(var v=this.hostname.split(/\./),p=0,g=v.length;p<g;p++){var b=v[p];if(b&&!b.match(ru)){for(var T="",A=0,x=b.length;A<x;A++)b.charCodeAt(A)>127?T+="x":T+=b[A];if(!T.match(ru)){var N=v.slice(0,p),V=v.slice(p+1),W=b.match(Hv);W&&(N.push(W[1]),V.unshift(W[2])),V.length&&(a="/"+V.join(".")+a),this.hostname=N.join(".");break}}}this.hostname.length>Gv?this.hostname="":this.hostname=this.hostname.toLowerCase(),y||(this.hostname=Nv.toASCII(this.hostname));var ue=this.port?":"+this.port:"",ie=this.hostname||"";this.host=ie+ue,this.href+=this.host,y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!$v[u])for(var p=0,g=Pa.length;p<g;p++){var be=Pa[p];if(a.indexOf(be)!==-1){var fe=encodeURIComponent(be);fe===be&&(fe=escape(be)),a=a.split(be).join(fe)}}var He=a.indexOf("#");He!==-1&&(this.hash=a.substr(He),a=a.slice(0,He));var pe=a.indexOf("?");if(pe!==-1?(this.search=a.substr(pe),this.query=a.substr(pe+1),e&&(this.query=Oa.parse(this.query)),a=a.slice(0,pe)):e&&(this.search="",this.query={}),a&&(this.pathname=a),Mr[u]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var ue=this.pathname||"",Ae=this.search||"";this.path=ue+Ae}return this.href=this.format(),this};cs.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",s=this.pathname||"",r=this.hash||"",i=!1,n="";this.host?i=t+this.host:this.hostname&&(i=t+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(n=Oa.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||n&&"?"+n||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||Mr[e])&&i!==!1?(i="//"+(i||""),s&&s.charAt(0)!=="/"&&(s="/"+s)):i||(i=""),r&&r.charAt(0)!=="#"&&(r="#"+r),o&&o.charAt(0)!=="?"&&(o="?"+o),s=s.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),e+i+s+o+r};cs.prototype.resolve=function(t){return this.resolveObject(Vv(t,!1,!0)).format()};cs.prototype.resolveObject=function(t){if(typeof t=="string"){var e=new cs;e.parse(t,!1,!0),t=e}for(var s=new cs,r=Object.keys(this),i=0;i<r.length;i++){var n=r[i];s[n]=this[n]}if(s.hash=t.hash,t.href==="")return s.href=s.format(),s;if(t.slashes&&!t.protocol){for(var o=Object.keys(t),a=0;a<o.length;a++){var l=o[a];l!=="protocol"&&(s[l]=t[l])}return Mr[s.protocol]&&s.hostname&&!s.pathname&&(s.pathname="/",s.path=s.pathname),s.href=s.format(),s}if(t.protocol&&t.protocol!==s.protocol){if(!Mr[t.protocol]){for(var h=Object.keys(t),u=0;u<h.length;u++){var c=h[u];s[c]=t[c]}return s.href=s.format(),s}if(s.protocol=t.protocol,!t.host&&!Fa[t.protocol]){for(var g=(t.pathname||"").split("/");g.length&&!(t.host=g.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),g[0]!==""&&g.unshift(""),g.length<2&&g.unshift(""),s.pathname=g.join("/")}else s.pathname=t.pathname;if(s.search=t.search,s.query=t.query,s.host=t.host||"",s.auth=t.auth,s.hostname=t.hostname||t.host,s.port=t.port,s.pathname||s.search){var d=s.pathname||"",p=s.search||"";s.path=d+p}return s.slashes=s.slashes||t.slashes,s.href=s.format(),s}var _=s.pathname&&s.pathname.charAt(0)==="/",w=t.host||t.pathname&&t.pathname.charAt(0)==="/",E=w||_||s.host&&t.pathname,y=E,v=s.pathname&&s.pathname.split("/")||[],g=t.pathname&&t.pathname.split("/")||[],b=s.protocol&&!Mr[s.protocol];if(b&&(s.hostname="",s.port=null,s.host&&(v[0]===""?v[0]=s.host:v.unshift(s.host)),s.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(g[0]===""?g[0]=t.host:g.unshift(t.host)),t.host=null),E=E&&(g[0]===""||v[0]==="")),w)s.host=t.host||t.host===""?t.host:s.host,s.hostname=t.hostname||t.hostname===""?t.hostname:s.hostname,s.search=t.search,s.query=t.query,v=g;else if(g.length)v||(v=[]),v.pop(),v=v.concat(g),s.search=t.search,s.query=t.query;else if(t.search!=null){if(b){s.host=v.shift(),s.hostname=s.host;var T=s.host&&s.host.indexOf("@")>0?s.host.split("@"):!1;T&&(s.auth=T.shift(),s.hostname=T.shift(),s.host=s.hostname)}return s.search=t.search,s.query=t.query,(s.pathname!==null||s.search!==null)&&(s.path=(s.pathname?s.pathname:"")+(s.search?s.search:"")),s.href=s.format(),s}if(!v.length)return s.pathname=null,s.search?s.path="/"+s.search:s.path=null,s.href=s.format(),s;for(var A=v.slice(-1)[0],x=(s.host||t.host||v.length>1)&&(A==="."||A==="..")||A==="",N=0,V=v.length;V>=0;V--)A=v[V],A==="."?v.splice(V,1):A===".."?(v.splice(V,1),N++):N&&(v.splice(V,1),N--);if(!E&&!y)for(;N--;N)v.unshift("..");E&&v[0]!==""&&(!v[0]||v[0].charAt(0)!=="/")&&v.unshift(""),x&&v.join("/").substr(-1)!=="/"&&v.push("");var W=v[0]===""||v[0]&&v[0].charAt(0)==="/";if(b){s.hostname=W?"":v.length?v.shift():"",s.host=s.hostname;var T=s.host&&s.host.indexOf("@")>0?s.host.split("@"):!1;T&&(s.auth=T.shift(),s.hostname=T.shift(),s.host=s.hostname)}return E=E||s.host&&v.length,E&&!W&&v.unshift(""),v.length>0?s.pathname=v.join("/"):(s.pathname=null,s.path=null),(s.pathname!==null||s.search!==null)&&(s.path=(s.pathname?s.pathname:"")+(s.search?s.search:"")),s.auth=t.auth||s.auth,s.slashes=s.slashes||t.slashes,s.href=s.format(),s};cs.prototype.parseHost=function(){var t=this.host,e=Lv.exec(t);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};const iu={};function xe(t,e,s=3){if(iu[e])return;let r=new Error().stack;typeof r>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`):(r=r.split(`
`).splice(s).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${t}`),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`),console.warn(r))),iu[e]=!0}function Ft(t){if(typeof t!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function ei(t){return t.split("?")[0].split("#")[0]}function qv(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Wv(t,e,s){return t.replace(new RegExp(qv(e),"g"),s)}function jv(t,e){let s="",r=0,i=-1,n=0,o=-1;for(let a=0;a<=t.length;++a){if(a<t.length)o=t.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(i===a-1||n===1))if(i!==a-1&&n===2){if(s.length<2||r!==2||s.charCodeAt(s.length-1)!==46||s.charCodeAt(s.length-2)!==46){if(s.length>2){const l=s.lastIndexOf("/");if(l!==s.length-1){l===-1?(s="",r=0):(s=s.slice(0,l),r=s.length-1-s.lastIndexOf("/")),i=a,n=0;continue}}else if(s.length===2||s.length===1){s="",r=0,i=a,n=0;continue}}e&&(s.length>0?s+="/..":s="..",r=2)}else s.length>0?s+=`/${t.slice(i+1,a)}`:s=t.slice(i+1,a),r=a-i-1;i=a,n=0}else o===46&&n!==-1?++n:n=-1}return s}const Tt={toPosix(t){return Wv(t,"\\","/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},isBlobUrl(t){return t.startsWith("blob:")},hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){Ft(t),t=this.toPosix(t);const e=/^file:\/\/\//.exec(t);if(e)return e[0];const s=/^[^/:]+:\/{0,2}/.exec(t);return s?s[0]:""},toAbsolute(t,e,s){if(Ft(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const r=ei(this.toPosix(e??ne.ADAPTER.getBaseUrl())),i=ei(this.toPosix(s??this.rootname(r)));return t=this.toPosix(t),t.startsWith("/")?Tt.join(i,t.slice(1)):this.isAbsolute(t)?t:this.join(r,t)},normalize(t){if(Ft(t),t.length===0)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;t=this.toPosix(t);let e="";const s=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const r=t.endsWith("/");return t=jv(t,!1),t.length>0&&r&&(t+="/"),s?`/${t}`:e+t},isAbsolute(t){return Ft(t),t=this.toPosix(t),this.hasProtocol(t)?!0:t.startsWith("/")},join(...t){if(t.length===0)return".";let e;for(let s=0;s<t.length;++s){const r=t[s];if(Ft(r),r.length>0)if(e===void 0)e=r;else{const i=t[s-1]??"";this.extname(i)?e+=`/../${r}`:e+=`/${r}`}}return e===void 0?".":this.normalize(e)},dirname(t){if(Ft(t),t.length===0)return".";t=this.toPosix(t);let e=t.charCodeAt(0);const s=e===47;let r=-1,i=!0;const n=this.getProtocol(t),o=t;t=t.slice(n.length);for(let a=t.length-1;a>=1;--a)if(e=t.charCodeAt(a),e===47){if(!i){r=a;break}}else i=!1;return r===-1?s?"/":this.isUrl(o)?n+t:n:s&&r===1?"//":n+t.slice(0,r)},rootname(t){Ft(t),t=this.toPosix(t);let e="";if(t.startsWith("/")?e="/":e=this.getProtocol(t),this.isUrl(t)){const s=t.indexOf("/",e.length);s!==-1?e=t.slice(0,s):e=t,e.endsWith("/")||(e+="/")}return e},basename(t,e){Ft(t),e&&Ft(e),t=ei(this.toPosix(t));let s=0,r=-1,i=!0,n;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let o=e.length-1,a=-1;for(n=t.length-1;n>=0;--n){const l=t.charCodeAt(n);if(l===47){if(!i){s=n+1;break}}else a===-1&&(i=!1,a=n+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(r=n):(o=-1,r=a))}return s===r?r=a:r===-1&&(r=t.length),t.slice(s,r)}for(n=t.length-1;n>=0;--n)if(t.charCodeAt(n)===47){if(!i){s=n+1;break}}else r===-1&&(i=!1,r=n+1);return r===-1?"":t.slice(s,r)},extname(t){Ft(t),t=ei(this.toPosix(t));let e=-1,s=0,r=-1,i=!0,n=0;for(let o=t.length-1;o>=0;--o){const a=t.charCodeAt(o);if(a===47){if(!i){s=o+1;break}continue}r===-1&&(i=!1,r=o+1),a===46?e===-1?e=o:n!==1&&(n=1):e!==-1&&(n=-1)}return e===-1||r===-1||n===0||n===1&&e===r-1&&e===s+1?"":t.slice(e,r)},parse(t){Ft(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;t=ei(this.toPosix(t));let s=t.charCodeAt(0);const r=this.isAbsolute(t);let i;e.root=this.rootname(t),r||this.hasProtocol(t)?i=1:i=0;let n=-1,o=0,a=-1,l=!0,h=t.length-1,u=0;for(;h>=i;--h){if(s=t.charCodeAt(h),s===47){if(!l){o=h+1;break}continue}a===-1&&(l=!1,a=h+1),s===46?n===-1?n=h:u!==1&&(u=1):n!==-1&&(u=-1)}return n===-1||a===-1||u===0||u===1&&n===a-1&&n===o+1?a!==-1&&(o===0&&r?e.base=e.name=t.slice(1,a):e.base=e.name=t.slice(o,a)):(o===0&&r?(e.name=t.slice(1,n),e.base=t.slice(1,a)):(e.name=t.slice(o,n),e.base=t.slice(o,a)),e.ext=t.slice(n,a)),e.dir=this.dirname(t),e},sep:"/",delimiter:":"};let Lo;async function zv(){return Lo??(Lo=(async()=>{var n;const t=document.createElement("canvas").getContext("webgl");if(!t)return Gt.UNPACK;const e=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!e)return Gt.UNPACK;const s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const i=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,i),t.deleteFramebuffer(r),t.deleteTexture(s),(n=t.getExtension("WEBGL_lose_context"))==null||n.loseContext(),i[0]<=i[3]?Gt.PMA:Gt.UNPACK})()),Lo}let ko;function Xv(){return typeof ko>"u"&&(ko=function(){var e;const t={stencil:!0,failIfMajorPerformanceCaveat:ne.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!ne.ADAPTER.getWebGLRenderingContext())return!1;const s=ne.ADAPTER.createCanvas();let r=s.getContext("webgl",t)||s.getContext("experimental-webgl",t);const i=!!((e=r==null?void 0:r.getContextAttributes())!=null&&e.stencil);if(r){const n=r.getExtension("WEBGL_lose_context");n&&n.loseContext()}return r=null,i}catch{return!1}}()),ko}var Kv={grad:.9,turn:360,rad:360/(2*Math.PI)},ns=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},ze=function(t,e,s){return e===void 0&&(e=0),s===void 0&&(s=Math.pow(10,e)),Math.round(s*t)/s+0},St=function(t,e,s){return e===void 0&&(e=0),s===void 0&&(s=1),t>s?s:t>e?t:e},Qc=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},nu=function(t){return{r:St(t.r,0,255),g:St(t.g,0,255),b:St(t.b,0,255),a:St(t.a)}},Uo=function(t){return{r:ze(t.r),g:ze(t.g),b:ze(t.b),a:ze(t.a,3)}},Zv=/^#([0-9a-f]{3,8})$/i,Yi=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},Yc=function(t){var e=t.r,s=t.g,r=t.b,i=t.a,n=Math.max(e,s,r),o=n-Math.min(e,s,r),a=o?n===e?(s-r)/o:n===s?2+(r-e)/o:4+(e-s)/o:0;return{h:60*(a<0?a+6:a),s:n?o/n*100:0,v:n/255*100,a:i}},Jc=function(t){var e=t.h,s=t.s,r=t.v,i=t.a;e=e/360*6,s/=100,r/=100;var n=Math.floor(e),o=r*(1-s),a=r*(1-(e-n)*s),l=r*(1-(1-e+n)*s),h=n%6;return{r:255*[r,a,o,o,l,r][h],g:255*[l,r,r,a,o,o][h],b:255*[o,o,l,r,r,a][h],a:i}},ou=function(t){return{h:Qc(t.h),s:St(t.s,0,100),l:St(t.l,0,100),a:St(t.a)}},au=function(t){return{h:ze(t.h),s:ze(t.s),l:ze(t.l),a:ze(t.a,3)}},lu=function(t){return Jc((s=(e=t).s,{h:e.h,s:(s*=((r=e.l)<50?r:100-r)/100)>0?2*s/(r+s)*100:0,v:r+s,a:e.a}));var e,s,r},vi=function(t){return{h:(e=Yc(t)).h,s:(i=(200-(s=e.s))*(r=e.v)/100)>0&&i<200?s*r/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,s,r,i},Qv=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Yv=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Jv=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,e_=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ma={string:[[function(t){var e=Zv.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?ze(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?ze(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=Jv.exec(t)||e_.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:nu({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=Qv.exec(t)||Yv.exec(t);if(!e)return null;var s,r,i=ou({h:(s=e[1],r=e[2],r===void 0&&(r="deg"),Number(s)*(Kv[r]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return lu(i)},"hsl"]],object:[[function(t){var e=t.r,s=t.g,r=t.b,i=t.a,n=i===void 0?1:i;return ns(e)&&ns(s)&&ns(r)?nu({r:Number(e),g:Number(s),b:Number(r),a:Number(n)}):null},"rgb"],[function(t){var e=t.h,s=t.s,r=t.l,i=t.a,n=i===void 0?1:i;if(!ns(e)||!ns(s)||!ns(r))return null;var o=ou({h:Number(e),s:Number(s),l:Number(r),a:Number(n)});return lu(o)},"hsl"],[function(t){var e=t.h,s=t.s,r=t.v,i=t.a,n=i===void 0?1:i;if(!ns(e)||!ns(s)||!ns(r))return null;var o=function(a){return{h:Qc(a.h),s:St(a.s,0,100),v:St(a.v,0,100),a:St(a.a)}}({h:Number(e),s:Number(s),v:Number(r),a:Number(n)});return Jc(o)},"hsv"]]},hu=function(t,e){for(var s=0;s<e.length;s++){var r=e[s][0](t);if(r)return[r,e[s][1]]}return[null,void 0]},t_=function(t){return typeof t=="string"?hu(t.trim(),Ma.string):typeof t=="object"&&t!==null?hu(t,Ma.object):[null,void 0]},Do=function(t,e){var s=vi(t);return{h:s.h,s:St(s.s+100*e,0,100),l:s.l,a:s.a}},Go=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},uu=function(t,e){var s=vi(t);return{h:s.h,s:s.s,l:St(s.l+100*e,0,100),a:s.a}},Na=function(){function t(e){this.parsed=t_(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return ze(Go(this.rgba),2)},t.prototype.isDark=function(){return Go(this.rgba)<.5},t.prototype.isLight=function(){return Go(this.rgba)>=.5},t.prototype.toHex=function(){return e=Uo(this.rgba),s=e.r,r=e.g,i=e.b,o=(n=e.a)<1?Yi(ze(255*n)):"","#"+Yi(s)+Yi(r)+Yi(i)+o;var e,s,r,i,n,o},t.prototype.toRgb=function(){return Uo(this.rgba)},t.prototype.toRgbString=function(){return e=Uo(this.rgba),s=e.r,r=e.g,i=e.b,(n=e.a)<1?"rgba("+s+", "+r+", "+i+", "+n+")":"rgb("+s+", "+r+", "+i+")";var e,s,r,i,n},t.prototype.toHsl=function(){return au(vi(this.rgba))},t.prototype.toHslString=function(){return e=au(vi(this.rgba)),s=e.h,r=e.s,i=e.l,(n=e.a)<1?"hsla("+s+", "+r+"%, "+i+"%, "+n+")":"hsl("+s+", "+r+"%, "+i+"%)";var e,s,r,i,n},t.prototype.toHsv=function(){return e=Yc(this.rgba),{h:ze(e.h),s:ze(e.s),v:ze(e.v),a:ze(e.a,3)};var e},t.prototype.invert=function(){return zt({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),zt(Do(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),zt(Do(this.rgba,-e))},t.prototype.grayscale=function(){return zt(Do(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),zt(uu(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),zt(uu(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?zt({r:(s=this.rgba).r,g:s.g,b:s.b,a:e}):ze(this.rgba.a,3);var s},t.prototype.hue=function(e){var s=vi(this.rgba);return typeof e=="number"?zt({h:e,s:s.s,l:s.l,a:s.a}):ze(s.h)},t.prototype.isEqual=function(e){return this.toHex()===zt(e).toHex()},t}(),zt=function(t){return t instanceof Na?t:new Na(t)},cu=[],s_=function(t){t.forEach(function(e){cu.indexOf(e)<0&&(e(Na,Ma),cu.push(e))})};function r_(t,e){var s={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var i in s)r[s[i]]=i;var n={};t.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,h=r[this.toHex()];if(h)return h;if(o!=null&&o.closest){var u=this.toRgb(),c=1/0,d="black";if(!n.length)for(var p in s)n[p]=new t(s[p]).toRgb();for(var _ in s){var w=(a=u,l=n[_],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));w<c&&(c=w,d=_)}return d}},e.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":s[a];return l?new t(l).toRgb():null},"name"])}s_([r_]);const yr=class yn{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof yn)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}isSourceEqual(e,s){const r=typeof e;if(r!==typeof s)return!1;if(r==="number"||r==="string"||e instanceof Number)return e===s;if(Array.isArray(e)&&Array.isArray(s)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(s))return e.length!==s.length?!1:e.every((i,n)=>i===s[n]);if(e!==null&&s!==null){const i=Object.keys(e),n=Object.keys(s);return i.length!==n.length?!1:i.every(o=>e[o]===s[o])}return e===s}toRgba(){const[e,s,r,i]=this._components;return{r:e,g:s,b:r,a:i}}toRgb(){const[e,s,r]=this._components;return{r:e,g:s,b:r}}toRgbaString(){const[e,s,r]=this.toUint8RgbArray();return`rgba(${e},${s},${r},${this.alpha})`}toUint8RgbArray(e){const[s,r,i]=this._components;return e=e??[],e[0]=Math.round(s*255),e[1]=Math.round(r*255),e[2]=Math.round(i*255),e}toRgbArray(e){e=e??[];const[s,r,i]=this._components;return e[0]=s,e[1]=r,e[2]=i,e}toNumber(){return this._int}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[s,r,i,n]=yn.temp.setValue(e)._components;return this._components[0]*=s,this._components[1]*=r,this._components[2]*=i,this._components[3]*=n,this.refreshInt(),this._value=null,this}premultiply(e,s=!0){return s&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,s=!0){if(e===1)return(255<<24)+this._int;if(e===0)return s?0:this._int;let r=this._int>>16&255,i=this._int>>8&255,n=this._int&255;return s&&(r=r*e+.5|0,i=i*e+.5|0,n=n*e+.5|0),(e*255<<24)+(r<<16)+(i<<8)+n}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){const[s,r,i]=this._components;return this._components[0]=Math.round(s*e)/e,this._components[1]=Math.round(r*e)/e,this._components[2]=Math.round(i*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e??[];const[s,r,i,n]=this._components;return e[0]=s,e[1]=r,e[2]=i,e[3]=n,e}normalize(e){let s,r,i,n;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;s=(o>>16&255)/255,r=(o>>8&255)/255,i=(o&255)/255,n=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[s,r,i,n=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[s,r,i,n=255]=e,s/=255,r/=255,i/=255,n/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const a=yn.HEX_PATTERN.exec(e);a&&(e=`#${a[2]}`)}const o=zt(e);o.isValid()&&({r:s,g:r,b:i,a:n}=o.rgba,s/=255,r/=255,i/=255)}if(s!==void 0)this._components[0]=s,this._components[1]=r,this._components[2]=i,this._components[3]=n,this.refreshInt();else throw new Error(`Unable to convert color ${e}`)}refreshInt(){this._clamp(this._components);const[e,s,r]=this._components;this._int=(e*255<<16)+(s*255<<8)+(r*255|0)}_clamp(e,s=0,r=1){return typeof e=="number"?Math.min(Math.max(e,s),r):(e.forEach((i,n)=>{e[n]=Math.min(Math.max(i,s),r)}),e)}};yr.shared=new yr,yr.temp=new yr,yr.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let fo=yr;function i_(){const t=[],e=[];for(let r=0;r<32;r++)t[r]=r,e[r]=r;t[J.NORMAL_NPM]=J.NORMAL,t[J.ADD_NPM]=J.ADD,t[J.SCREEN_NPM]=J.SCREEN,e[J.NORMAL]=J.NORMAL_NPM,e[J.ADD]=J.ADD_NPM,e[J.SCREEN]=J.SCREEN_NPM;const s=[];return s.push(e),s.push(t),s}const n_=i_();function ed(t){if(t.BYTES_PER_ELEMENT===4)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(t.BYTES_PER_ELEMENT===2){if(t instanceof Uint16Array)return"Uint16Array"}else if(t.BYTES_PER_ELEMENT===1&&t instanceof Uint8Array)return"Uint8Array";return null}function On(t){return t+=t===0?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1}function du(t){return!(t&t-1)&&!!t}function fu(t){let e=(t>65535?1:0)<<4;t>>>=e;let s=(t>255?1:0)<<3;return t>>>=s,e|=s,s=(t>15?1:0)<<2,t>>>=s,e|=s,s=(t>3?1:0)<<1,t>>>=s,e|=s,e|t>>1}function o_(t,e,s){const r=t.length;let i;if(e>=r||s===0)return;s=e+s>r?r-e:s;const n=r-s;for(i=e;i<n;++i)t[i]=t[i+s];t.length=n}let a_=0;function Pi(){return++a_}const pu={},Xt=Object.create(null),ys=Object.create(null);function l_(t,e=globalThis.location){if(t.startsWith("data:"))return"";e=e||globalThis.location;const s=new URL(t,document.baseURI);return s.hostname!==e.hostname||s.port!==e.port||s.protocol!==e.protocol?"anonymous":""}function Fi(t,e=1){var r;const s=(r=ne.RETINA_PREFIX)==null?void 0:r.exec(t);return s?parseFloat(s[1]):e}var $=(t=>(t.Renderer="renderer",t.Application="application",t.RendererSystem="renderer-webgl-system",t.RendererPlugin="renderer-webgl-plugin",t.CanvasRendererSystem="renderer-canvas-system",t.CanvasRendererPlugin="renderer-canvas-plugin",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t))($||{});const Ba=t=>{if(typeof t=="function"||typeof t=="object"&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={...typeof t.extension!="object"?{type:t.extension}:t.extension,ref:t}}if(typeof t=="object")t={...t};else throw new Error("Invalid extension type");return typeof t.type=="string"&&(t.type=[t.type]),t},mu=(t,e)=>Ba(t).priority??e,Q={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(Ba).forEach(e=>{e.type.forEach(s=>{var r,i;return(i=(r=this._removeHandlers)[s])==null?void 0:i.call(r,e)})}),this},add(...t){return t.map(Ba).forEach(e=>{e.type.forEach(s=>{const r=this._addHandlers,i=this._queue;r[s]?r[s](e):(i[s]=i[s]||[],i[s].push(e))})}),this},handle(t,e,s){const r=this._addHandlers,i=this._removeHandlers;if(r[t]||i[t])throw new Error(`Extension type ${t} already has a handler`);r[t]=e,i[t]=s;const n=this._queue;return n[t]&&(n[t].forEach(o=>e(o)),delete n[t]),this},handleByMap(t,e){return this.handle(t,s=>{e[s.name]=s.ref},s=>{delete e[s.name]})},handleByList(t,e,s=-1){return this.handle(t,r=>{e.includes(r.ref)||(e.push(r.ref),e.sort((i,n)=>mu(n,s)-mu(i,s)))},r=>{const i=e.indexOf(r.ref);i!==-1&&e.splice(i,1)})}};class h_{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}const u_=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function c_(t){let e="";for(let s=0;s<t;++s)s>0&&(e+=`
else `),s<t-1&&(e+=`if(test == ${s}.0){}`);return e}function d_(t,e){if(t===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const s=e.createShader(e.FRAGMENT_SHADER);for(;;){const r=u_.replace(/%forloop%/gi,c_(t));if(e.shaderSource(s,r),e.compileShader(s),!e.getShaderParameter(s,e.COMPILE_STATUS))t=t/2|0;else break}return t}const Ho=0,$o=1,Vo=2,qo=3,Wo=4,jo=5;class Xr{constructor(){this.data=0,this.blendMode=J.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Ho)}set blend(e){!!(this.data&1<<Ho)!==e&&(this.data^=1<<Ho)}get offsets(){return!!(this.data&1<<$o)}set offsets(e){!!(this.data&1<<$o)!==e&&(this.data^=1<<$o)}get culling(){return!!(this.data&1<<Vo)}set culling(e){!!(this.data&1<<Vo)!==e&&(this.data^=1<<Vo)}get depthTest(){return!!(this.data&1<<qo)}set depthTest(e){!!(this.data&1<<qo)!==e&&(this.data^=1<<qo)}get depthMask(){return!!(this.data&1<<jo)}set depthMask(e){!!(this.data&1<<jo)!==e&&(this.data^=1<<jo)}get clockwiseFrontFace(){return!!(this.data&1<<Wo)}set clockwiseFrontFace(e){!!(this.data&1<<Wo)!==e&&(this.data^=1<<Wo)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==J.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}static for2d(){const e=new Xr;return e.depthTest=!1,e.blend=!0,e}}Xr.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const La=[];function td(t,e){if(!t)return null;let s="";if(typeof t=="string"){const r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(s=r[1].toLowerCase())}for(let r=La.length-1;r>=0;--r){const i=La[r];if(i.test&&i.test(t,s))return new i(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class Vt{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,s,r,i,n,o,a,l){if(arguments.length>8)throw new Error("max arguments reached");const{name:h,items:u}=this;this._aliasCount++;for(let c=0,d=u.length;c<d;c++)u[c][h](e,s,r,i,n,o,a,l);return u===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){const s=this.items.indexOf(e);return s!==-1&&(this.ensureNonAliasedItems(),this.items.splice(s,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(Vt.prototype,{dispatch:{value:Vt.prototype.emit},run:{value:Vt.prototype.emit}});class Oi{constructor(e=0,s=0){this._width=e,this._height=s,this.destroyed=!1,this.internal=!1,this.onResize=new Vt("setRealSize"),this.onUpdate=new Vt("update"),this.onError=new Vt("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,s){(e!==this._width||s!==this._height)&&(this._width=e,this._height=s,this.onResize.emit(e,s))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,s,r){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,s){return!1}}class sd extends Oi{constructor(e,s){const{width:r,height:i}=s||{};if(!r||!i)throw new Error("BufferResource width or height invalid");super(r,i),this.data=e,this.unpackAlignment=s.unpackAlignment??4}upload(e,s,r){const i=e.gl;i.pixelStorei(i.UNPACK_ALIGNMENT,this.unpackAlignment),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.alphaMode===Gt.UNPACK);const n=s.realWidth,o=s.realHeight;return r.width===n&&r.height===o?i.texSubImage2D(s.target,0,0,0,n,o,s.format,r.type,this.data):(r.width=n,r.height=o,i.texImage2D(s.target,0,r.internalFormat,n,o,0,s.format,r.type,this.data)),!0}dispose(){this.data=null}static test(e){return e===null||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}const f_={scaleMode:hs.NEAREST,alphaMode:Gt.NPM},ka=class gr extends Ss{constructor(e=null,s=null){super(),s=Object.assign({},gr.defaultOptions,s);const{alphaMode:r,mipmap:i,anisotropicLevel:n,scaleMode:o,width:a,height:l,wrapMode:h,format:u,type:c,target:d,resolution:p,resourceOptions:_}=s;e&&!(e instanceof Oi)&&(e=td(e,_),e.internal=!0),this.resolution=p||ne.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((l||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=n,this._wrapMode=h,this._scaleMode=o,this.format=u,this.type=c,this.target=d,this.alphaMode=r,this.uid=Pi(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&l>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,s){let r;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,r=!0),s!==void 0&&s!==this.mipmap&&(this.mipmap=s,r=!0),r&&this.dirtyStyleId++,this}setSize(e,s,r){return r=r||this.resolution,this.setRealSize(e*r,s*r,r)}setRealSize(e,s,r){return this.resolution=r||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(s)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=du(this.realWidth)&&du(this.realHeight)}setResolution(e){const s=this.resolution;return s===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*s)/e,this.height=Math.round(this.height*s)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete ys[this.cacheId],delete Xt[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),gr.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,s,r=ne.STRICT_TEXTURE_CACHE){const i=typeof e=="string";let n=null;if(i)n=e;else{if(!e._pixiId){const a=(s==null?void 0:s.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${Pi()}`}n=e._pixiId}let o=ys[n];if(i&&r&&!o)throw new Error(`The cacheId "${n}" does not exist in BaseTextureCache.`);return o||(o=new gr(e,s),o.cacheId=n,gr.addToCache(o,n)),o}static fromBuffer(e,s,r,i){e=e||new Float32Array(s*r*4);const n=new sd(e,{width:s,height:r,...i==null?void 0:i.resourceOptions});let o,a;return e instanceof Float32Array?(o=L.RGBA,a=he.FLOAT):e instanceof Int32Array?(o=L.RGBA_INTEGER,a=he.INT):e instanceof Uint32Array?(o=L.RGBA_INTEGER,a=he.UNSIGNED_INT):e instanceof Int16Array?(o=L.RGBA_INTEGER,a=he.SHORT):e instanceof Uint16Array?(o=L.RGBA_INTEGER,a=he.UNSIGNED_SHORT):e instanceof Int8Array?(o=L.RGBA,a=he.BYTE):(o=L.RGBA,a=he.UNSIGNED_BYTE),n.internal=!0,new gr(n,Object.assign({},f_,{type:a,format:o},i))}static addToCache(e,s){s&&(e.textureCacheIds.includes(s)||e.textureCacheIds.push(s),ys[s]&&ys[s]!==e&&console.warn(`BaseTexture added to the cache with an id [${s}] that already had an entry`),ys[s]=e)}static removeFromCache(e){if(typeof e=="string"){const s=ys[e];if(s){const r=s.textureCacheIds.indexOf(e);return r>-1&&s.textureCacheIds.splice(r,1),delete ys[e],s}}else if(e!=null&&e.textureCacheIds){for(let s=0;s<e.textureCacheIds.length;++s)delete ys[e.textureCacheIds[s]];return e.textureCacheIds.length=0,e}return null}};ka.defaultOptions={mipmap:sr.POW2,anisotropicLevel:0,scaleMode:hs.LINEAR,wrapMode:gl.CLAMP,alphaMode:Gt.UNPACK,target:Fr.TEXTURE_2D,format:L.RGBA,type:he.UNSIGNED_BYTE},ka._globalBatch=0;let ve=ka;class p_{constructor(){this.texArray=null,this.blend=0,this.type=In.TRIANGLES,this.start=0,this.size=0,this.data=null}}let m_=0;class ht{constructor(e,s=!0,r=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=s,this.id=m_++,this.disposeRunner=new Vt("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?es.ELEMENT_ARRAY_BUFFER:es.ARRAY_BUFFER}get index(){return this.type===es.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new ht(e)}}class Mn{constructor(e,s=0,r=!1,i=he.FLOAT,n,o,a,l=1){this.buffer=e,this.size=s,this.normalized=r,this.type=i,this.stride=n,this.start=o,this.instance=a,this.divisor=l}destroy(){this.buffer=null}static from(e,s,r,i,n){return new Mn(e,s,r,i,n)}}const y_={Float32Array,Uint32Array,Int32Array,Uint8Array};function g_(t,e){let s=0,r=0;const i={};for(let l=0;l<t.length;l++)r+=e[l],s+=t[l].length;const n=new ArrayBuffer(s*4);let o=null,a=0;for(let l=0;l<t.length;l++){const h=e[l],u=t[l],c=ed(u);i[c]||(i[c]=new y_[c](n)),o=i[c];for(let d=0;d<u.length;d++){const p=(d/h|0)*r+a,_=d%h;o[p+_]=u[d]}a+=h}return new Float32Array(n)}const yu={5126:4,5123:2,5121:1};let v_=0;const __={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class $r{constructor(e=[],s={}){this.buffers=e,this.indexBuffer=null,this.attributes=s,this.glVertexArrayObjects={},this.id=v_++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Vt("disposeGeometry"),this.refCount=0}addAttribute(e,s,r=0,i=!1,n,o,a,l=!1){if(!s)throw new Error("You must pass a buffer when creating an attribute");s instanceof ht||(s instanceof Array&&(s=new Float32Array(s)),s=new ht(s));const h=e.split("|");if(h.length>1){for(let c=0;c<h.length;c++)this.addAttribute(h[c],s,r,i,n);return this}let u=this.buffers.indexOf(s);return u===-1&&(this.buffers.push(s),u=this.buffers.length-1),this.attributes[e]=new Mn(u,r,i,n,o,a,l),this.instanced=this.instanced||l,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof ht||(e instanceof Array&&(e=new Uint16Array(e)),e=new ht(e)),e.type=es.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const e=[],s=[],r=new ht;let i;for(i in this.attributes){const n=this.attributes[i],o=this.buffers[n.buffer];e.push(o.data),s.push(n.size*yu[n.type]/4),n.buffer=0}for(r.data=g_(e,s),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const e in this.attributes){const s=this.attributes[e];return this.buffers[s.buffer].data.length/(s.stride/4||s.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const e=new $r;for(let s=0;s<this.buffers.length;s++)e.buffers[s]=new ht(this.buffers[s].data.slice(0));for(const s in this.attributes){const r=this.attributes[s];e.attributes[s]=new Mn(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=es.ELEMENT_ARRAY_BUFFER),e}static merge(e){const s=new $r,r=[],i=[],n=[];let o;for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)i[l]=i[l]||0,i[l]+=o.buffers[l].data.length,n[l]=0}for(let a=0;a<o.buffers.length;a++)r[a]=new __[ed(o.buffers[a].data)](i[a]),s.buffers[a]=new ht(r[a]);for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)r[l].set(o.buffers[l].data,n[l]),n[l]+=o.buffers[l].data.length}if(s.attributes=o.attributes,o.indexBuffer){s.indexBuffer=s.buffers[o.buffers.indexOf(o.indexBuffer)],s.indexBuffer.type=es.ELEMENT_ARRAY_BUFFER;let a=0,l=0,h=0,u=0;for(let c=0;c<o.buffers.length;c++)if(o.buffers[c]!==o.indexBuffer){u=c;break}for(const c in o.attributes){const d=o.attributes[c];(d.buffer|0)===u&&(l+=d.size*yu[d.type]/4)}for(let c=0;c<e.length;c++){const d=e[c].indexBuffer.data;for(let p=0;p<d.length;p++)s.indexBuffer.data[p+h]+=a;a+=e[c].buffers[u].data.length/l,h+=d.length}}return s}}class b_ extends $r{constructor(e=!1){super(),this._buffer=new ht(null,e,!1),this._indexBuffer=new ht(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,he.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,he.FLOAT).addAttribute("aColor",this._buffer,4,!0,he.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,he.FLOAT).addIndex(this._indexBuffer)}}const x_=Math.PI*2;var rd=(t=>(t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC",t))(rd||{});class ct{constructor(e=0,s=0){this.x=0,this.y=0,this.x=e,this.y=s}clone(){return new ct(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,s=e){return this.x=e,this.y=s,this}}ct.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const Ji=[new ct,new ct,new ct,new ct];class Le{constructor(e=0,s=0,r=0,i=0){this.x=Number(e),this.y=Number(s),this.width=Number(r),this.height=Number(i),this.type=rd.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Le(0,0,0,0)}clone(){return new Le(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,s){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&s>=this.y&&s<this.y+this.height}intersects(e,s){if(!s){const N=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=N)return!1;const V=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>V}const r=this.left,i=this.right,n=this.top,o=this.bottom;if(i<=r||o<=n)return!1;const a=Ji[0].set(e.left,e.top),l=Ji[1].set(e.left,e.bottom),h=Ji[2].set(e.right,e.top),u=Ji[3].set(e.right,e.bottom);if(h.x<=a.x||l.y<=a.y)return!1;const c=Math.sign(s.a*s.d-s.b*s.c);if(c===0||(s.apply(a,a),s.apply(l,l),s.apply(h,h),s.apply(u,u),Math.max(a.x,l.x,h.x,u.x)<=r||Math.min(a.x,l.x,h.x,u.x)>=i||Math.max(a.y,l.y,h.y,u.y)<=n||Math.min(a.y,l.y,h.y,u.y)>=o))return!1;const d=c*(l.y-a.y),p=c*(a.x-l.x),_=d*r+p*n,w=d*i+p*n,E=d*r+p*o,y=d*i+p*o;if(Math.max(_,w,E,y)<=d*a.x+p*a.y||Math.min(_,w,E,y)>=d*u.x+p*u.y)return!1;const v=c*(a.y-h.y),g=c*(h.x-a.x),b=v*r+g*n,T=v*i+g*n,A=v*r+g*o,x=v*i+g*o;return!(Math.max(b,T,A,x)<=v*a.x+g*a.y||Math.min(b,T,A,x)>=v*u.x+g*u.y)}pad(e=0,s=e){return this.x-=e,this.y-=s,this.width+=e*2,this.height+=s*2,this}fit(e){const s=Math.max(this.x,e.x),r=Math.min(this.x+this.width,e.x+e.width),i=Math.max(this.y,e.y),n=Math.min(this.y+this.height,e.y+e.height);return this.x=s,this.width=Math.max(r-s,0),this.y=i,this.height=Math.max(n-i,0),this}ceil(e=1,s=.001){const r=Math.ceil((this.x+this.width-s)*e)/e,i=Math.ceil((this.y+this.height-s)*e)/e;return this.x=Math.floor((this.x+s)*e)/e,this.y=Math.floor((this.y+s)*e)/e,this.width=r-this.x,this.height=i-this.y,this}enlarge(e){const s=Math.min(this.x,e.x),r=Math.max(this.x+this.width,e.x+e.width),i=Math.min(this.y,e.y),n=Math.max(this.y+this.height,e.y+e.height);return this.x=s,this.width=r-s,this.y=i,this.height=n-i,this}}Le.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Xe{constructor(e=1,s=0,r=0,i=1,n=0,o=0){this.array=null,this.a=e,this.b=s,this.c=r,this.d=i,this.tx=n,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,s,r,i,n,o){return this.a=e,this.b=s,this.c=r,this.d=i,this.tx=n,this.ty=o,this}toArray(e,s){this.array||(this.array=new Float32Array(9));const r=s||this.array;return e?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r}apply(e,s){s=s||new ct;const r=e.x,i=e.y;return s.x=this.a*r+this.c*i+this.tx,s.y=this.b*r+this.d*i+this.ty,s}applyInverse(e,s){s=s||new ct;const r=1/(this.a*this.d+this.c*-this.b),i=e.x,n=e.y;return s.x=this.d*r*i+-this.c*r*n+(this.ty*this.c-this.tx*this.d)*r,s.y=this.a*r*n+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,s}translate(e,s){return this.tx+=e,this.ty+=s,this}scale(e,s){return this.a*=e,this.d*=s,this.c*=e,this.b*=s,this.tx*=e,this.ty*=s,this}rotate(e){const s=Math.cos(e),r=Math.sin(e),i=this.a,n=this.c,o=this.tx;return this.a=i*s-this.b*r,this.b=i*r+this.b*s,this.c=n*s-this.d*r,this.d=n*r+this.d*s,this.tx=o*s-this.ty*r,this.ty=o*r+this.ty*s,this}append(e){const s=this.a,r=this.b,i=this.c,n=this.d;return this.a=e.a*s+e.b*i,this.b=e.a*r+e.b*n,this.c=e.c*s+e.d*i,this.d=e.c*r+e.d*n,this.tx=e.tx*s+e.ty*i+this.tx,this.ty=e.tx*r+e.ty*n+this.ty,this}setTransform(e,s,r,i,n,o,a,l,h){return this.a=Math.cos(a+h)*n,this.b=Math.sin(a+h)*n,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(r*this.a+i*this.c),this.ty=s-(r*this.b+i*this.d),this}prepend(e){const s=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const r=this.a,i=this.c;this.a=r*e.a+this.b*e.c,this.b=r*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d}return this.tx=s*e.a+this.ty*e.c+e.tx,this.ty=s*e.b+this.ty*e.d+e.ty,this}decompose(e){const s=this.a,r=this.b,i=this.c,n=this.d,o=e.pivot,a=-Math.atan2(-i,n),l=Math.atan2(r,s),h=Math.abs(a+l);return h<1e-5||Math.abs(x_-h)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(s*s+r*r),e.scale.y=Math.sqrt(i*i+n*n),e.position.x=this.tx+(o.x*s+o.y*i),e.position.y=this.ty+(o.x*r+o.y*n),e}invert(){const e=this.a,s=this.b,r=this.c,i=this.d,n=this.tx,o=e*i-s*r;return this.a=i/o,this.b=-s/o,this.c=-r/o,this.d=e/o,this.tx=(r*this.ty-i*n)/o,this.ty=-(e*this.ty-s*n)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new Xe;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}static get IDENTITY(){return new Xe}static get TEMP_MATRIX(){return new Xe}}Xe.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const Ns=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Bs=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Ls=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],ks=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Ua=[],id=[],en=Math.sign;function A_(){for(let t=0;t<16;t++){const e=[];Ua.push(e);for(let s=0;s<16;s++){const r=en(Ns[t]*Ns[s]+Ls[t]*Bs[s]),i=en(Bs[t]*Ns[s]+ks[t]*Bs[s]),n=en(Ns[t]*Ls[s]+Ls[t]*ks[s]),o=en(Bs[t]*Ls[s]+ks[t]*ks[s]);for(let a=0;a<16;a++)if(Ns[a]===r&&Bs[a]===i&&Ls[a]===n&&ks[a]===o){e.push(a);break}}}for(let t=0;t<16;t++){const e=new Xe;e.set(Ns[t],Bs[t],Ls[t],ks[t],0,0),id.push(e)}}A_();const Me={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>Ns[t],uY:t=>Bs[t],vX:t=>Ls[t],vY:t=>ks[t],inv:t=>t&8?t&15:-t&7,add:(t,e)=>Ua[t][e],sub:(t,e)=>Ua[t][Me.inv(e)],rotate180:t=>t^4,isVertical:t=>(t&3)===2,byDirection:(t,e)=>Math.abs(t)*2<=Math.abs(e)?e>=0?Me.S:Me.N:Math.abs(e)*2<=Math.abs(t)?t>0?Me.E:Me.W:e>0?t>0?Me.SE:Me.SW:t>0?Me.NE:Me.NW,matrixAppendRotationInv:(t,e,s=0,r=0)=>{const i=id[Me.inv(e)];i.tx=s,i.ty=r,t.append(i)}};class zs{constructor(e,s,r=0,i=0){this._x=r,this._y=i,this.cb=e,this.scope=s}clone(e=this.cb,s=this.scope){return new zs(e,s,this._x,this._y)}set(e=0,s=e){return(this._x!==e||this._y!==s)&&(this._x=e,this._y=s,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}zs.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const Da=class{constructor(){this.worldTransform=new Xe,this.localTransform=new Xe,this.position=new zs(this.onChange,this,0,0),this.scale=new zs(this.onChange,this,1,1),this.pivot=new zs(this.onChange,this,0,0),this.skew=new zs(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(t){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){const s=t.worldTransform,r=this.worldTransform;r.a=e.a*s.a+e.b*s.c,r.b=e.a*s.b+e.b*s.d,r.c=e.c*s.a+e.d*s.c,r.d=e.c*s.b+e.d*s.d,r.tx=e.tx*s.a+e.ty*s.c+s.tx,r.ty=e.tx*s.b+e.ty*s.d+s.ty,this._parentID=t._worldID,this._worldID++}}setFromMatrix(t){t.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}};Da.IDENTITY=new Da;let nd=Da;nd.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var T_=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,w_=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function gu(t,e,s){const r=t.createShader(e);return t.shaderSource(r,s),t.compileShader(r),r}function zo(t){const e=new Array(t);for(let s=0;s<e.length;s++)e[s]=!1;return e}function od(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return zo(2*e);case"bvec3":return zo(3*e);case"bvec4":return zo(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Nr=[{test:t=>t.type==="float"&&t.size===1&&!t.isArray,code:t=>`
            if(uv["${t}"] !== ud["${t}"].value)
            {
                ud["${t}"].value = uv["${t}"]
                gl.uniform1f(ud["${t}"].location, uv["${t}"])
            }
            `},{test:(t,e)=>(t.type==="sampler2D"||t.type==="samplerCube"||t.type==="sampler2DArray")&&t.size===1&&!t.isArray&&(e==null||e.castToBaseTexture!==void 0),code:t=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${t}"], t);

            if(ud["${t}"].value !== t)
            {
                ud["${t}"].value = t;
                gl.uniform1i(ud["${t}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(t,e)=>t.type==="mat3"&&t.size===1&&!t.isArray&&e.a!==void 0,code:t=>`
            gl.uniformMatrix3fv(ud["${t}"].location, false, uv["${t}"].toArray(true));
            `,codeUbo:t=>`
                var ${t}_matrix = uv.${t}.toArray(true);

                data[offset] = ${t}_matrix[0];
                data[offset+1] = ${t}_matrix[1];
                data[offset+2] = ${t}_matrix[2];
        
                data[offset + 4] = ${t}_matrix[3];
                data[offset + 5] = ${t}_matrix[4];
                data[offset + 6] = ${t}_matrix[5];
        
                data[offset + 8] = ${t}_matrix[6];
                data[offset + 9] = ${t}_matrix[7];
                data[offset + 10] = ${t}_matrix[8];
            `},{test:(t,e)=>t.type==="vec2"&&t.size===1&&!t.isArray&&e.x!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${t}"].location, v.x, v.y);
                }`,codeUbo:t=>`
                v = uv.${t};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:t=>t.type==="vec2"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${t}"].location, v[0], v[1]);
                }
            `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.width!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${t}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${t}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(t,e)=>t.type==="vec3"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${t}"].location, v.red, v.green, v.blue)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:t=>t.type==="vec4"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${t}"].location, v[0], v[1], v[2], v[3])
                }`}],E_={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},I_={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function S_(t,e){var r;const s=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const i in t.uniforms){const n=e[i];if(!n){((r=t.uniforms[i])==null?void 0:r.group)===!0&&(t.uniforms[i].ubo?s.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');
                    `):s.push(`
                        renderer.shader.syncUniformGroup(uv.${i}, syncData);
                    `));continue}const o=t.uniforms[i];let a=!1;for(let l=0;l<Nr.length;l++)if(Nr[l].test(n,o)){s.push(Nr[l].code(i,o)),a=!0;break}if(!a){const l=(n.size===1&&!n.isArray?E_:I_)[n.type].replace("location",`ud["${i}"].location`);s.push(`
            cu = ud["${i}"];
            cv = cu.value;
            v = uv["${i}"];
            ${l};`)}}return new Function("ud","uv","renderer","syncData",s.join(`
`))}const ad={};let dr=ad;function C_(){if(dr===ad||dr!=null&&dr.isContextLost()){const t=ne.ADAPTER.createCanvas();let e;ne.PREFER_ENV>=ir.WEBGL2&&(e=t.getContext("webgl2",{})),e||(e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),dr=e}return dr}let tn;function R_(){if(!tn){tn=It.MEDIUM;const t=C_();if(t&&t.getShaderPrecisionFormat){const e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);e&&(tn=e.precision?It.HIGH:It.MEDIUM)}}return tn}function vu(t,e){const s=t.getShaderSource(e).split(`
`).map((h,u)=>`${u}: ${h}`),r=t.getShaderInfoLog(e),i=r.split(`
`),n={},o=i.map(h=>parseFloat(h.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(h=>h&&!n[h]?(n[h]=!0,!0):!1),a=[""];o.forEach(h=>{s[h-1]=`%c${s[h-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const l=s.join(`
`);a[0]=l,console.error(r),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function P_(t,e,s,r){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(s,t.COMPILE_STATUS)||vu(t,s),t.getShaderParameter(r,t.COMPILE_STATUS)||vu(t,r),console.error("PixiJS Error: Could not initialize shader."),t.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}const F_={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function ld(t){return F_[t]}let sn=null;const _u={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function hd(t,e){if(!sn){const s=Object.keys(_u);sn={};for(let r=0;r<s.length;++r){const i=s[r];sn[t[i]]=_u[i]}}return sn[e]}function bu(t,e,s){if(t.substring(0,9)!=="precision"){let r=e;return e===It.HIGH&&s!==It.HIGH&&(r=It.MEDIUM),`precision ${r} float;
${t}`}else if(s!==It.HIGH&&t.substring(0,15)==="precision highp")return t.replace("precision highp","precision mediump");return t}let ti;function O_(){if(typeof ti=="boolean")return ti;try{ti=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{ti=!1}return ti}let M_=0;const rn={},Ga=class vr{constructor(e,s,r="pixi-shader",i={}){this.extra={},this.id=M_++,this.vertexSrc=e||vr.defaultVertexSrc,this.fragmentSrc=s||vr.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,this.vertexSrc.substring(0,8)!=="#version"&&(r=r.replace(/\s+/g,"-"),rn[r]?(rn[r]++,r+=`-${rn[r]}`):rn[r]=1,this.vertexSrc=`#define SHADER_NAME ${r}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${r}
${this.fragmentSrc}`,this.vertexSrc=bu(this.vertexSrc,vr.defaultVertexPrecision,It.HIGH),this.fragmentSrc=bu(this.fragmentSrc,vr.defaultFragmentPrecision,R_())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return w_}static get defaultFragmentSrc(){return T_}static from(e,s,r){const i=e+s;let n=pu[i];return n||(pu[i]=n=new vr(e,s,r)),n}};Ga.defaultVertexPrecision=It.HIGH,Ga.defaultFragmentPrecision=Ar.apple.device?It.HIGH:It.MEDIUM;let Xs=Ga,N_=0;class ts{constructor(e,s,r){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=N_++,this.static=!!s,this.ubo=!!r,e instanceof ht?(this.buffer=e,this.buffer.type=es.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new ht(new Float32Array(1)),this.buffer.type=es.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,s,r){if(!this.ubo)this.uniforms[e]=new ts(s,r);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(e,s,r){return new ts(e,s,r)}static uboFrom(e,s){return new ts(e,s??!0,!0)}}class po{constructor(e,s){this.uniformBindCount=0,this.program=e,s?s instanceof ts?this.uniformGroup=s:this.uniformGroup=new ts(s):this.uniformGroup=new ts({}),this.disposeRunner=new Vt("disposeShader")}checkUniformExists(e,s){if(s.uniforms[e])return!0;for(const r in s.uniforms){const i=s.uniforms[r];if(i.group===!0&&this.checkUniformExists(e,i))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,s,r){const i=Xs.from(e,s);return new po(i,r)}}class B_{constructor(e,s){if(this.vertexSrc=e,this.fragTemplate=s,this.programCache={},this.defaultGroupCache={},!s.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!s.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){const r=new Int32Array(e);for(let n=0;n<e;n++)r[n]=n;this.defaultGroupCache[e]=ts.from({uSamplers:r},!0);let i=this.fragTemplate;i=i.replace(/%count%/gi,`${e}`),i=i.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new Xs(this.vertexSrc,i)}const s={tint:new Float32Array([1,1,1,1]),translationMatrix:new Xe,default:this.defaultGroupCache[e]};return new po(this.programCache[e],s)}generateSampleSrc(e){let s="";s+=`
`,s+=`
`;for(let r=0;r<e;r++)r>0&&(s+=`
else `),r<e-1&&(s+=`if(vTextureId < ${r}.5)`),s+=`
{`,s+=`
	color = texture2D(uSamplers[${r}], vTextureCoord);`,s+=`
}`;return s+=`
`,s+=`
`,s}}class L_{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}function k_(){return!Ar.apple.device}function U_(t){let e=!0;const s=ne.ADAPTER.getNavigator();if(Ar.tablet||Ar.phone){if(Ar.apple.device){const r=s.userAgent.match(/OS (\d+)_(\d+)?/);r&&parseInt(r[1],10)<11&&(e=!1)}if(Ar.android.device){const r=s.userAgent.match(/Android\s([0-9.]*)/);r&&parseInt(r[1],10)<7&&(e=!1)}}return e?t:4}class ud{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}var D_=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,G_=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const ai=class Ot extends ud{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=b_,this.vertexSize=6,this.state=Xr.for2d(),this.size=Ot.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??U_(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??k_(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return xe("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return G_}static get defaultFragmentTemplate(){return D_}setShaderGenerator({vertex:e=Ot.defaultVertexSrc,fragment:s=Ot.defaultFragmentTemplate}={}){this.shaderGenerator=new B_(e,s)}contextChange(){const e=this.renderer.gl;ne.PREFER_ENV===ir.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),Ot.defaultMaxTextures),this.maxTextures=d_(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let s=0;s<this._packedGeometryPoolSize;s++)this._packedGeometries[s]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:s}=Ot,r=this.size/4,i=Math.floor(r/this.maxTextures)+1;for(;e.length<r;)e.push(new p_);for(;s.length<i;)s.push(new L_);for(let n=0;n<this.maxTextures;n++)this._tempBoundTextures[n]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:s}=this,r=Ot._textureArrayPool,i=this.renderer.batch,n=this._tempBoundTextures,o=this.renderer.textureGC.count;let a=++ve._globalBatch,l=0,h=r[0],u=0;i.copyBoundTextures(n,s);for(let c=0;c<this._bufferSize;++c){const d=e[c];e[c]=null,d._batchEnabled!==a&&(h.count>=s&&(i.boundArray(h,n,a,s),this.buildDrawCalls(h,u,c),u=c,h=r[++l],++a),d._batchEnabled=a,d.touched=o,h.elements[h.count++]=d)}h.count>0&&(i.boundArray(h,n,a,s),this.buildDrawCalls(h,u,this._bufferSize),++l,++a);for(let c=0;c<n.length;c++)n[c]=null;ve._globalBatch=a}buildDrawCalls(e,s,r){const{_bufferedElements:i,_attributeBuffer:n,_indexBuffer:o,vertexSize:a}=this,l=Ot._drawCallPool;let h=this._dcIndex,u=this._aIndex,c=this._iIndex,d=l[h];d.start=this._iIndex,d.texArray=e;for(let p=s;p<r;++p){const _=i[p],w=_._texture.baseTexture,E=n_[w.alphaMode?1:0][_.blendMode];i[p]=null,s<p&&d.blend!==E&&(d.size=c-d.start,s=p,d=l[++h],d.texArray=e,d.start=c),this.packInterleavedGeometry(_,n,o,u,c),u+=_.vertexData.length/2*a,c+=_.indices.length,d.blend=E}s<r&&(d.size=c-d.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=c}bindAndClearTexArray(e){const s=this.renderer.texture;for(let r=0;r<e.count;r++)s.bind(e.elements[r],e.ids[r]),e.elements[r]=null;e.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:s,_indexBuffer:r}=this;Ot.canUploadSameBuffer?(e[this._flushId]._buffer.update(s.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(s.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:s,state:r}=this.renderer,i=Ot._drawCallPool;let n=null;for(let o=0;o<e;o++){const{texArray:a,type:l,size:h,start:u,blend:c}=i[o];n!==a&&(n=a,this.bindAndClearTexArray(a)),this.state.blendMode=c,r.set(this.state),s.drawElements(l,h,s.UNSIGNED_SHORT,u*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),Ot.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const s=On(Math.ceil(e/8)),r=fu(s),i=s*8;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);let n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new h_(i*this.vertexSize*4)),n}getIndexBuffer(e){const s=On(Math.ceil(e/12)),r=fu(s),i=s*12;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);let n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n}packInterleavedGeometry(e,s,r,i,n){const{uint32View:o,float32View:a}=s,l=i/this.vertexSize,h=e.uvs,u=e.indices,c=e.vertexData,d=e._texture.baseTexture._batchLocation,p=Math.min(e.worldAlpha,1),_=fo.shared.setValue(e._tintRGB).toPremultiplied(p,e._texture.baseTexture.alphaMode>0);for(let w=0;w<c.length;w+=2)a[i++]=c[w],a[i++]=c[w+1],a[i++]=h[w],a[i++]=h[w+1],o[i++]=_,a[i++]=d;for(let w=0;w<u.length;w++)r[n++]=l+u[w]}};ai.defaultBatchSize=4096,ai.extension={name:"batch",type:$.RendererPlugin},ai._drawCallPool=[],ai._textureArrayPool=[];let Us=ai;Q.add(Us);var H_=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,$_=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const Ha=class li extends po{constructor(e,s,r){const i=Xs.from(e||li.defaultVertexSrc,s||li.defaultFragmentSrc);super(i,r),this.padding=0,this.resolution=li.defaultResolution,this.multisample=li.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Xr}apply(e,s,r,i,n){e.applyFilter(this,s,r,i)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return $_}static get defaultFragmentSrc(){return H_}};Ha.defaultResolution=1,Ha.defaultMultisample=De.NONE;let wr=Ha;class Nn{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new fo(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;const{backgroundColor:s,background:r,backgroundAlpha:i}=e,n=r??s;n!==void 0&&(this.color=n),this.alpha=i}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}}Nn.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},Nn.extension={type:[$.RendererSystem,$.CanvasRendererSystem],name:"background"};Q.add(Nn);class cd{constructor(e){this.renderer=e,this.emptyRenderer=new ud(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,s){const{boundTextures:r}=this.renderer.texture;for(let i=s-1;i>=0;--i)e[i]=r[i]||null,e[i]&&(e[i]._batchLocation=i)}boundArray(e,s,r,i){const{elements:n,ids:o,count:a}=e;let l=0;for(let h=0;h<a;h++){const u=n[h],c=u._batchLocation;if(c>=0&&c<i&&s[c]===u){o[h]=c;continue}for(;l<i;){const d=s[l];if(d&&d._batchEnabled===r&&d._batchLocation===l){l++;continue}o[h]=l,u._batchLocation=l,s[l]=u;break}}}destroy(){this.renderer=null}}cd.extension={type:$.RendererSystem,name:"batch"};Q.add(cd);let xu=0;class Bn{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=xu++}init(e){if(e.context)this.initFromContext(e.context);else{const s=this.renderer.background.alpha<1,r=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:s,premultipliedAlpha:r,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=xu++,this.renderer.runners.contextChange.emit(e);const s=this.renderer.view;s.addEventListener!==void 0&&(s.addEventListener("webglcontextlost",this.handleContextLost,!1),s.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){const s=this.createContext(this.renderer.view,e);this.initFromContext(s)}createContext(e,s){let r;if(ne.PREFER_ENV>=ir.WEBGL2&&(r=e.getContext("webgl2",s)),r)this.webGLVersion=2;else if(this.webGLVersion=1,r=e.getContext("webgl",s)||e.getContext("experimental-webgl",s),!r)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),this.gl}getExtensions(){const{gl:e}=this,s={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,s,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,s,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this.renderer.view;this.renderer=null,e.removeEventListener!==void 0&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){const s=e.getContextAttributes(),r="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;r&&(this.webGLVersion=2),s&&!s.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const i=r||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}Bn.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},Bn.extension={type:$.RendererSystem,name:"context"};Q.add(Bn);class $a{constructor(e,s){if(this.width=Math.round(e),this.height=Math.round(s),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Vt("disposeFramebuffer"),this.multisample=De.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,s){return this.colorTextures[e]=s||new ve(null,{scaleMode:hs.NEAREST,resolution:1,mipmap:sr.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new ve(null,{scaleMode:hs.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:sr.OFF,format:L.DEPTH_COMPONENT,type:he.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,s){if(e=Math.round(e),s=Math.round(s),!e||!s)throw new Error("Framebuffer width and height must not be zero");if(!(e===this.width&&s===this.height)){this.width=e,this.height=s,this.dirtyId++,this.dirtySize++;for(let r=0;r<this.colorTextures.length;r++){const i=this.colorTextures[r],n=i.resolution;i.setSize(e/n,s/n)}if(this.depthTexture){const r=this.depthTexture.resolution;this.depthTexture.setSize(e/r,s/r)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class dd extends ve{constructor(e={}){if(typeof e=="number"){const s=arguments[0],r=arguments[1],i=arguments[2],n=arguments[3];e={width:s,height:r,scaleMode:i,resolution:n}}e.width=e.width??100,e.height=e.height??100,e.multisample??(e.multisample=De.NONE),super(null,e),this.mipmap=sr.OFF,this.valid=!0,this._clear=new fo([0,0,0,0]),this.framebuffer=new $a(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,s){this.framebuffer.resize(e*this.resolution,s*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class Is extends Oi{constructor(e){const s=e,r=s.naturalWidth||s.videoWidth||s.width,i=s.naturalHeight||s.videoHeight||s.height;super(r,i),this.source=e,this.noSubImage=!1}static crossOrigin(e,s,r){r===void 0&&!s.startsWith("data:")?e.crossOrigin=l_(s):r!==!1&&(e.crossOrigin=typeof r=="string"?r:"anonymous")}upload(e,s,r,i){const n=e.gl,o=s.realWidth,a=s.realHeight;if(i=i||this.source,typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement){if(!i.complete||i.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement&&i.readyState<=1)return!1;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.alphaMode===Gt.UNPACK),!this.noSubImage&&s.target===n.TEXTURE_2D&&r.width===o&&r.height===a?n.texSubImage2D(n.TEXTURE_2D,0,0,0,s.format,r.type,i):(r.width=o,r.height=a,n.texImage2D(s.target,0,r.internalFormat,s.format,r.type,i)),!0}update(){if(this.destroyed)return;const e=this.source,s=e.naturalWidth||e.videoWidth||e.width,r=e.naturalHeight||e.videoHeight||e.height;this.resize(s,r),super.update()}dispose(){this.source=null}}class fd extends Is{constructor(e,s){if(s=s||{},typeof e=="string"){const r=new Image;Is.crossOrigin(r,e,s.crossorigin),r.src=e,e=r}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(s.createBitmap??ne.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof s.alphaMode=="number"?s.alphaMode:null,this.bitmap=null,this._load=null,s.autoLoad!==!1&&this.load()}load(e){return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise((s,r)=>{const i=this.source;this.url=i.src;const n=()=>{this.destroyed||(i.onload=null,i.onerror=null,this.update(),this._load=null,this.createBitmap?s(this.process()):s(this))};i.complete&&i.src?n():(i.onload=n,i.onerror=o=>{r(o),this.onError.emit(o)})}),this._load)}process(){const e=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const s=globalThis.createImageBitmap,r=!e.crossOrigin||e.crossOrigin==="anonymous";return this._process=fetch(e.src,{mode:r?"cors":"no-cors"}).then(i=>i.blob()).then(i=>s(i,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Gt.UNPACK?"premultiply":"none"})).then(i=>this.destroyed?Promise.reject():(this.bitmap=i,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,s,r){if(typeof this.alphaMode=="number"&&(s.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,s,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,s,r,this.bitmap),!this.preserveBitmap){let i=!0;const n=s._glTextures;for(const o in n){const a=n[o];if(a!==r&&a.dirtyId!==s.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&(typeof e=="string"||e instanceof HTMLImageElement)}}class Sl{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,s,r){const i=s.width,n=s.height;if(r){const o=e.width/2/i,a=e.height/2/n,l=e.x/i+o,h=e.y/n+a;r=Me.add(r,Me.NW),this.x0=l+o*Me.uX(r),this.y0=h+a*Me.uY(r),r=Me.add(r,2),this.x1=l+o*Me.uX(r),this.y1=h+a*Me.uY(r),r=Me.add(r,2),this.x2=l+o*Me.uX(r),this.y2=h+a*Me.uY(r),r=Me.add(r,2),this.x3=l+o*Me.uX(r),this.y3=h+a*Me.uY(r)}else this.x0=e.x/i,this.y0=e.y/n,this.x1=(e.x+e.width)/i,this.y1=e.y/n,this.x2=(e.x+e.width)/i,this.y2=(e.y+e.height)/n,this.x3=e.x/i,this.y3=(e.y+e.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}Sl.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const Au=new Sl;function nn(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}class ge extends Ss{constructor(e,s,r,i,n,o,a){if(super(),this.noFrame=!1,s||(this.noFrame=!0,s=new Le(0,0,1,1)),e instanceof ge&&(e=e.baseTexture),this.baseTexture=e,this._frame=s,this.trim=i,this.valid=!1,this.destroyed=!1,this._uvs=Au,this.uvMatrix=null,this.orig=r||s,this._rotate=Number(n||0),n===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new ct(o.x,o.y):new ct(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=s:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){const{resource:s}=this.baseTexture;s!=null&&s.url&&Xt[s.url]&&ge.removeFromCache(s.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,ge.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var i;const e=this._frame.clone(),s=this._frame===this.orig?e:this.orig.clone(),r=new ge(this.baseTexture,!this.noFrame&&e,s,(i=this.trim)==null?void 0:i.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(r._frame=e),r}updateUvs(){this._uvs===Au&&(this._uvs=new Sl),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,s={},r=ne.STRICT_TEXTURE_CACHE){const i=typeof e=="string";let n=null;if(i)n=e;else if(e instanceof ve){if(!e.cacheId){const a=(s==null?void 0:s.pixiIdPrefix)||"pixiid";e.cacheId=`${a}-${Pi()}`,ve.addToCache(e,e.cacheId)}n=e.cacheId}else{if(!e._pixiId){const a=(s==null?void 0:s.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${Pi()}`}n=e._pixiId}let o=Xt[n];if(i&&r&&!o)throw new Error(`The cacheId "${n}" does not exist in TextureCache.`);return!o&&!(e instanceof ve)?(s.resolution||(s.resolution=Fi(e)),o=new ge(new ve(e,s)),o.baseTexture.cacheId=n,ve.addToCache(o.baseTexture,n),ge.addToCache(o,n)):!o&&e instanceof ve&&(o=new ge(e),ge.addToCache(o,n)),o}static fromURL(e,s){const r=Object.assign({autoLoad:!1},s==null?void 0:s.resourceOptions),i=ge.from(e,Object.assign({resourceOptions:r},s),!1),n=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):n.load().then(()=>Promise.resolve(i))}static fromBuffer(e,s,r,i){return new ge(ve.fromBuffer(e,s,r,i))}static fromLoader(e,s,r,i){const n=new ve(e,Object.assign({scaleMode:ve.defaultOptions.scaleMode,resolution:Fi(s)},i)),{resource:o}=n;o instanceof fd&&(o.url=s);const a=new ge(n);return r||(r=s),ve.addToCache(a.baseTexture,r),ge.addToCache(a,r),r!==s&&(ve.addToCache(a.baseTexture,s),ge.addToCache(a,s)),a.baseTexture.valid?Promise.resolve(a):new Promise(l=>{a.baseTexture.once("loaded",()=>l(a))})}static addToCache(e,s){s&&(e.textureCacheIds.includes(s)||e.textureCacheIds.push(s),Xt[s]&&Xt[s]!==e&&console.warn(`Texture added to the cache with an id [${s}] that already had an entry`),Xt[s]=e)}static removeFromCache(e){if(typeof e=="string"){const s=Xt[e];if(s){const r=s.textureCacheIds.indexOf(e);return r>-1&&s.textureCacheIds.splice(r,1),delete Xt[e],s}}else if(e!=null&&e.textureCacheIds){for(let s=0;s<e.textureCacheIds.length;++s)Xt[e.textureCacheIds[s]]===e&&delete Xt[e.textureCacheIds[s]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;const{x:s,y:r,width:i,height:n}=e,o=s+i>this.baseTexture.width,a=r+n>this.baseTexture.height;if(o||a){const l=o&&a?"and":"or",h=`X: ${s} + ${i} = ${s+i} > ${this.baseTexture.width}`,u=`Y: ${r} + ${n} = ${r+n} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${h} ${l} ${u}`)}this.valid=i&&n&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return ge._EMPTY||(ge._EMPTY=new ge(new ve),nn(ge._EMPTY),nn(ge._EMPTY.baseTexture)),ge._EMPTY}static get WHITE(){if(!ge._WHITE){const e=ne.ADAPTER.createCanvas(16,16),s=e.getContext("2d");e.width=16,e.height=16,s.fillStyle="white",s.fillRect(0,0,16,16),ge._WHITE=new ge(ve.from(e)),nn(ge._WHITE),nn(ge._WHITE.baseTexture)}return ge._WHITE}}class mo extends ge{constructor(e,s){super(e,s),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,s,r=!0){const i=this.baseTexture.resolution,n=Math.round(e*i)/i,o=Math.round(s*i)/i;this.valid=n>0&&o>0,this._frame.width=this.orig.width=n,this._frame.height=this.orig.height=o,r&&this.baseTexture.resize(n,o),this.updateUvs()}setResolution(e){const{baseTexture:s}=this;s.resolution!==e&&(s.setResolution(e),this.resize(s.width,s.height,!1))}static create(e){return new mo(new dd(e))}}class pd{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,s,r=De.NONE){const i=new dd(Object.assign({width:e,height:s,resolution:1,multisample:r},this.textureOptions));return new mo(i)}getOptimalTexture(e,s,r=1,i=De.NONE){let n;e=Math.max(Math.ceil(e*r-1e-6),1),s=Math.max(Math.ceil(s*r-1e-6),1),!this.enableFullScreen||e!==this._pixelsWidth||s!==this._pixelsHeight?(e=On(e),s=On(s),n=((e&65535)<<16|s&65535)>>>0,i>1&&(n+=i*4294967296)):n=i>1?-i:-1,this.texturePool[n]||(this.texturePool[n]=[]);let o=this.texturePool[n].pop();return o||(o=this.createTexture(e,s,i)),o.filterPoolKey=n,o.setResolution(r),o}getFilterTexture(e,s,r){const i=this.getOptimalTexture(e.width,e.height,s||e.resolution,r||De.NONE);return i.filterFrame=e.filterFrame,i}returnTexture(e){const s=e.filterPoolKey;e.filterFrame=null,this.texturePool[s].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=e!==!1,e)for(const s in this.texturePool){const r=this.texturePool[s];if(r)for(let i=0;i<r.length;i++)r[i].destroy(!0)}this.texturePool={}}setScreenSize(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(const s in this.texturePool){if(!(Number(s)<0))continue;const r=this.texturePool[s];if(r)for(let i=0;i<r.length;i++)r[i].destroy(!0);this.texturePool[s]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}pd.SCREEN_KEY=-1;class V_ extends $r{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class q_ extends $r{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new ht(this.vertices),this.uvBuffer=new ht(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,s){let r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+s.width/e.width,this.uvs[3]=i,this.uvs[4]=r+s.width/e.width,this.uvs[5]=i+s.height/e.height,this.uvs[6]=r,this.uvs[7]=i+s.height/e.height,r=s.x,i=s.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+s.width,this.vertices[3]=i,this.vertices[4]=r+s.width,this.vertices[5]=i+s.height,this.vertices[6]=r,this.vertices[7]=i+s.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class W_{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=De.NONE,this.sourceFrame=new Le,this.destinationFrame=new Le,this.bindingSourceFrame=new Le,this.bindingDestinationFrame=new Le,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const on=[new ct,new ct,new ct,new ct],Xo=new Xe;class md{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new pd,this.statePool=[],this.quad=new V_,this.quadUv=new q_,this.tempRect=new Le,this.activeState={},this.globalUniforms=new ts({outputFrame:new Le,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,s){const r=this.renderer,i=this.defaultFilterStack,n=this.statePool.pop()||new W_,o=r.renderTexture;let a,l;if(o.current){const E=o.current;a=E.resolution,l=E.multisample}else a=r.resolution,l=r.multisample;let h=s[0].resolution||a,u=s[0].multisample??l,c=s[0].padding,d=s[0].autoFit,p=s[0].legacy??!0;for(let E=1;E<s.length;E++){const y=s[E];h=Math.min(h,y.resolution||a),u=Math.min(u,y.multisample??l),c=this.useMaxPadding?Math.max(c,y.padding):c+y.padding,d=d&&y.autoFit,p=p||(y.legacy??!0)}i.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),i.push(n),n.resolution=h,n.multisample=u,n.legacy=p,n.target=e,n.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),n.sourceFrame.pad(c);const _=this.tempRect.copyFrom(o.sourceFrame);r.projection.transform&&this.transformAABB(Xo.copyFrom(r.projection.transform).invert(),_),d?(n.sourceFrame.fit(_),(n.sourceFrame.width<=0||n.sourceFrame.height<=0)&&(n.sourceFrame.width=0,n.sourceFrame.height=0)):n.sourceFrame.intersects(_)||(n.sourceFrame.width=0,n.sourceFrame.height=0),this.roundFrame(n.sourceFrame,o.current?o.current.resolution:r.resolution,o.sourceFrame,o.destinationFrame,r.projection.transform),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,h,u),n.filters=s,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;const w=this.tempRect;w.x=0,w.y=0,w.width=n.sourceFrame.width,w.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,n.bindingSourceFrame.copyFrom(o.sourceFrame),n.bindingDestinationFrame.copyFrom(o.destinationFrame),n.transform=r.projection.transform,r.projection.transform=null,o.bind(n.renderTexture,n.sourceFrame,w),r.framebuffer.clear(0,0,0,0)}pop(){const e=this.defaultFilterStack,s=e.pop(),r=s.filters;this.activeState=s;const i=this.globalUniforms.uniforms;i.outputFrame=s.sourceFrame,i.resolution=s.resolution;const n=i.inputSize,o=i.inputPixel,a=i.inputClamp;if(n[0]=s.destinationFrame.width,n[1]=s.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],o[0]=Math.round(n[0]*s.resolution),o[1]=Math.round(n[1]*s.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=s.sourceFrame.width*n[2]-.5*o[2],a[3]=s.sourceFrame.height*n[3]-.5*o[3],s.legacy){const h=i.filterArea;h[0]=s.destinationFrame.width,h[1]=s.destinationFrame.height,h[2]=s.sourceFrame.x,h[3]=s.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();const l=e[e.length-1];if(this.renderer.framebuffer.blit(),r.length===1)r[0].apply(this,s.renderTexture,l.renderTexture,Ms.BLEND,s),this.returnFilterTexture(s.renderTexture);else{let h=s.renderTexture,u=this.getOptimalFilterTexture(h.width,h.height,s.resolution);u.filterFrame=h.filterFrame;let c=0;for(c=0;c<r.length-1;++c){c===1&&s.multisample>1&&(u=this.getOptimalFilterTexture(h.width,h.height,s.resolution),u.filterFrame=h.filterFrame),r[c].apply(this,h,u,Ms.CLEAR,s);const d=h;h=u,u=d}r[c].apply(this,h,l.renderTexture,Ms.BLEND,s),c>1&&s.multisample>1&&this.returnFilterTexture(s.renderTexture),this.returnFilterTexture(h),this.returnFilterTexture(u)}s.clear(),this.statePool.push(s)}bindAndClear(e,s=Ms.CLEAR){const{renderTexture:r,state:i}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e==null?void 0:e.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=e.filterFrame.width,o.height=e.filterFrame.height,r.bind(e,e.filterFrame,o)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?r.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const n=i.stateId&1||this.forceClear;(s===Ms.CLEAR||s===Ms.BLIT&&n)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,s,r,i){const n=this.renderer;n.state.set(e.state),this.bindAndClear(r,i),e.uniforms.uSampler=s,e.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(s._frame,s.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(In.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(In.TRIANGLE_STRIP))}calculateSpriteMatrix(e,s){const{sourceFrame:r,destinationFrame:i}=this.activeState,{orig:n}=s._texture,o=e.set(i.width,0,0,i.height,r.x,r.y),a=s.worldTransform.copyTo(Xe.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/n.width,1/n.height),o.translate(s.anchor.x,s.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,s,r=1,i=De.NONE){return this.texturePool.getOptimalTexture(e,s,r,i)}getFilterTexture(e,s,r){if(typeof e=="number"){const n=e;e=s,s=n}e=e||this.activeState.renderTexture;const i=this.texturePool.getOptimalTexture(e.width,e.height,s||e.resolution,r||De.NONE);return i.filterFrame=e.filterFrame,i}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,s){const r=on[0],i=on[1],n=on[2],o=on[3];r.set(s.left,s.top),i.set(s.left,s.bottom),n.set(s.right,s.top),o.set(s.right,s.bottom),e.apply(r,r),e.apply(i,i),e.apply(n,n),e.apply(o,o);const a=Math.min(r.x,i.x,n.x,o.x),l=Math.min(r.y,i.y,n.y,o.y),h=Math.max(r.x,i.x,n.x,o.x),u=Math.max(r.y,i.y,n.y,o.y);s.x=a,s.y=l,s.width=h-a,s.height=u-l}roundFrame(e,s,r,i,n){if(!(e.width<=0||e.height<=0||r.width<=0||r.height<=0)){if(n){const{a:o,b:a,c:l,d:h}=n;if((Math.abs(a)>1e-4||Math.abs(l)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(h)>1e-4))return}n=n?Xo.copyFrom(n):Xo.identity(),n.translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.transformAABB(n,e),e.ceil(s),this.transformAABB(n.invert(),e)}}}md.extension={type:$.RendererSystem,name:"filter"};Q.add(md);class j_{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=De.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const z_=new Le;class yd{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new $a(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Le,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let s=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;ne.PREFER_ENV===ir.WEBGL_LEGACY&&(s=null,r=null),s?e.drawBuffers=i=>s.drawBuffersWEBGL(i):(this.hasMRT=!1,e.drawBuffers=()=>{}),r||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,s,r=0){const{gl:i}=this;if(e){const n=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,i.bindFramebuffer(i.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==r&&(e.dirtyId++,e.dirtyFormat++,n.mipLevel=r),n.dirtyId!==e.dirtyId&&(n.dirtyId=e.dirtyId,n.dirtyFormat!==e.dirtyFormat?(n.dirtyFormat=e.dirtyFormat,n.dirtySize=e.dirtySize,this.updateFramebuffer(e,r)):n.dirtySize!==e.dirtySize&&(n.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let o=0;o<e.colorTextures.length;o++){const a=e.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),s){const o=s.width>>r,a=s.height>>r,l=o/s.width;this.setViewport(s.x*l,s.y*l,o,a)}else{const o=e.width>>r,a=e.height>>r;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),s?this.setViewport(s.x,s.y,s.width,s.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,s,r,i){const n=this.viewport;e=Math.round(e),s=Math.round(s),r=Math.round(r),i=Math.round(i),(n.width!==r||n.height!==i||n.x!==e||n.y!==s)&&(n.x=e,n.y=s,n.width=r,n.height=i,this.gl.viewport(e,s,r,i))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,s,r,i,n=va.COLOR|va.DEPTH){const{gl:o}=this;o.clearColor(e,s,r,i),o.clear(n)}initFramebuffer(e){const{gl:s}=this,r=new j_(s.createFramebuffer());return r.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=r,this.managedFramebuffers.push(e),e.disposeRunner.add(this),r}resizeFramebuffer(e){const{gl:s}=this,r=e.glFramebuffers[this.CONTEXT_UID];if(r.stencil){s.bindRenderbuffer(s.RENDERBUFFER,r.stencil);let o;this.renderer.context.webGLVersion===1?o=s.DEPTH_STENCIL:e.depth&&e.stencil?o=s.DEPTH24_STENCIL8:e.depth?o=s.DEPTH_COMPONENT24:o=s.STENCIL_INDEX8,r.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,o,e.width,e.height):s.renderbufferStorage(s.RENDERBUFFER,o,e.width,e.height)}const i=e.colorTextures;let n=i.length;s.drawBuffers||(n=Math.min(n,1));for(let o=0;o<n;o++){const a=i[o],l=a.parentTextureArray||a;this.renderer.texture.bind(l,0),o===0&&r.msaaBuffer&&(s.bindRenderbuffer(s.RENDERBUFFER,r.msaaBuffer),s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,s){const{gl:r}=this,i=e.glFramebuffers[this.CONTEXT_UID],n=e.colorTextures;let o=n.length;r.drawBuffers||(o=Math.min(o,1)),i.multisample>1&&this.canMultisampleFramebuffer(e)?i.msaaBuffer=i.msaaBuffer||r.createRenderbuffer():i.msaaBuffer&&(r.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));const a=[];for(let l=0;l<o;l++){const h=n[l],u=h.parentTextureArray||h;this.renderer.texture.bind(u,0),l===0&&i.msaaBuffer?(r.bindRenderbuffer(r.RENDERBUFFER,i.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,u._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,i.msaaBuffer)):(r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+l,h.target,u._glTextures[this.CONTEXT_UID].texture,s),a.push(r.COLOR_ATTACHMENT0+l))}if(a.length>1&&r.drawBuffers(a),e.depthTexture&&this.writeDepthTexture){const l=e.depthTexture;this.renderer.texture.bind(l,0),r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,s)}if((e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)){i.stencil=i.stencil||r.createRenderbuffer();let l,h;this.renderer.context.webGLVersion===1?(l=r.DEPTH_STENCIL_ATTACHMENT,h=r.DEPTH_STENCIL):e.depth&&e.stencil?(l=r.DEPTH_STENCIL_ATTACHMENT,h=r.DEPTH24_STENCIL8):e.depth?(l=r.DEPTH_ATTACHMENT,h=r.DEPTH_COMPONENT24):(l=r.STENCIL_ATTACHMENT,h=r.STENCIL_INDEX8),r.bindRenderbuffer(r.RENDERBUFFER,i.stencil),i.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,h,e.width,e.height):r.renderbufferStorage(r.RENDERBUFFER,h,e.width,e.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,l,r.RENDERBUFFER,i.stencil)}else i.stencil&&(r.deleteRenderbuffer(i.stencil),i.stencil=null)}canMultisampleFramebuffer(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){const{msaaSamples:s}=this;let r=De.NONE;if(e<=1||s===null)return r;for(let i=0;i<s.length;i++)if(s[i]<=e){r=s[i];break}return r===1&&(r=De.NONE),r}blit(e,s,r){const{current:i,renderer:n,gl:o,CONTEXT_UID:a}=this;if(n.context.webGLVersion!==2||!i)return;const l=i.glFramebuffers[a];if(!l)return;if(!e){if(!l.msaaBuffer)return;const u=i.colorTextures[0];if(!u)return;l.blitFramebuffer||(l.blitFramebuffer=new $a(i.width,i.height),l.blitFramebuffer.addColorTexture(0,u)),e=l.blitFramebuffer,e.colorTextures[0]!==u&&(e.colorTextures[0]=u,e.dirtyId++,e.dirtyFormat++),(e.width!==i.width||e.height!==i.height)&&(e.width=i.width,e.height=i.height,e.dirtyId++,e.dirtySize++)}s||(s=z_,s.width=i.width,s.height=i.height),r||(r=s);const h=s.width===r.width&&s.height===r.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,l.framebuffer),o.blitFramebuffer(s.left,s.top,s.right,s.bottom,r.left,r.top,r.right,r.bottom,o.COLOR_BUFFER_BIT,h?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,s){const r=e.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(!r)return;delete e.glFramebuffers[this.CONTEXT_UID];const n=this.managedFramebuffers.indexOf(e);n>=0&&this.managedFramebuffers.splice(n,1),e.disposeRunner.remove(this),s||(i.deleteFramebuffer(r.framebuffer),r.msaaBuffer&&i.deleteRenderbuffer(r.msaaBuffer),r.stencil&&i.deleteRenderbuffer(r.stencil)),r.blitFramebuffer&&this.disposeFramebuffer(r.blitFramebuffer,s)}disposeAll(e){const s=this.managedFramebuffers;this.managedFramebuffers=[];for(let r=0;r<s.length;r++)this.disposeFramebuffer(s[r],e)}forceStencil(){const e=this.current;if(!e)return;const s=e.glFramebuffers[this.CONTEXT_UID];if(!s||s.stencil&&e.stencil)return;e.stencil=!0;const r=e.width,i=e.height,n=this.gl,o=s.stencil=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,o);let a,l;this.renderer.context.webGLVersion===1?(a=n.DEPTH_STENCIL_ATTACHMENT,l=n.DEPTH_STENCIL):e.depth?(a=n.DEPTH_STENCIL_ATTACHMENT,l=n.DEPTH24_STENCIL8):(a=n.STENCIL_ATTACHMENT,l=n.STENCIL_INDEX8),s.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,s.multisample,l,r,i):n.renderbufferStorage(n.RENDERBUFFER,l,r,i),n.framebufferRenderbuffer(n.FRAMEBUFFER,a,n.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Le}destroy(){this.renderer=null}}yd.extension={type:$.RendererSystem,name:"framebuffer"};Q.add(yd);const Ko={5126:4,5123:2,5121:1};class gd{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl,s=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,s.webGLVersion!==2){let r=this.renderer.context.extensions.vertexArrayObject;ne.PREFER_ENV===ir.WEBGL_LEGACY&&(r=null),r?(e.createVertexArray=()=>r.createVertexArrayOES(),e.bindVertexArray=i=>r.bindVertexArrayOES(i),e.deleteVertexArray=i=>r.deleteVertexArrayOES(i)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(s.webGLVersion!==2){const r=e.getExtension("ANGLE_instanced_arrays");r?(e.vertexAttribDivisor=(i,n)=>r.vertexAttribDivisorANGLE(i,n),e.drawElementsInstanced=(i,n,o,a,l)=>r.drawElementsInstancedANGLE(i,n,o,a,l),e.drawArraysInstanced=(i,n,o,a)=>r.drawArraysInstancedANGLE(i,n,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=s.webGLVersion===2||!!s.extensions.uint32ElementIndex}bind(e,s){s=s||this.renderer.shader.shader;const{gl:r}=this;let i=e.glVertexArrayObjects[this.CONTEXT_UID],n=!1;i||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=i={},n=!0);const o=i[s.program.id]||this.initGeometryVao(e,s,n);this._activeGeometry=e,this._activeVao!==o&&(this._activeVao=o,this.hasVao?r.bindVertexArray(o):this.activateVao(e,s.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,s=this.renderer.buffer;for(let r=0;r<e.buffers.length;r++){const i=e.buffers[r];s.update(i)}}checkCompatibility(e,s){const r=e.attributes,i=s.attributeData;for(const n in i)if(!r[n])throw new Error(`shader and geometry incompatible, geometry missing the "${n}" attribute`)}getSignature(e,s){const r=e.attributes,i=s.attributeData,n=["g",e.id];for(const o in r)i[o]&&n.push(o,i[o].location);return n.join("-")}initGeometryVao(e,s,r=!0){const i=this.gl,n=this.CONTEXT_UID,o=this.renderer.buffer,a=s.program;a.glPrograms[n]||this.renderer.shader.generateProgram(s),this.checkCompatibility(e,a);const l=this.getSignature(e,a),h=e.glVertexArrayObjects[this.CONTEXT_UID];let u=h[l];if(u)return h[a.id]=u,u;const c=e.buffers,d=e.attributes,p={},_={};for(const w in c)p[w]=0,_[w]=0;for(const w in d)!d[w].size&&a.attributeData[w]?d[w].size=a.attributeData[w].size:d[w].size||console.warn(`PIXI Geometry attribute '${w}' size cannot be determined (likely the bound shader does not have the attribute)`),p[d[w].buffer]+=d[w].size*Ko[d[w].type];for(const w in d){const E=d[w],y=E.size;E.stride===void 0&&(p[E.buffer]===y*Ko[E.type]?E.stride=0:E.stride=p[E.buffer]),E.start===void 0&&(E.start=_[E.buffer],_[E.buffer]+=y*Ko[E.type])}u=i.createVertexArray(),i.bindVertexArray(u);for(let w=0;w<c.length;w++){const E=c[w];o.bind(E),r&&E._glBuffers[n].refCount++}return this.activateVao(e,a),h[a.id]=u,h[l]=u,i.bindVertexArray(null),o.unbind(es.ARRAY_BUFFER),u}disposeGeometry(e,s){var a;if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];const r=e.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,n=e.buffers,o=(a=this.renderer)==null?void 0:a.buffer;if(e.disposeRunner.remove(this),!!r){if(o)for(let l=0;l<n.length;l++){const h=n[l]._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!s&&o.dispose(n[l],s))}if(!s){for(const l in r)if(l[0]==="g"){const h=r[l];this._activeVao===h&&this.unbind(),i.deleteVertexArray(h)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){const s=Object.keys(this.managedGeometries);for(let r=0;r<s.length;r++)this.disposeGeometry(this.managedGeometries[s[r]],e)}activateVao(e,s){const r=this.gl,i=this.CONTEXT_UID,n=this.renderer.buffer,o=e.buffers,a=e.attributes;e.indexBuffer&&n.bind(e.indexBuffer);let l=null;for(const h in a){const u=a[h],c=o[u.buffer],d=c._glBuffers[i];if(s.attributeData[h]){l!==d&&(n.bind(c),l=d);const p=s.attributeData[h].location;if(r.enableVertexAttribArray(p),r.vertexAttribPointer(p,u.size,u.type||r.FLOAT,u.normalized,u.stride,u.start),u.instance)if(this.hasInstance)r.vertexAttribDivisor(p,u.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,s,r,i){const{gl:n}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,l=a===2?n.UNSIGNED_SHORT:n.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?n.drawElementsInstanced(e,s||o.indexBuffer.data.length,l,(r||0)*a,i||1):n.drawElements(e,s||o.indexBuffer.data.length,l,(r||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?n.drawArraysInstanced(e,r,s||o.getSize(),i||1):n.drawArrays(e,r,s||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}gd.extension={type:$.RendererSystem,name:"geometry"};Q.add(gd);const Tu=new Xe;class X_{constructor(e,s){this._texture=e,this.mapCoord=new Xe,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof s>"u"?.5:s,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,s){s===void 0&&(s=e);const r=this.mapCoord;for(let i=0;i<e.length;i+=2){const n=e[i],o=e[i+1];s[i]=n*r.a+o*r.c+r.tx,s[i+1]=n*r.b+o*r.d+r.ty}return s}update(e){const s=this._texture;if(!s||!s.valid||!e&&this._textureID===s._updateID)return!1;this._textureID=s._updateID,this._updateID++;const r=s._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);const i=s.orig,n=s.trim;n&&(Tu.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Tu));const o=s.baseTexture,a=this.uClampFrame,l=this.clampMargin/o.resolution,h=this.clampOffset;return a[0]=(s._frame.x+l+h)/o.width,a[1]=(s._frame.y+l+h)/o.height,a[2]=(s._frame.x+s._frame.width-l+h)/o.width,a[3]=(s._frame.y+s._frame.height-l+h)/o.height,this.uClampOffset[0]=h/o.realWidth,this.uClampOffset[1]=h/o.realHeight,this.isSimple=s._frame.width===o.width&&s._frame.height===o.height&&s.rotate===0,!0}}var K_=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,Z_=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class Q_ extends wr{constructor(e,s,r){let i=null;typeof e!="string"&&s===void 0&&r===void 0&&(i=e,e=void 0,s=void 0,r=void 0),super(e||Z_,s||K_,r),this.maskSprite=i,this.maskMatrix=new Xe}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,s,r,i){const n=this._maskSprite,o=n._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new X_(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,n).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,s,r,i))}}class Y_{constructor(e=null){this.type=Ve.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=wr.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=Ve.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class vd{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,s){let r=s;if(!r.isMaskData){const n=this.maskDataPool.pop()||new Y_;n.pooled=!0,n.maskObject=s,r=n}const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(r.copyCountersOrReset(i),r._colorMask=i?i._colorMask:15,r.autoDetect&&this.detect(r),r._target=e,r.type!==Ve.SPRITE&&this.maskStack.push(r),r.enabled)switch(r.type){case Ve.SCISSOR:this.renderer.scissor.push(r);break;case Ve.STENCIL:this.renderer.stencil.push(r);break;case Ve.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r);break;case Ve.COLOR:this.pushColorMask(r);break}r.type===Ve.SPRITE&&this.maskStack.push(r)}pop(e){const s=this.maskStack.pop();if(!(!s||s._target!==e)){if(s.enabled)switch(s.type){case Ve.SCISSOR:this.renderer.scissor.pop(s);break;case Ve.STENCIL:this.renderer.stencil.pop(s.maskObject);break;case Ve.SPRITE:this.popSpriteMask(s);break;case Ve.COLOR:this.popColorMask(s);break}if(s.reset(),s.pooled&&this.maskDataPool.push(s),this.maskStack.length!==0){const r=this.maskStack[this.maskStack.length-1];r.type===Ve.SPRITE&&r._filters&&(r._filters[0].maskSprite=r.maskObject)}}}detect(e){const s=e.maskObject;s?s.isSprite?e.type=Ve.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=Ve.SCISSOR:e.type=Ve.STENCIL:e.type=Ve.COLOR}pushSpriteMask(e){const{maskObject:s}=e,r=e._target;let i=e._filters;i||(i=this.alphaMaskPool[this.alphaMaskIndex],i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new Q_])),i[0].resolution=e.resolution,i[0].multisample=e.multisample,i[0].maskSprite=s;const n=r.filterArea;r.filterArea=s.getBounds(!0),this.renderer.filter.push(r,i),r.filterArea=n,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){const s=e._colorMask,r=e._colorMask=s&e.colorMask;r!==s&&this.renderer.gl.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)}popColorMask(e){const s=e._colorMask,r=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;r!==s&&this.renderer.gl.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)}destroy(){this.renderer=null}}vd.extension={type:$.RendererSystem,name:"mask"};Q.add(vd);class _d{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){const{gl:s}=this.renderer,r=this.getStackLength();this.maskStack=e;const i=this.getStackLength();i!==r&&(i===0?s.disable(this.glConst):(s.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const wu=new Xe,Eu=[],bd=class gn extends _d{constructor(e){super(e),this.glConst=ne.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;const s=e._scissorRect,{maskObject:r}=e,{renderer:i}=this,n=i.renderTexture,o=r.getBounds(!0,Eu.pop()??new Le);this.roundFrameToPixels(o,n.current?n.current.resolution:i.resolution,n.sourceFrame,n.destinationFrame,i.projection.transform),s&&o.fit(s),e._scissorRectLocal=o}static isMatrixRotated(e){if(!e)return!1;const{a:s,b:r,c:i,d:n}=e;return(Math.abs(r)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(s)>1e-4||Math.abs(n)>1e-4)}testScissor(e){const{maskObject:s}=e;if(!s.isFastRect||!s.isFastRect()||gn.isMatrixRotated(s.worldTransform)||gn.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const r=e._scissorRectLocal;return r.width>0&&r.height>0}roundFrameToPixels(e,s,r,i,n){gn.isMatrixRotated(n)||(n=n?wu.copyFrom(n):wu.identity(),n.translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.renderer.filter.transformAABB(n,e),e.fit(i),e.x=Math.round(e.x*s),e.y=Math.round(e.y*s),e.width=Math.round(e.width*s),e.height=Math.round(e.height*s))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:s}=this.renderer;e._scissorRect||s.enable(s.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:s}=this.renderer;e&&Eu.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():s.disable(s.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let s;this.renderer.renderTexture.current?s=e.y:s=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,s,e.width,e.height)}};bd.extension={type:$.RendererSystem,name:"scissor"};let J_=bd;Q.add(J_);class xd extends _d{constructor(e){super(e),this.glConst=ne.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){const s=e.maskObject,{gl:r}=this.renderer,i=e._stencilCounter;i===0&&(this.renderer.framebuffer.forceStencil(),r.clearStencil(0),r.clear(r.STENCIL_BUFFER_BIT),r.enable(r.STENCIL_TEST)),e._stencilCounter++;const n=e._colorMask;n!==0&&(e._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilFunc(r.EQUAL,i,4294967295),r.stencilOp(r.KEEP,r.KEEP,r.INCR),s.renderable=!0,s.render(this.renderer),this.renderer.batch.flush(),s.renderable=!1,n!==0&&(e._colorMask=n,r.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}pop(e){const s=this.renderer.gl;if(this.getStackLength()===0)s.disable(s.STENCIL_TEST);else{const r=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,i=r?r._colorMask:15;i!==0&&(r._colorMask=0,s.colorMask(!1,!1,!1,!1)),s.stencilOp(s.KEEP,s.KEEP,s.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,i!==0&&(r._colorMask=i,s.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)),this._useCurrent()}}_useCurrent(){const e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}xd.extension={type:$.RendererSystem,name:"stencil"};Q.add(xd);class Ad{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return xe("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract}},prepare:{enumerable:!1,get(){return xe("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare}},interaction:{enumerable:!1,get(){return xe("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events}}})}init(){const e=this.rendererPlugins;for(const s in e)this.plugins[s]=new e[s](this.renderer)}destroy(){for(const e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}Ad.extension={type:[$.RendererSystem,$.CanvasRendererSystem],name:"_plugin"};Q.add(Ad);class Td{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Xe,this.transform=null}update(e,s,r,i){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=s||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);const n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)}calculateProjection(e,s,r,i){const n=this.projectionMatrix,o=i?-1:1;n.identity(),n.a=1/s.width*2,n.d=o*(1/s.height*2),n.tx=-1-s.x*n.a,n.ty=-o-s.y*n.d}setTransform(e){}destroy(){this.renderer=null}}Td.extension={type:$.RendererSystem,name:"projection"};Q.add(Td);const e0=new nd,Iu=new Le;class wd{constructor(e){this.renderer=e,this._tempMatrix=new Xe}generateTexture(e,s){const{region:r,...i}=s||{},n=(r==null?void 0:r.copyTo(Iu))||e.getLocalBounds(Iu,!0),o=i.resolution||this.renderer.resolution;n.width=Math.max(n.width,1/o),n.height=Math.max(n.height,1/o),i.width=n.width,i.height=n.height,i.resolution=o,i.multisample??(i.multisample=this.renderer.multisample);const a=mo.create(i);this._tempMatrix.tx=-n.x,this._tempMatrix.ty=-n.y;const l=e.transform;return e.transform=e0,this.renderer.render(e,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=l,a}destroy(){}}wd.extension={type:[$.RendererSystem,$.CanvasRendererSystem],name:"textureGenerator"};Q.add(wd);const Os=new Le,si=new Le;class Ed{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Le,this.destinationFrame=new Le,this.viewportFrame=new Le}contextChange(){var s;const e=(s=this.renderer)==null?void 0:s.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,s,r){const i=this.renderer;this.current=e;let n,o,a;e?(n=e.baseTexture,a=n.resolution,s||(Os.width=e.frame.width,Os.height=e.frame.height,s=Os),r||(si.x=e.frame.x,si.y=e.frame.y,si.width=s.width,si.height=s.height,r=si),o=n.framebuffer):(a=i.resolution,s||(Os.width=i._view.screen.width,Os.height=i._view.screen.height,s=Os),r||(r=Os,r.width=s.width,r.height=s.height));const l=this.viewportFrame;l.x=r.x*a,l.y=r.y*a,l.width=r.width*a,l.height=r.height*a,e||(l.y=i.view.height-(l.y+l.height)),l.ceil(),this.renderer.framebuffer.bind(o,l),this.renderer.projection.update(r,s,a,!o),e?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(s),this.destinationFrame.copyFrom(r)}clear(e,s){const r=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,i=fo.shared.setValue(e||r);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&i.premultiply(i.alpha);const n=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=n.width!==o.width||n.height!==o.height;if(a){let{x:l,y:h,width:u,height:c}=this.viewportFrame;l=Math.round(l),h=Math.round(h),u=Math.round(u),c=Math.round(c),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(l,h,u,c)}this.renderer.framebuffer.clear(i.red,i.green,i.blue,i.alpha,s),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}Ed.extension={type:$.RendererSystem,name:"renderTexture"};Q.add(Ed);class t0{constructor(e,s){this.program=e,this.uniformData=s,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function s0(t,e){const s={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const n=e.getActiveAttrib(t,i);if(n.name.startsWith("gl_"))continue;const o=hd(e,n.type),a={type:o,name:n.name,size:ld(o),location:e.getAttribLocation(t,n.name)};s[n.name]=a}return s}function r0(t,e){const s={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<r;i++){const n=e.getActiveUniform(t,i),o=n.name.replace(/\[.*?\]$/,""),a=!!n.name.match(/\[.*?\]$/),l=hd(e,n.type);s[o]={name:o,index:i,type:l,size:n.size,isArray:a,value:od(l,n.size)}}return s}function i0(t,e){var a;const s=gu(t,t.VERTEX_SHADER,e.vertexSrc),r=gu(t,t.FRAGMENT_SHADER,e.fragmentSrc),i=t.createProgram();t.attachShader(i,s),t.attachShader(i,r);const n=(a=e.extra)==null?void 0:a.transformFeedbackVaryings;if(n&&(typeof t.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):t.transformFeedbackVaryings(i,n.names,n.bufferMode==="separate"?t.SEPARATE_ATTRIBS:t.INTERLEAVED_ATTRIBS)),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)||P_(t,i,s,r),e.attributeData=s0(i,t),e.uniformData=r0(i,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const l=Object.keys(e.attributeData);l.sort((h,u)=>h>u?1:-1);for(let h=0;h<l.length;h++)e.attributeData[l[h]].location=h,t.bindAttribLocation(i,h,l[h]);t.linkProgram(i)}t.deleteShader(s),t.deleteShader(r);const o={};for(const l in e.uniformData){const h=e.uniformData[l];o[l]={location:t.getUniformLocation(i,l),value:od(h.type,h.size)}}return new t0(i,o)}function n0(t,e,s,r,i){s.buffer.update(i)}const o0={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},Id={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function a0(t){const e=t.map(n=>({data:n,offset:0,dataLen:0,dirty:0}));let s=0,r=0,i=0;for(let n=0;n<e.length;n++){const o=e[n];if(s=Id[o.data.type],o.data.size>1&&(s=Math.max(s,16)*o.data.size),o.dataLen=s,r%s!==0&&r<16){const a=r%s%16;r+=a,i+=a}r+s>16?(i=Math.ceil(i/16)*16,o.offset=i,i+=s,r=s):(o.offset=i,r+=s,i+=s)}return i=Math.ceil(i/16)*16,{uboElements:e,size:i}}function l0(t,e){const s=[];for(const r in t)e[r]&&s.push(e[r]);return s.sort((r,i)=>r.index-i.index),s}function h0(t,e){if(!t.autoManage)return{size:0,syncFunc:n0};const s=l0(t.uniforms,e),{uboElements:r,size:i}=a0(s),n=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<r.length;o++){const a=r[o],l=t.uniforms[a.data.name],h=a.data.name;let u=!1;for(let c=0;c<Nr.length;c++){const d=Nr[c];if(d.codeUbo&&d.test(a.data,l)){n.push(`offset = ${a.offset/4};`,Nr[c].codeUbo(a.data.name,l)),u=!0;break}}if(!u)if(a.data.size>1){const c=ld(a.data.type),d=Math.max(Id[a.data.type]/16,1),p=c/d,_=(4-p%4)%4;n.push(`
                cv = ud.${h}.value;
                v = uv.${h};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*d}; i++)
                {
                    for(var j = 0; j < ${p}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${_};
                }

                `)}else{const c=o0[a.data.type];n.push(`
                cv = ud.${h}.value;
                v = uv.${h};
                offset = ${a.offset/4};
                ${c};
                `)}}return n.push(`
       renderer.buffer.update(buffer);
    `),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",n.join(`
`))}}let u0=0;const an={textureCount:0,uboCount:0};class Sd{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=u0++}systemCheck(){if(!O_())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,s){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;const r=e.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),s||(an.textureCount=0,an.uboCount=0,this.syncUniformGroup(e.uniformGroup,an)),i}setUniforms(e){const s=this.shader.program,r=s.glPrograms[this.renderer.CONTEXT_UID];s.syncUniforms(r.uniformData,e,this.renderer)}syncUniformGroup(e,s){const r=this.getGlProgram();(!e.static||e.dirtyId!==r.uniformDirtyGroups[e.id])&&(r.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,r,s))}syncUniforms(e,s,r){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(s.uniformData,e.uniforms,this.renderer,r)}createSyncGroups(e){const s=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[s]||(this.cache[s]=S_(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[s],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,s){const r=this.getGlProgram();if(!e.static||e.dirtyId!==0||!r.uniformGroups[e.id]){e.dirtyId=0;const i=r.uniformGroups[e.id]||this.createSyncBufferGroup(e,r,s);e.buffer.update(),i(r.uniformData,e.uniforms,this.renderer,an,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,r.uniformBufferBindings[s])}createSyncBufferGroup(e,s,r){const{gl:i}=this.renderer;this.renderer.buffer.bind(e.buffer);const n=this.gl.getUniformBlockIndex(s.program,r);s.uniformBufferBindings[r]=this.shader.uniformBindCount,i.uniformBlockBinding(s.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(e,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=h0(e,this.shader.program.uniformData)),e.autoManage){const l=new Float32Array(a.size/4);e.buffer.update(l)}return s.uniformGroups[e.id]=a.syncFunc,s.uniformGroups[e.id]}getSignature(e,s,r){const i=e.uniforms,n=[`${r}-`];for(const o in i)n.push(o),s[o]&&n.push(s[o].type);return n.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){const s=this.gl,r=e.program,i=i0(s,r);return r.glPrograms[this.renderer.CONTEXT_UID]=i,i}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}Sd.extension={type:$.RendererSystem,name:"shader"};Q.add(Sd);class Ln{constructor(e){this.renderer=e}run(e){const{renderer:s}=this;s.runners.init.emit(s.options),e.hello&&console.log(`PixiJS 7.3.2 - ${s.rendererLogId} - https://pixijs.com`),s.resize(s.screen.width,s.screen.height)}destroy(){}}Ln.defaultOptions={hello:!1},Ln.extension={type:[$.RendererSystem,$.CanvasRendererSystem],name:"startup"};Q.add(Ln);function c0(t,e=[]){return e[J.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[J.ADD]=[t.ONE,t.ONE],e[J.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[J.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[J.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[J.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[J.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[J.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[J.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[J.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[J.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[J.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[J.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[J.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[J.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[J.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[J.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[J.NONE]=[0,0],e[J.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[J.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[J.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[J.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[J.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[J.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[J.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[J.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[J.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[J.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[J.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[J.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}const d0=0,f0=1,p0=2,m0=3,y0=4,g0=5,Cd=class Va{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=J.NONE,this._blendEq=!1,this.map=[],this.map[d0]=this.setBlend,this.map[f0]=this.setOffset,this.map[p0]=this.setCullFace,this.map[m0]=this.setDepthTest,this.map[y0]=this.setFrontFace,this.map[g0]=this.setDepthMask,this.checks=[],this.defaultState=new Xr,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=c0(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let s=this.stateId^e.data,r=0;for(;s;)s&1&&this.map[r].call(this,!!(e.data&1<<r)),s=s>>1,r++;this.stateId=e.data}for(let s=0;s<this.checks.length;s++)this.checks[s](this,e)}forceState(e){e=e||this.defaultState;for(let s=0;s<this.map.length;s++)this.map[s].call(this,!!(e.data&1<<s));for(let s=0;s<this.checks.length;s++)this.checks[s](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(Va.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(Va.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const s=this.blendModes[e],r=this.gl;s.length===2?r.blendFunc(s[0],s[1]):r.blendFuncSeparate(s[0],s[1],s[2],s[3]),s.length===6?(this._blendEq=!0,r.blendEquationSeparate(s[4],s[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}setPolygonOffset(e,s){this.gl.polygonOffset(e,s)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,s){const r=this.checks.indexOf(e);s&&r===-1?this.checks.push(e):!s&&r!==-1&&this.checks.splice(r,1)}static checkBlendMode(e,s){e.setBlendMode(s.blendMode)}static checkPolygonOffset(e,s){e.setPolygonOffset(1,s.polygonOffset)}destroy(){this.gl=null}};Cd.extension={type:$.RendererSystem,name:"state"};let v0=Cd;Q.add(v0);class _0 extends Ss{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);const s=(e.priority??[]).filter(i=>e.systems[i]),r=[...s,...Object.keys(e.systems).filter(i=>!s.includes(i))];for(const i of r)this.addSystem(e.systems[i],i)}addRunners(...e){e.forEach(s=>{this.runners[s]=new Vt(s)})}addSystem(e,s){const r=new e(this);if(this[s])throw new Error(`Whoops! The name "${s}" is already in use`);this[s]=r,this._systemsHash[s]=r;for(const i in this.runners)this.runners[i].add(r);return this}emitWithCustomOptions(e,s){const r=Object.keys(this._systemsHash);e.items.forEach(i=>{const n=r.find(o=>this._systemsHash[o]===i);i[e.name](s[n])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}}const hi=class vn{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=vn.defaultMaxIdle,this.checkCountMax=vn.defaultCheckCountMax,this.mode=vn.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==vl.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,s=e.managedTextures;let r=!1;for(let i=0;i<s.length;i++){const n=s[i];n.resource&&this.count-n.touched>this.maxIdle&&(e.destroyTexture(n,!0),s[i]=null,r=!0)}if(r){let i=0;for(let n=0;n<s.length;n++)s[n]!==null&&(s[i++]=s[n]);s.length=i}}unload(e){const s=this.renderer.texture,r=e._texture;r&&!r.framebuffer&&s.destroyTexture(r);for(let i=e.children.length-1;i>=0;i--)this.unload(e.children[i])}destroy(){this.renderer=null}};hi.defaultMode=vl.AUTO,hi.defaultMaxIdle=60*60,hi.defaultCheckCountMax=60*10,hi.extension={type:$.RendererSystem,name:"textureGC"};let Ds=hi;Q.add(Ds);class Zo{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=he.UNSIGNED_BYTE,this.internalFormat=L.RGBA,this.samplerType=0}}function b0(t){let e;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?e={[t.RGB]:U.FLOAT,[t.RGBA]:U.FLOAT,[t.ALPHA]:U.FLOAT,[t.LUMINANCE]:U.FLOAT,[t.LUMINANCE_ALPHA]:U.FLOAT,[t.R8]:U.FLOAT,[t.R8_SNORM]:U.FLOAT,[t.RG8]:U.FLOAT,[t.RG8_SNORM]:U.FLOAT,[t.RGB8]:U.FLOAT,[t.RGB8_SNORM]:U.FLOAT,[t.RGB565]:U.FLOAT,[t.RGBA4]:U.FLOAT,[t.RGB5_A1]:U.FLOAT,[t.RGBA8]:U.FLOAT,[t.RGBA8_SNORM]:U.FLOAT,[t.RGB10_A2]:U.FLOAT,[t.RGB10_A2UI]:U.FLOAT,[t.SRGB8]:U.FLOAT,[t.SRGB8_ALPHA8]:U.FLOAT,[t.R16F]:U.FLOAT,[t.RG16F]:U.FLOAT,[t.RGB16F]:U.FLOAT,[t.RGBA16F]:U.FLOAT,[t.R32F]:U.FLOAT,[t.RG32F]:U.FLOAT,[t.RGB32F]:U.FLOAT,[t.RGBA32F]:U.FLOAT,[t.R11F_G11F_B10F]:U.FLOAT,[t.RGB9_E5]:U.FLOAT,[t.R8I]:U.INT,[t.R8UI]:U.UINT,[t.R16I]:U.INT,[t.R16UI]:U.UINT,[t.R32I]:U.INT,[t.R32UI]:U.UINT,[t.RG8I]:U.INT,[t.RG8UI]:U.UINT,[t.RG16I]:U.INT,[t.RG16UI]:U.UINT,[t.RG32I]:U.INT,[t.RG32UI]:U.UINT,[t.RGB8I]:U.INT,[t.RGB8UI]:U.UINT,[t.RGB16I]:U.INT,[t.RGB16UI]:U.UINT,[t.RGB32I]:U.INT,[t.RGB32UI]:U.UINT,[t.RGBA8I]:U.INT,[t.RGBA8UI]:U.UINT,[t.RGBA16I]:U.INT,[t.RGBA16UI]:U.UINT,[t.RGBA32I]:U.INT,[t.RGBA32UI]:U.UINT,[t.DEPTH_COMPONENT16]:U.FLOAT,[t.DEPTH_COMPONENT24]:U.FLOAT,[t.DEPTH_COMPONENT32F]:U.FLOAT,[t.DEPTH_STENCIL]:U.FLOAT,[t.DEPTH24_STENCIL8]:U.FLOAT,[t.DEPTH32F_STENCIL8]:U.FLOAT}:e={[t.RGB]:U.FLOAT,[t.RGBA]:U.FLOAT,[t.ALPHA]:U.FLOAT,[t.LUMINANCE]:U.FLOAT,[t.LUMINANCE_ALPHA]:U.FLOAT,[t.DEPTH_STENCIL]:U.FLOAT},e}function x0(t){let e;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?e={[he.UNSIGNED_BYTE]:{[L.RGBA]:t.RGBA8,[L.RGB]:t.RGB8,[L.RG]:t.RG8,[L.RED]:t.R8,[L.RGBA_INTEGER]:t.RGBA8UI,[L.RGB_INTEGER]:t.RGB8UI,[L.RG_INTEGER]:t.RG8UI,[L.RED_INTEGER]:t.R8UI,[L.ALPHA]:t.ALPHA,[L.LUMINANCE]:t.LUMINANCE,[L.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[he.BYTE]:{[L.RGBA]:t.RGBA8_SNORM,[L.RGB]:t.RGB8_SNORM,[L.RG]:t.RG8_SNORM,[L.RED]:t.R8_SNORM,[L.RGBA_INTEGER]:t.RGBA8I,[L.RGB_INTEGER]:t.RGB8I,[L.RG_INTEGER]:t.RG8I,[L.RED_INTEGER]:t.R8I},[he.UNSIGNED_SHORT]:{[L.RGBA_INTEGER]:t.RGBA16UI,[L.RGB_INTEGER]:t.RGB16UI,[L.RG_INTEGER]:t.RG16UI,[L.RED_INTEGER]:t.R16UI,[L.DEPTH_COMPONENT]:t.DEPTH_COMPONENT16},[he.SHORT]:{[L.RGBA_INTEGER]:t.RGBA16I,[L.RGB_INTEGER]:t.RGB16I,[L.RG_INTEGER]:t.RG16I,[L.RED_INTEGER]:t.R16I},[he.UNSIGNED_INT]:{[L.RGBA_INTEGER]:t.RGBA32UI,[L.RGB_INTEGER]:t.RGB32UI,[L.RG_INTEGER]:t.RG32UI,[L.RED_INTEGER]:t.R32UI,[L.DEPTH_COMPONENT]:t.DEPTH_COMPONENT24},[he.INT]:{[L.RGBA_INTEGER]:t.RGBA32I,[L.RGB_INTEGER]:t.RGB32I,[L.RG_INTEGER]:t.RG32I,[L.RED_INTEGER]:t.R32I},[he.FLOAT]:{[L.RGBA]:t.RGBA32F,[L.RGB]:t.RGB32F,[L.RG]:t.RG32F,[L.RED]:t.R32F,[L.DEPTH_COMPONENT]:t.DEPTH_COMPONENT32F},[he.HALF_FLOAT]:{[L.RGBA]:t.RGBA16F,[L.RGB]:t.RGB16F,[L.RG]:t.RG16F,[L.RED]:t.R16F},[he.UNSIGNED_SHORT_5_6_5]:{[L.RGB]:t.RGB565},[he.UNSIGNED_SHORT_4_4_4_4]:{[L.RGBA]:t.RGBA4},[he.UNSIGNED_SHORT_5_5_5_1]:{[L.RGBA]:t.RGB5_A1},[he.UNSIGNED_INT_2_10_10_10_REV]:{[L.RGBA]:t.RGB10_A2,[L.RGBA_INTEGER]:t.RGB10_A2UI},[he.UNSIGNED_INT_10F_11F_11F_REV]:{[L.RGB]:t.R11F_G11F_B10F},[he.UNSIGNED_INT_5_9_9_9_REV]:{[L.RGB]:t.RGB9_E5},[he.UNSIGNED_INT_24_8]:{[L.DEPTH_STENCIL]:t.DEPTH24_STENCIL8},[he.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[L.DEPTH_STENCIL]:t.DEPTH32F_STENCIL8}}:e={[he.UNSIGNED_BYTE]:{[L.RGBA]:t.RGBA,[L.RGB]:t.RGB,[L.ALPHA]:t.ALPHA,[L.LUMINANCE]:t.LUMINANCE,[L.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[he.UNSIGNED_SHORT_5_6_5]:{[L.RGB]:t.RGB},[he.UNSIGNED_SHORT_4_4_4_4]:{[L.RGBA]:t.RGBA},[he.UNSIGNED_SHORT_5_5_5_1]:{[L.RGBA]:t.RGBA}},e}class Rd{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new ve,this.hasIntegerTextures=!1}contextChange(){const e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=x0(e),this.samplerTypes=b0(e);const s=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=s;for(let i=0;i<s;i++)this.boundTextures[i]=null;this.emptyTextures={};const r=new Zo(e.createTexture());e.bindTexture(e.TEXTURE_2D,r.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=r,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new Zo(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let i=0;i<6;i++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let i=0;i<this.boundTextures.length;i++)this.bind(null,i)}bind(e,s=0){const{gl:r}=this;if(e=e==null?void 0:e.castToBaseTexture(),(e==null?void 0:e.valid)&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;const i=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[s]!==e&&(this.currentLocation!==s&&(this.currentLocation=s,r.activeTexture(r.TEXTURE0+s)),r.bindTexture(e.target,i.texture)),i.dirtyId!==e.dirtyId?(this.currentLocation!==s&&(this.currentLocation=s,r.activeTexture(r.TEXTURE0+s)),this.updateTexture(e)):i.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[s]=e}else this.currentLocation!==s&&(this.currentLocation=s,r.activeTexture(r.TEXTURE0+s)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[s]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){const{gl:s,boundTextures:r}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let i=0;i<r.length;i++)r[i]===this.unknownTexture&&this.bind(null,i)}for(let i=0;i<r.length;i++)r[i]===e&&(this.currentLocation!==i&&(s.activeTexture(s.TEXTURE0+i),this.currentLocation=i),s.bindTexture(e.target,this.emptyTextures[e.target].texture),r[i]=null)}ensureSamplerType(e){const{boundTextures:s,hasIntegerTextures:r,CONTEXT_UID:i}=this;if(r)for(let n=e-1;n>=0;--n){const o=s[n];o&&o._glTextures[i].samplerType!==U.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(e){const s=new Zo(this.gl.createTexture());return s.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=s,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),s}initTextureType(e,s){var r;s.internalFormat=((r=this.internalFormats[e.type])==null?void 0:r[e.format])??e.format,s.samplerType=this.samplerTypes[s.internalFormat]??U.FLOAT,this.webGLVersion===2&&e.type===he.HALF_FLOAT?s.type=this.gl.HALF_FLOAT:s.type=e.type}updateTexture(e){var i;const s=e._glTextures[this.CONTEXT_UID];if(!s)return;const r=this.renderer;if(this.initTextureType(e,s),(i=e.resource)==null?void 0:i.upload(r,e,s))s.samplerType!==U.FLOAT&&(this.hasIntegerTextures=!0);else{const n=e.realWidth,o=e.realHeight,a=r.gl;(s.width!==n||s.height!==o||s.dirtyId<0)&&(s.width=n,s.height=o,a.texImage2D(e.target,0,s.internalFormat,n,o,0,e.format,s.type,null))}e.dirtyStyleId!==s.dirtyStyleId&&this.updateTextureStyle(e),s.dirtyId=e.dirtyId}destroyTexture(e,s){const{gl:r}=this;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),r.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!s)){const i=this.managedTextures.indexOf(e);i!==-1&&o_(this.managedTextures,i,1)}}updateTextureStyle(e){var r;const s=e._glTextures[this.CONTEXT_UID];s&&((e.mipmap===sr.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?s.mipmap=!1:s.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?s.wrapMode=gl.CLAMP:s.wrapMode=e.wrapMode,(r=e.resource)!=null&&r.style(this.renderer,e,s)||this.setStyle(e,s),s.dirtyStyleId=e.dirtyStyleId)}setStyle(e,s){const r=this.gl;if(s.mipmap&&e.mipmap!==sr.ON_MANUAL&&r.generateMipmap(e.target),r.texParameteri(e.target,r.TEXTURE_WRAP_S,s.wrapMode),r.texParameteri(e.target,r.TEXTURE_WRAP_T,s.wrapMode),s.mipmap){r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===hs.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);const i=this.renderer.context.extensions.anisotropicFiltering;if(i&&e.anisotropicLevel>0&&e.scaleMode===hs.LINEAR){const n=Math.min(e.anisotropicLevel,r.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(e.target,i.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===hs.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(e.target,r.TEXTURE_MAG_FILTER,e.scaleMode===hs.LINEAR?r.LINEAR:r.NEAREST)}destroy(){this.renderer=null}}Rd.extension={type:$.RendererSystem,name:"texture"};Q.add(Rd);class Pd{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:s,CONTEXT_UID:r}=this,i=e._glTransformFeedbacks[r]||this.createGLTransformFeedback(e);s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,i)}unbind(){const{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,s){const{gl:r,renderer:i}=this;s&&i.shader.bind(s),r.beginTransformFeedback(e)}endTransformFeedback(){const{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){const{gl:s,renderer:r,CONTEXT_UID:i}=this,n=s.createTransformFeedback();e._glTransformFeedbacks[i]=n,s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,n);for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];a&&(r.buffer.update(a),a._glBuffers[i].refCount++,s.bindBufferBase(s.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[i].buffer||null))}return s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),n}disposeTransformFeedback(e,s){const r=e._glTransformFeedbacks[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this);const n=this.renderer.buffer;if(n)for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];if(!a)continue;const l=a._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!s&&n.dispose(a,s))}r&&(s||i.deleteTransformFeedback(r),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}Pd.extension={type:$.RendererSystem,name:"transformFeedback"};Q.add(Pd);class kn{constructor(e){this.renderer=e}init(e){this.screen=new Le(0,0,e.width,e.height),this.element=e.view||ne.ADAPTER.createCanvas(),this.resolution=e.resolution||ne.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,s){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(s*this.resolution);const r=this.element.width/this.resolution,i=this.element.height/this.resolution;this.screen.width=r,this.screen.height=i,this.autoDensity&&(this.element.style.width=`${r}px`,this.element.style.height=`${i}px`),this.renderer.emit("resize",r,i),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){var s;e&&((s=this.element.parentNode)==null||s.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}kn.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},kn.extension={type:[$.RendererSystem,$.CanvasRendererSystem],name:"_view"};Q.add(kn);ne.PREFER_ENV=ir.WEBGL2;ne.STRICT_TEXTURE_CACHE=!1;ne.RENDER_OPTIONS={...Bn.defaultOptions,...Nn.defaultOptions,...kn.defaultOptions,...Ln.defaultOptions};Object.defineProperties(ne,{WRAP_MODE:{get(){return ve.defaultOptions.wrapMode},set(t){xe("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),ve.defaultOptions.wrapMode=t}},SCALE_MODE:{get(){return ve.defaultOptions.scaleMode},set(t){xe("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),ve.defaultOptions.scaleMode=t}},MIPMAP_TEXTURES:{get(){return ve.defaultOptions.mipmap},set(t){xe("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),ve.defaultOptions.mipmap=t}},ANISOTROPIC_LEVEL:{get(){return ve.defaultOptions.anisotropicLevel},set(t){xe("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),ve.defaultOptions.anisotropicLevel=t}},FILTER_RESOLUTION:{get(){return xe("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),wr.defaultResolution},set(t){wr.defaultResolution=t}},FILTER_MULTISAMPLE:{get(){return xe("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),wr.defaultMultisample},set(t){wr.defaultMultisample=t}},SPRITE_MAX_TEXTURES:{get(){return Us.defaultMaxTextures},set(t){xe("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),Us.defaultMaxTextures=t}},SPRITE_BATCH_SIZE:{get(){return Us.defaultBatchSize},set(t){xe("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),Us.defaultBatchSize=t}},CAN_UPLOAD_SAME_BUFFER:{get(){return Us.canUploadSameBuffer},set(t){xe("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),Us.canUploadSameBuffer=t}},GC_MODE:{get(){return Ds.defaultMode},set(t){xe("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),Ds.defaultMode=t}},GC_MAX_IDLE:{get(){return Ds.defaultMaxIdle},set(t){xe("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),Ds.defaultMaxIdle=t}},GC_MAX_CHECK_COUNT:{get(){return Ds.defaultCheckCountMax},set(t){xe("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),Ds.defaultCheckCountMax=t}},PRECISION_VERTEX:{get(){return Xs.defaultVertexPrecision},set(t){xe("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Xs.defaultVertexPrecision=t}},PRECISION_FRAGMENT:{get(){return Xs.defaultFragmentPrecision},set(t){xe("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Xs.defaultFragmentPrecision=t}}});var Un=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(Un||{});class Qo{constructor(e,s=null,r=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=s,this.priority=r,this.once=i}match(e,s=null){return this.fn===e&&this.context===s}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));const s=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),s}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const s=this.next;return this.next=e?null:s,this.previous=null,s}}const Fd=class vt{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Qo(null,null,1/0),this.deltaMS=1/vt.targetFPMS,this.elapsedMS=1/vt.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,s,r=Un.NORMAL){return this._addListener(new Qo(e,s,r))}addOnce(e,s,r=Un.NORMAL){return this._addListener(new Qo(e,s,r,!0))}_addListener(e){let s=this._head.next,r=this._head;if(!s)e.connect(r);else{for(;s;){if(e.priority>s.priority){e.connect(r);break}r=s,s=s.next}e.previous||e.connect(r)}return this._startIfPossible(),this}remove(e,s){let r=this._head.next;for(;r;)r.match(e,s)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,s=this._head;for(;s=s.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let s;if(e>this.lastTime){if(s=this.elapsedMS=e-this.lastTime,s>this._maxElapsedMS&&(s=this._maxElapsedMS),s*=this.speed,this._minElapsedMS){const n=e-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=e-n%this._minElapsedMS}this.deltaMS=s,this.deltaTime=this.deltaMS*vt.targetFPMS;const r=this._head;let i=r.next;for(;i;)i=i.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const s=Math.min(this.maxFPS,e),r=Math.min(Math.max(0,s)/1e3,vt.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const s=Math.max(this.minFPS,e);this._minElapsedMS=1/(s/1e3)}}static get shared(){if(!vt._shared){const e=vt._shared=new vt;e.autoStart=!0,e._protected=!0}return vt._shared}static get system(){if(!vt._system){const e=vt._system=new vt;e.autoStart=!0,e._protected=!0}return vt._system}};Fd.targetFPMS=.06;let At=Fd;Object.defineProperties(ne,{TARGET_FPMS:{get(){return At.targetFPMS},set(t){xe("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),At.targetFPMS=t}}});class Od{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(s){this._ticker&&this._ticker.remove(this.render,this),this._ticker=s,s&&s.add(this.render,this,Un.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?At.shared:new At,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}Od.extension=$.Application;Q.add(Od);const A0=[];Q.handleByList($.Renderer,A0);class Md{constructor(e){this.renderer=e}contextChange(e){let s;if(this.renderer.context.webGLVersion===1){const r=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),s=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,r)}else{const r=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),s=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,r)}s>=De.HIGH?this.multisample=De.HIGH:s>=De.MEDIUM?this.multisample=De.MEDIUM:s>=De.LOW?this.multisample=De.LOW:this.multisample=De.NONE}destroy(){}}Md.extension={type:$.RendererSystem,name:"_multisample"};Q.add(Md);class T0{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class Nd{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:s,CONTEXT_UID:r}=this,i=e._glBuffers[r]||this.createGLBuffer(e);s.bindBuffer(e.type,i.buffer)}unbind(e){const{gl:s}=this;s.bindBuffer(e,null)}bindBufferBase(e,s){const{gl:r,CONTEXT_UID:i}=this;if(this.boundBufferBases[s]!==e){const n=e._glBuffers[i]||this.createGLBuffer(e);this.boundBufferBases[s]=e,r.bindBufferBase(r.UNIFORM_BUFFER,s,n.buffer)}}bindBufferRange(e,s,r){const{gl:i,CONTEXT_UID:n}=this;r=r||0;const o=e._glBuffers[n]||this.createGLBuffer(e);i.bindBufferRange(i.UNIFORM_BUFFER,s||0,o.buffer,r*256,256)}update(e){const{gl:s,CONTEXT_UID:r}=this,i=e._glBuffers[r]||this.createGLBuffer(e);if(e._updateID!==i.updateID)if(i.updateID=e._updateID,s.bindBuffer(e.type,i.buffer),i.byteLength>=e.data.byteLength)s.bufferSubData(e.type,0,e.data);else{const n=e.static?s.STATIC_DRAW:s.DYNAMIC_DRAW;i.byteLength=e.data.byteLength,s.bufferData(e.type,e.data,n)}}dispose(e,s){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];const r=e._glBuffers[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this),r&&(s||i.deleteBuffer(r.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){const s=Object.keys(this.managedBuffers);for(let r=0;r<s.length;r++)this.dispose(this.managedBuffers[s[r]],e)}createGLBuffer(e){const{CONTEXT_UID:s,gl:r}=this;return e._glBuffers[s]=new T0(r.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[s]}}Nd.extension={type:$.RendererSystem,name:"buffer"};Q.add(Nd);class Bd{constructor(e){this.renderer=e}render(e,s){const r=this.renderer;let i,n,o,a;if(s&&(i=s.renderTexture,n=s.clear,o=s.transform,a=s.skipUpdateTransform),this.renderingToScreen=!i,r.runners.prerender.emit(),r.emit("prerender"),r.projection.transform=o,!r.context.isLost){if(i||(this.lastObjectRendered=e),!a){const l=e.enableTempParent();e.updateTransform(),e.disableTempParent(l)}r.renderTexture.bind(i),r.batch.currentRenderer.start(),(n??r.background.clearBeforeRender)&&r.renderTexture.clear(),e.render(r),r.batch.currentRenderer.flush(),i&&(s.blit&&r.framebuffer.blit(),i.baseTexture.update()),r.runners.postrender.emit(),r.projection.transform=null,r.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}Bd.extension={type:$.RendererSystem,name:"objectRenderer"};Q.add(Bd);const _n=class qa extends _0{constructor(e){super(),this.type=Sc.WEBGL,e=Object.assign({},ne.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new ts({projectionMatrix:new Xe},!0);const s={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:qa.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(s),"useContextAlpha"in e&&(xe("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha),this._plugin.rendererPlugins=qa.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return e!=null&&e.forceCanvas?!1:Xv()}render(e,s){this.objectRenderer.render(e,s)}resize(e,s){this._view.resizeView(e,s)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return xe("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return xe("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return xe("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return xe("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){xe("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return xe("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){xe("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return xe("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,s){return this.textureGenerator.generateTexture(e,s)}};_n.extension={type:$.Renderer,priority:1},_n.__plugins={},_n.__systems={};let Cl=_n;Q.handleByMap($.RendererPlugin,Cl.__plugins);Q.handleByMap($.RendererSystem,Cl.__systems);Q.add(Cl);class Ld extends Oi{constructor(e,s){const{width:r,height:i}=s||{};super(r,i),this.items=[],this.itemDirtyIds=[];for(let n=0;n<e;n++){const o=new ve;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,s){for(let r=0;r<this.length;r++)e[r]&&(e[r].castToBaseTexture?this.addBaseTextureAt(e[r].castToBaseTexture(),r):e[r]instanceof Oi?this.addResourceAt(e[r],r):this.addResourceAt(td(e[r],s),r))}dispose(){for(let e=0,s=this.length;e<s;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,s){if(!this.items[s])throw new Error(`Index ${s} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[s].setResource(e),this}bind(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let s=0;s<this.length;s++)this.items[s].parentTextureArray=e,this.items[s].on("update",e.update,e)}unbind(e){super.unbind(e);for(let s=0;s<this.length;s++)this.items[s].parentTextureArray=null,this.items[s].off("update",e.update,e)}load(){if(this._load)return this._load;const e=this.items.map(s=>s.resource).filter(s=>s).map(s=>s.load());return this._load=Promise.all(e).then(()=>{const{realWidth:s,realHeight:r}=this.items[0];return this.resize(s,r),this.update(),Promise.resolve(this)}),this._load}}class w0 extends Ld{constructor(e,s){const{width:r,height:i}=s||{};let n,o;Array.isArray(e)?(n=e,o=e.length):o=e,super(o,{width:r,height:i}),n&&this.initFromArray(n,s)}addBaseTextureAt(e,s){if(e.resource)this.addResourceAt(e.resource,s);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(e){super.bind(e),e.target=Fr.TEXTURE_2D_ARRAY}upload(e,s,r){const{length:i,itemDirtyIds:n,items:o}=this,{gl:a}=e;r.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,r.internalFormat,this._width,this._height,i,0,s.format,r.type,null);for(let l=0;l<i;l++){const h=o[l];n[l]<h.dirtyId&&(n[l]=h.dirtyId,h.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,l,h.resource.width,h.resource.height,1,s.format,r.type,h.resource.source))}return!0}}class E0 extends Is{constructor(e){super(e)}static test(e){const{OffscreenCanvas:s}=globalThis;return s&&e instanceof s?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}}const kd=class ui extends Ld{constructor(e,s){const{width:r,height:i,autoLoad:n,linkBaseTexture:o}=s||{};if(e&&e.length!==ui.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:r,height:i});for(let a=0;a<ui.SIDES;a++)this.items[a].target=Fr.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=o!==!1,e&&this.initFromArray(e,s),n!==!1&&this.load()}bind(e){super.bind(e),e.target=Fr.TEXTURE_CUBE_MAP}addBaseTextureAt(e,s,r){if(r===void 0&&(r=this.linkBaseTexture),!this.items[s])throw new Error(`Index ${s} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,s);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=Fr.TEXTURE_CUBE_MAP_POSITIVE_X+s,e.parentTextureArray=this.baseTexture,this.items[s]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[s]=e,this}upload(e,s,r){const i=this.itemDirtyIds;for(let n=0;n<ui.SIDES;n++){const o=this.items[n];(i[n]<o.dirtyId||r.dirtyId<s.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(e,o,r),i[n]=o.dirtyId):i[n]<-1&&(e.gl.texImage2D(o.target,0,r.internalFormat,s.realWidth,s.realHeight,0,s.format,r.type,null),i[n]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===ui.SIDES}};kd.SIDES=6;let I0=kd;class Er extends Is{constructor(e,s){s=s||{};let r,i,n;typeof e=="string"?(r=Er.EMPTY,i=e,n=!0):(r=e,i=null,n=!1),super(r),this.url=i,this.crossOrigin=s.crossOrigin??!0,this.alphaMode=typeof s.alphaMode=="number"?s.alphaMode:null,this.ownsImageBitmap=s.ownsImageBitmap??n,this._load=null,s.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(e,s)=>{if(this.url===null){e(this);return}try{const r=await ne.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const i=await r.blob();if(this.destroyed)return;const n=await createImageBitmap(i,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Gt.UNPACK?"premultiply":"none"});if(this.destroyed){n.close();return}this.source=n,this.update(),e(this)}catch(r){if(this.destroyed)return;s(r),this.onError.emit(r)}}),this._load)}upload(e,s,r){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(s.alphaMode=this.alphaMode),super.upload(e,s,r)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof e=="string"||e instanceof ImageBitmap)}static get EMPTY(){return Er._EMPTY=Er._EMPTY??ne.ADAPTER.createCanvas(0,0),Er._EMPTY}}const Wa=class bn extends Is{constructor(e,s){s=s||{},super(ne.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=s.scale||1,this._overrideWidth=s.width,this._overrideHeight=s.height,this._resolve=null,this._crossorigin=s.crossorigin,this._load=null,s.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.update(),e(this)},bn.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const e=new Image;Is.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=s=>{this._resolve&&(e.onerror=null,this.onError.emit(s))},e.onload=()=>{if(!this._resolve)return;const s=e.width,r=e.height;if(!s||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let i=s*this.scale,n=r*this.scale;(this._overrideWidth||this._overrideHeight)&&(i=this._overrideWidth||this._overrideHeight/r*s,n=this._overrideHeight||this._overrideWidth/s*r),i=Math.round(i),n=Math.round(n);const o=this.source;o.width=i,o.height=n,o._pixiId=`canvas_${Pi()}`,o.getContext("2d").drawImage(e,0,0,s,r,0,0,i,n),this._resolve(),this._resolve=null}}static getSize(e){const s=bn.SVG_SIZE.exec(e),r={};return s&&(r[s[1]]=Math.round(parseFloat(s[3])),r[s[5]]=Math.round(parseFloat(s[7]))),r}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,s){return s==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&bn.SVG_XML.test(e)}};Wa.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,Wa.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let ja=Wa;const za=class Xa extends Is{constructor(e,s){if(s=s||{},!(e instanceof HTMLVideoElement)){const r=document.createElement("video");s.autoLoad!==!1&&r.setAttribute("preload","auto"),s.playsinline!==!1&&(r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline","")),s.muted===!0&&(r.setAttribute("muted",""),r.muted=!0),s.loop===!0&&r.setAttribute("loop",""),s.autoPlay!==!1&&r.setAttribute("autoplay",""),typeof e=="string"&&(e=[e]);const i=e[0].src||e[0];Is.crossOrigin(r,i,s.crossorigin);for(let n=0;n<e.length;++n){const o=document.createElement("source");let{src:a,mime:l}=e[n];if(a=a||e[n],a.startsWith("data:"))l=a.slice(5,a.indexOf(";"));else if(!a.startsWith("blob:")){const h=a.split("?").shift().toLowerCase(),u=h.slice(h.lastIndexOf(".")+1);l=l||Xa.MIME_TYPES[u]||`video/${u}`}o.src=a,l&&(o.type=l),r.appendChild(o)}e=r}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=s.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=s.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),s.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){if(this._updateFPS){const s=At.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-s)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((s,r)=>{this.valid?s(this):(this._resolve=s,this._reject=r,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const s=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!s&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._configureAutoUpdate();const e=this.source;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(At.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(At.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(At.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e,s){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||Xa.TYPES.includes(s)}};za.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],za.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let Ud=za;La.push(Er,fd,E0,Ud,ja,sd,I0,w0);let S0=0;const Ka=class extends Ss{constructor(t){super(),this.id=S0++,this.init(t)}set(t,e){if(this[t]===void 0)throw new Error(`Property with name ${t} does not exist.`);switch(t){case"speed":this.speed=e;break;case"volume":this.volume=e;break;case"paused":this.paused=e;break;case"loop":this.loop=e;break;case"muted":this.muted=e;break}return this}get progress(){const{currentTime:t}=this._source;return t/this._duration}get paused(){return this._paused}set paused(t){this._paused=t,this.refreshPaused()}_onPlay(){this._playing=!0}_onPause(){this._playing=!1}init(t){this._playing=!1,this._duration=t.source.duration;const e=this._source=t.source.cloneNode(!1);e.src=t.parent.url,e.onplay=this._onPlay.bind(this),e.onpause=this._onPause.bind(this),t.context.on("refresh",this.refresh,this),t.context.on("refreshPaused",this.refreshPaused,this),this._media=t}_internalStop(){this._source&&this._playing&&(this._source.onended=null,this._source.pause())}stop(){this._internalStop(),this._source&&this.emit("stop")}get speed(){return this._speed}set speed(t){this._speed=t,this.refresh()}get volume(){return this._volume}set volume(t){this._volume=t,this.refresh()}get loop(){return this._loop}set loop(t){this._loop=t,this.refresh()}get muted(){return this._muted}set muted(t){this._muted=t,this.refresh()}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(t){console.warn("HTML Audio does not support filters")}refresh(){const t=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;const s=t.volume*(t.muted?0:1),r=e.volume*(e.muted?0:1),i=this._volume*(this._muted?0:1);this._source.volume=i*s*r,this._source.playbackRate=this._speed*t.speed*e.speed}refreshPaused(){const t=this._media.context,e=this._media.parent,s=this._paused||e.paused||t.paused;s!==this._pausedReal&&(this._pausedReal=s,s?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._source.currentTime,end:this._end,volume:this._volume,speed:this._speed,loop:this._loop})),this.emit("pause",s))}play(t){const{start:e,end:s,speed:r,loop:i,volume:n,muted:o}=t;s&&console.assert(s>e,"End time is before start time"),this._speed=r,this._volume=n,this._loop=!!i,this._muted=o,this.refresh(),this.loop&&s!==null&&(console.warn('Looping not support when specifying an "end" time'),this.loop=!1),this._start=e,this._end=s||this._duration,this._start=Math.max(0,this._start-Ka.PADDING),this._end=Math.min(this._end+Ka.PADDING,this._duration),this._source.onloadedmetadata=()=>{this._source&&(this._source.currentTime=e,this._source.onloadedmetadata=null,this.emit("progress",e,this._duration),At.shared.add(this._onUpdate,this))},this._source.onended=this._onComplete.bind(this),this._source.play(),this.emit("start")}_onUpdate(){this.emit("progress",this.progress,this._duration),this._source.currentTime>=this._end&&!this._source.loop&&this._onComplete()}_onComplete(){At.shared.remove(this._onUpdate,this),this._internalStop(),this.emit("progress",1,this._duration),this.emit("end",this)}destroy(){At.shared.remove(this._onUpdate,this),this.removeAllListeners();const t=this._source;t&&(t.onended=null,t.onplay=null,t.onpause=null,this._internalStop()),this._source=null,this._speed=1,this._volume=1,this._loop=!1,this._end=null,this._start=0,this._duration=0,this._playing=!1,this._pausedReal=!1,this._paused=!1,this._muted=!1,this._media&&(this._media.context.off("refresh",this.refresh,this),this._media.context.off("refreshPaused",this.refreshPaused,this),this._media=null)}toString(){return`[HTMLAudioInstance id=${this.id}]`}};let Dd=Ka;Dd.PADDING=.1;class C0 extends Ss{init(e){this.parent=e,this._source=e.options.source||new Audio,e.url&&(this._source.src=e.url)}create(){return new Dd(this)}get isPlayable(){return!!this._source&&this._source.readyState===4}get duration(){return this._source.duration}get context(){return this.parent.context}get filters(){return null}set filters(e){console.warn("HTML Audio does not support filters")}destroy(){this.removeAllListeners(),this.parent=null,this._source&&(this._source.src="",this._source.load(),this._source=null)}get source(){return this._source}load(e){const s=this._source,r=this.parent;if(s.readyState===4){r.isLoaded=!0;const l=r.autoPlayStart();e&&setTimeout(()=>{e(null,r,l)},0);return}if(!r.url){e(new Error("sound.url or sound.source must be set"));return}s.src=r.url;const i=()=>{a(),r.isLoaded=!0;const l=r.autoPlayStart();e&&e(null,r,l)},n=()=>{a(),e&&e(new Error("Sound loading has been aborted"))},o=()=>{a();const l=`Failed to load audio element (code: ${s.error.code})`;e?e(new Error(l)):console.error(l)},a=()=>{s.removeEventListener("canplaythrough",i),s.removeEventListener("load",i),s.removeEventListener("abort",n),s.removeEventListener("error",o)};s.addEventListener("canplaythrough",i,!1),s.addEventListener("load",i,!1),s.addEventListener("abort",n,!1),s.addEventListener("error",o,!1),s.load()}}class R0{constructor(e,s){this.parent=e,Object.assign(this,s),this.duration=this.end-this.start,console.assert(this.duration>0,"End time must be after start time")}play(e){return this.parent.play({complete:e,speed:this.speed||this.parent.speed,end:this.end,start:this.start,loop:this.loop})}destroy(){this.parent=null}}const Dn=["ogg","oga","opus","m4a","mp3","mpeg","wav","aiff","wma","mid","caf"],P0=["audio/mpeg","audio/ogg"],Gn={};function F0(t){const e={m4a:"audio/mp4",oga:"audio/ogg",opus:'audio/ogg; codecs="opus"',caf:'audio/x-caf; codecs="opus"',...t||{}},s=document.createElement("audio"),r={},i=/^no$/;Dn.forEach(n=>{const o=s.canPlayType(`audio/${n}`).replace(i,""),a=e[n]?s.canPlayType(e[n]).replace(i,""):"";r[n]=!!o||!!a}),Object.assign(Gn,r)}F0();class Za{static setParamValue(e,s){if(e.setValueAtTime){const r=Ii().context;e.setValueAtTime(s,r.audioContext.currentTime)}else e.value=s;return s}}let O0=0;class M0 extends Ss{constructor(e){super(),this.id=O0++,this._media=null,this._paused=!1,this._muted=!1,this._elapsed=0,this.init(e)}set(e,s){if(this[e]===void 0)throw new Error(`Property with name ${e} does not exist.`);switch(e){case"speed":this.speed=s;break;case"volume":this.volume=s;break;case"muted":this.muted=s;break;case"loop":this.loop=s;break;case"paused":this.paused=s;break}return this}stop(){this._source&&(this._internalStop(),this.emit("stop"))}get speed(){return this._speed}set speed(e){this._speed=e,this.refresh(),this._update(!0)}get volume(){return this._volume}set volume(e){this._volume=e,this.refresh()}get muted(){return this._muted}set muted(e){this._muted=e,this.refresh()}get loop(){return this._loop}set loop(e){this._loop=e,this.refresh()}get filters(){return this._filters}set filters(e){var s;this._filters&&((s=this._filters)==null||s.filter(r=>r).forEach(r=>r.disconnect()),this._filters=null,this._source.connect(this._gain)),this._filters=e!=null&&e.length?e.slice(0):null,this.refresh()}refresh(){if(!this._source)return;const e=this._media.context,s=this._media.parent;this._source.loop=this._loop||s.loop;const r=e.volume*(e.muted?0:1),i=s.volume*(s.muted?0:1),n=this._volume*(this._muted?0:1);Za.setParamValue(this._gain.gain,n*i*r),Za.setParamValue(this._source.playbackRate,this._speed*s.speed*e.speed),this.applyFilters()}applyFilters(){var e;if((e=this._filters)!=null&&e.length){this._source.disconnect();let s=this._source;this._filters.forEach(r=>{s.connect(r.destination),s=r}),s.connect(this._gain)}}refreshPaused(){const e=this._media.context,s=this._media.parent,r=this._paused||s.paused||e.paused;r!==this._pausedReal&&(this._pausedReal=r,r?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._elapsed%this._duration,end:this._end,speed:this._speed,loop:this._loop,volume:this._volume})),this.emit("pause",r))}play(e){const{start:s,end:r,speed:i,loop:n,volume:o,muted:a,filters:l}=e;r&&console.assert(r>s,"End time is before start time"),this._paused=!1;const{source:h,gain:u}=this._media.nodes.cloneBufferSource();this._source=h,this._gain=u,this._speed=i,this._volume=o,this._loop=!!n,this._muted=a,this._filters=l,this.refresh();const c=this._source.buffer.duration;this._duration=c,this._end=r,this._lastUpdate=this._now(),this._elapsed=s,this._source.onended=this._onComplete.bind(this),this._loop?(this._source.loopEnd=r,this._source.loopStart=s,this._source.start(0,s)):r?this._source.start(0,s,r-s):this._source.start(0,s),this.emit("start"),this._update(!0),this.enableTicker(!0)}enableTicker(e){At.shared.remove(this._updateListener,this),e&&At.shared.add(this._updateListener,this)}get progress(){return this._progress}get paused(){return this._paused}set paused(e){this._paused=e,this.refreshPaused()}destroy(){var e;this.removeAllListeners(),this._internalStop(),this._gain&&(this._gain.disconnect(),this._gain=null),this._media&&(this._media.context.events.off("refresh",this.refresh,this),this._media.context.events.off("refreshPaused",this.refreshPaused,this),this._media=null),(e=this._filters)==null||e.forEach(s=>s.disconnect()),this._filters=null,this._end=null,this._speed=1,this._volume=1,this._loop=!1,this._elapsed=0,this._duration=0,this._paused=!1,this._muted=!1,this._pausedReal=!1}toString(){return`[WebAudioInstance id=${this.id}]`}_now(){return this._media.context.audioContext.currentTime}_updateListener(){this._update()}_update(e=!1){if(this._source){const s=this._now(),r=s-this._lastUpdate;if(r>0||e){const i=this._source.playbackRate.value;this._elapsed+=r*i,this._lastUpdate=s;const n=this._duration;let o;if(this._source.loopStart){const a=this._source.loopEnd-this._source.loopStart;o=(this._source.loopStart+this._elapsed%a)/n}else o=this._elapsed%n/n;this._progress=o,this.emit("progress",this._progress,n)}}}init(e){this._media=e,e.context.events.on("refresh",this.refresh,this),e.context.events.on("refreshPaused",this.refreshPaused,this)}_internalStop(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.stop(0),this._source.disconnect();try{this._source.buffer=null}catch(e){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",e)}this._source=null}}_onComplete(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.disconnect();try{this._source.buffer=null}catch(e){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",e)}}this._source=null,this._progress=1,this.emit("progress",1,this._duration),this.emit("end",this)}}class Gd{constructor(e,s){this._output=s,this._input=e}get destination(){return this._input}get filters(){return this._filters}set filters(e){if(this._filters&&(this._filters.forEach(s=>{s&&s.disconnect()}),this._filters=null,this._input.connect(this._output)),e&&e.length){this._filters=e.slice(0),this._input.disconnect();let s=null;e.forEach(r=>{s===null?this._input.connect(r.destination):s.connect(r.destination),s=r}),s.connect(this._output)}}destroy(){this.filters=null,this._input=null,this._output=null}}const Hd=class extends Gd{constructor(t){const e=t.audioContext,s=e.createBufferSource(),r=e.createGain(),i=e.createAnalyser();s.connect(i),i.connect(r),r.connect(t.destination),super(i,r),this.context=t,this.bufferSource=s,this.gain=r,this.analyser=i}get script(){return this._script||(this._script=this.context.audioContext.createScriptProcessor(Hd.BUFFER_SIZE),this._script.connect(this.context.destination)),this._script}destroy(){super.destroy(),this.bufferSource.disconnect(),this._script&&this._script.disconnect(),this.gain.disconnect(),this.analyser.disconnect(),this.bufferSource=null,this._script=null,this.gain=null,this.analyser=null,this.context=null}cloneBufferSource(){const t=this.bufferSource,e=this.context.audioContext.createBufferSource();e.buffer=t.buffer,Za.setParamValue(e.playbackRate,t.playbackRate.value),e.loop=t.loop;const s=this.context.audioContext.createGain();return e.connect(s),s.connect(this.destination),{source:e,gain:s}}get bufferSize(){return this.script.bufferSize}};let $d=Hd;$d.BUFFER_SIZE=0;class N0{init(e){this.parent=e,this._nodes=new $d(this.context),this._source=this._nodes.bufferSource,this.source=e.options.source}destroy(){this.parent=null,this._nodes.destroy(),this._nodes=null;try{this._source.buffer=null}catch(e){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",e)}this._source=null,this.source=null}create(){return new M0(this)}get context(){return this.parent.context}get isPlayable(){return!!this._source&&!!this._source.buffer}get filters(){return this._nodes.filters}set filters(e){this._nodes.filters=e}get duration(){return console.assert(this.isPlayable,"Sound not yet playable, no duration"),this._source.buffer.duration}get buffer(){return this._source.buffer}set buffer(e){this._source.buffer=e}get nodes(){return this._nodes}load(e){this.source?this._decode(this.source,e):this.parent.url?this._loadUrl(e):e?e(new Error("sound.url or sound.source must be set")):console.error("sound.url or sound.source must be set")}async _loadUrl(e){const s=this.parent.url,r=await ne.ADAPTER.fetch(s);this._decode(await r.arrayBuffer(),e)}_decode(e,s){const r=(i,n)=>{if(i)s&&s(i);else{this.parent.isLoaded=!0,this.buffer=n;const o=this.parent.autoPlayStart();s&&s(null,this.parent,o)}};e instanceof AudioBuffer?r(null,e):this.parent.context.decode(e,r)}}const _r=class{static from(t){let e={};typeof t=="string"?e.url=t:t instanceof ArrayBuffer||t instanceof AudioBuffer||t instanceof HTMLAudioElement?e.source=t:Array.isArray(t)?e.url=t:e=t,e={autoPlay:!1,singleInstance:!1,url:null,source:null,preload:!1,volume:1,speed:1,complete:null,loaded:null,loop:!1,...e},Object.freeze(e);const s=Ii().useLegacy?new C0:new N0;return new _r(s,e)}constructor(t,e){this.media=t,this.options=e,this._instances=[],this._sprites={},this.media.init(this);const s=e.complete;this._autoPlayOptions=s?{complete:s}:null,this.isLoaded=!1,this._preloadQueue=null,this.isPlaying=!1,this.autoPlay=e.autoPlay,this.singleInstance=e.singleInstance,this.preload=e.preload||this.autoPlay,this.url=Array.isArray(e.url)?this.preferUrl(e.url):e.url,this.speed=e.speed,this.volume=e.volume,this.loop=e.loop,e.sprites&&this.addSprites(e.sprites),this.preload&&this._preload(e.loaded)}preferUrl(t){const[e]=t.map(s=>({url:s,ext:Tt.extname(s).slice(1)})).filter(({ext:s})=>Gn[s]).sort((s,r)=>Dn.indexOf(s.ext)-Dn.indexOf(r.ext));if(!e)throw new Error("No supported file type found");return e.url}get context(){return Ii().context}pause(){return this.isPlaying=!1,this.paused=!0,this}resume(){return this.isPlaying=this._instances.length>0,this.paused=!1,this}get paused(){return this._paused}set paused(t){this._paused=t,this.refreshPaused()}get speed(){return this._speed}set speed(t){this._speed=t,this.refresh()}get filters(){return this.media.filters}set filters(t){this.media.filters=t}addSprites(t,e){if(typeof t=="object"){const r={};for(const i in t)r[i]=this.addSprites(i,t[i]);return r}console.assert(!this._sprites[t],`Alias ${t} is already taken`);const s=new R0(this,e);return this._sprites[t]=s,s}destroy(){this._removeInstances(),this.removeSprites(),this.media.destroy(),this.media=null,this._sprites=null,this._instances=null}removeSprites(t){if(t){const e=this._sprites[t];e!==void 0&&(e.destroy(),delete this._sprites[t])}else for(const e in this._sprites)this.removeSprites(e);return this}get isPlayable(){return this.isLoaded&&this.media&&this.media.isPlayable}stop(){if(!this.isPlayable)return this.autoPlay=!1,this._autoPlayOptions=null,this;this.isPlaying=!1;for(let t=this._instances.length-1;t>=0;t--)this._instances[t].stop();return this}play(t,e){let s;if(typeof t=="string"?s={sprite:t,loop:this.loop,complete:e}:typeof t=="function"?(s={},s.complete=t):s=t,s={complete:null,loaded:null,sprite:null,end:null,start:0,volume:1,speed:1,muted:!1,loop:!1,...s||{}},s.sprite){const i=s.sprite;console.assert(!!this._sprites[i],`Alias ${i} is not available`);const n=this._sprites[i];s.start=n.start+(s.start||0),s.end=n.end,s.speed=n.speed||1,s.loop=n.loop||s.loop,delete s.sprite}if(s.offset&&(s.start=s.offset),!this.isLoaded)return this._preloadQueue?new Promise(i=>{this._preloadQueue.push(()=>{i(this.play(s))})}):(this._preloadQueue=[],this.autoPlay=!0,this._autoPlayOptions=s,new Promise((i,n)=>{this._preload((o,a,l)=>{this._preloadQueue.forEach(h=>h()),this._preloadQueue=null,o?n(o):(s.loaded&&s.loaded(o,a,l),i(l))})}));(this.singleInstance||s.singleInstance)&&this._removeInstances();const r=this._createInstance();return this._instances.push(r),this.isPlaying=!0,r.once("end",()=>{s.complete&&s.complete(this),this._onComplete(r)}),r.once("stop",()=>{this._onComplete(r)}),r.play(s),r}refresh(){const t=this._instances.length;for(let e=0;e<t;e++)this._instances[e].refresh()}refreshPaused(){const t=this._instances.length;for(let e=0;e<t;e++)this._instances[e].refreshPaused()}get volume(){return this._volume}set volume(t){this._volume=t,this.refresh()}get muted(){return this._muted}set muted(t){this._muted=t,this.refresh()}get loop(){return this._loop}set loop(t){this._loop=t,this.refresh()}_preload(t){this.media.load(t)}get instances(){return this._instances}get sprites(){return this._sprites}get duration(){return this.media.duration}autoPlayStart(){let t;return this.autoPlay&&(t=this.play(this._autoPlayOptions)),t}_removeInstances(){for(let t=this._instances.length-1;t>=0;t--)this._poolInstance(this._instances[t]);this._instances.length=0}_onComplete(t){if(this._instances){const e=this._instances.indexOf(t);e>-1&&this._instances.splice(e,1),this.isPlaying=this._instances.length>0}this._poolInstance(t)}_createInstance(){if(_r._pool.length>0){const t=_r._pool.pop();return t.init(this.media),t}return this.media.create()}_poolInstance(t){t.destroy(),_r._pool.indexOf(t)<0&&_r._pool.push(t)}};let Hn=_r;Hn._pool=[];class B0 extends Ss{constructor(){super(...arguments),this.speed=1,this.muted=!1,this.volume=1,this.paused=!1}refresh(){this.emit("refresh")}refreshPaused(){this.emit("refreshPaused")}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(e){console.warn("HTML Audio does not support filters")}get audioContext(){return console.warn("HTML Audio does not support audioContext"),null}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this.paused}destroy(){this.removeAllListeners()}}class Mi extends Gd{constructor(){const e=window,s=new Mi.AudioContext,r=s.createDynamicsCompressor(),i=s.createAnalyser();i.connect(r),r.connect(s.destination),super(i,r),this.autoPause=!0,this._ctx=s,this._offlineCtx=new Mi.OfflineAudioContext(1,2,e.OfflineAudioContext?Math.max(8e3,Math.min(96e3,s.sampleRate)):44100),this.compressor=r,this.analyser=i,this.events=new Ss,this.volume=1,this.speed=1,this.muted=!1,this.paused=!1,this._locked=s.state==="suspended"&&("ontouchstart"in globalThis||"onclick"in globalThis),this._locked&&(this._unlock(),this._unlock=this._unlock.bind(this),document.addEventListener("mousedown",this._unlock,!0),document.addEventListener("touchstart",this._unlock,!0),document.addEventListener("touchend",this._unlock,!0)),this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this),globalThis.addEventListener("focus",this.onFocus),globalThis.addEventListener("blur",this.onBlur)}onFocus(){if(!this.autoPause)return;const e=this._ctx.state;(e==="suspended"||e==="interrupted"||!this._locked)&&(this.paused=this._pausedOnBlur,this.refreshPaused())}onBlur(){this.autoPause&&(this._locked||(this._pausedOnBlur=this._paused,this.paused=!0,this.refreshPaused()))}_unlock(){this._locked&&(this.playEmptySound(),this._ctx.state==="running"&&(document.removeEventListener("mousedown",this._unlock,!0),document.removeEventListener("touchend",this._unlock,!0),document.removeEventListener("touchstart",this._unlock,!0),this._locked=!1))}playEmptySound(){const e=this._ctx.createBufferSource();e.buffer=this._ctx.createBuffer(1,1,22050),e.connect(this._ctx.destination),e.start(0,0,0),e.context.state==="suspended"&&e.context.resume()}static get AudioContext(){const e=window;return e.AudioContext||e.webkitAudioContext||null}static get OfflineAudioContext(){const e=window;return e.OfflineAudioContext||e.webkitOfflineAudioContext||null}destroy(){super.destroy();const e=this._ctx;typeof e.close<"u"&&e.close(),globalThis.removeEventListener("focus",this.onFocus),globalThis.removeEventListener("blur",this.onBlur),this.events.removeAllListeners(),this.analyser.disconnect(),this.compressor.disconnect(),this.analyser=null,this.compressor=null,this.events=null,this._offlineCtx=null,this._ctx=null}get audioContext(){return this._ctx}get offlineContext(){return this._offlineCtx}set paused(e){e&&this._ctx.state==="running"?this._ctx.suspend():!e&&this._ctx.state==="suspended"&&this._ctx.resume(),this._paused=e}get paused(){return this._paused}refresh(){this.events.emit("refresh")}refreshPaused(){this.events.emit("refreshPaused")}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this._paused}decode(e,s){const r=n=>{s(new Error((n==null?void 0:n.message)||"Unable to decode file"))},i=this._offlineCtx.decodeAudioData(e,n=>{s(null,n)},r);i&&i.catch(r)}}class L0{constructor(){this.init()}init(){return this.supported&&(this._webAudioContext=new Mi),this._htmlAudioContext=new B0,this._sounds={},this.useLegacy=!this.supported,this}get context(){return this._context}get filtersAll(){return this.useLegacy?[]:this._context.filters}set filtersAll(e){this.useLegacy||(this._context.filters=e)}get supported(){return Mi.AudioContext!==null}add(e,s){if(typeof e=="object"){const n={};for(const o in e){const a=this._getOptions(e[o],s);n[o]=this.add(o,a)}return n}if(console.assert(!this._sounds[e],`Sound with alias ${e} already exists.`),s instanceof Hn)return this._sounds[e]=s,s;const r=this._getOptions(s),i=Hn.from(r);return this._sounds[e]=i,i}_getOptions(e,s){let r;return typeof e=="string"?r={url:e}:Array.isArray(e)?r={url:e}:e instanceof ArrayBuffer||e instanceof AudioBuffer||e instanceof HTMLAudioElement?r={source:e}:r=e,r={...r,...s||{}},r}get useLegacy(){return this._useLegacy}set useLegacy(e){this._useLegacy=e,this._context=!e&&this.supported?this._webAudioContext:this._htmlAudioContext}get disableAutoPause(){return!this._webAudioContext.autoPause}set disableAutoPause(e){this._webAudioContext.autoPause=!e}remove(e){return this.exists(e,!0),this._sounds[e].destroy(),delete this._sounds[e],this}get volumeAll(){return this._context.volume}set volumeAll(e){this._context.volume=e,this._context.refresh()}get speedAll(){return this._context.speed}set speedAll(e){this._context.speed=e,this._context.refresh()}togglePauseAll(){return this._context.togglePause()}pauseAll(){return this._context.paused=!0,this._context.refreshPaused(),this}resumeAll(){return this._context.paused=!1,this._context.refreshPaused(),this}toggleMuteAll(){return this._context.toggleMute()}muteAll(){return this._context.muted=!0,this._context.refresh(),this}unmuteAll(){return this._context.muted=!1,this._context.refresh(),this}removeAll(){for(const e in this._sounds)this._sounds[e].destroy(),delete this._sounds[e];return this}stopAll(){for(const e in this._sounds)this._sounds[e].stop();return this}exists(e,s=!1){const r=!!this._sounds[e];return s&&console.assert(r,`No sound matching alias '${e}'.`),r}isPlaying(){for(const e in this._sounds)if(this._sounds[e].isPlaying)return!0;return!1}find(e){return this.exists(e,!0),this._sounds[e]}play(e,s){return this.find(e).play(s)}stop(e){return this.find(e).stop()}pause(e){return this.find(e).pause()}resume(e){return this.find(e).resume()}volume(e,s){const r=this.find(e);return s!==void 0&&(r.volume=s),r.volume}speed(e,s){const r=this.find(e);return s!==void 0&&(r.speed=s),r.speed}duration(e){return this.find(e).duration}close(){return this.removeAll(),this._sounds=null,this._webAudioContext&&(this._webAudioContext.destroy(),this._webAudioContext=null),this._htmlAudioContext&&(this._htmlAudioContext.destroy(),this._htmlAudioContext=null),this._context=null,this}}const Su={loader:$.LoadParser,resolver:$.ResolveParser,cache:$.CacheParser,detection:$.DetectionParser};Q.handle($.Asset,t=>{const e=t.ref;Object.entries(Su).filter(([s])=>!!e[s]).forEach(([s,r])=>Q.add(Object.assign(e[s],{extension:e[s].extension??r})))},t=>{const e=t.ref;Object.keys(Su).filter(s=>!!e[s]).forEach(s=>Q.remove(e[s]))});class k0{constructor(e,s=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=s}add(e){e.forEach(s=>{this._assetList.push(s)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],s=Math.min(this._assetList.length,this._maxConcurrent);for(let r=0;r<s;r++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}function Kr(t,e){if(Array.isArray(e)){for(const s of e)if(t.startsWith(`data:${s}`))return!0;return!1}return t.startsWith(`data:${e}`)}function Zr(t,e){const s=t.split("?")[0],r=Tt.extname(s).toLowerCase();return Array.isArray(e)?e.includes(r):r===e}const kt=(t,e,s=!1)=>(Array.isArray(t)||(t=[t]),e?t.map(r=>typeof r=="string"||s?e(r):r):t);function Vd(t,e,s,r,i){const n=e[s];for(let o=0;o<n.length;o++){const a=n[o];s<e.length-1?Vd(t.replace(r[s],a),e,s+1,r,i):i.push(t.replace(r[s],a))}}function U0(t){const e=/\{(.*?)\}/g,s=t.match(e),r=[];if(s){const i=[];s.forEach(n=>{const o=n.substring(1,n.length-1).split(",");i.push(o)}),Vd(t,i,0,s,r)}else r.push(t);return r}const $n=t=>!Array.isArray(t);class D0{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const s=this._cache.get(e);return s||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),s}set(e,s){const r=kt(e);let i;for(let a=0;a<this.parsers.length;a++){const l=this.parsers[a];if(l.test(s)){i=l.getCacheableAssets(r,s);break}}i||(i={},r.forEach(a=>{i[a]=s}));const n=Object.keys(i),o={cacheKeys:n,keys:r};if(r.forEach(a=>{this._cacheMap.set(a,o)}),n.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==s&&console.warn("[Cache] already has key:",a),this._cache.set(a,i[a])}),s instanceof ge){const a=s;r.forEach(l=>{a.baseTexture!==ge.EMPTY.baseTexture&&ve.addToCache(a.baseTexture,l),ge.addToCache(a,l)})}}remove(e){if(!this._cacheMap.has(e)){console.warn(`[Assets] Asset id ${e} was not found in the Cache`);return}const s=this._cacheMap.get(e);s.cacheKeys.forEach(r=>{this._cache.delete(r)}),s.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}}const Ws=new D0;class G0{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,s,r)=>(this._parsersValidated=!1,e[s]=r,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,s){const r={promise:null,parser:null};return r.promise=(async()=>{var o,a;let i=null,n=null;if(s.loadParser&&(n=this._parserHash[s.loadParser],n||console.warn(`[Assets] specified load parser "${s.loadParser}" not found while loading ${e}`)),!n){for(let l=0;l<this.parsers.length;l++){const h=this.parsers[l];if(h.load&&((o=h.test)!=null&&o.call(h,e,s,this))){n=h;break}}if(!n)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}i=await n.load(e,s,this),r.parser=n;for(let l=0;l<this.parsers.length;l++){const h=this.parsers[l];h.parse&&h.parse&&await((a=h.testParse)==null?void 0:a.call(h,i,s,this))&&(i=await h.parse(i,s,this)||i,r.parser=h)}return i})(),r}async load(e,s){this._parsersValidated||this._validateParsers();let r=0;const i={},n=$n(e),o=kt(e,h=>({alias:[h],src:h})),a=o.length,l=o.map(async h=>{const u=Tt.toAbsolute(h.src);if(!i[h.src])try{this.promiseCache[u]||(this.promiseCache[u]=this._getLoadPromiseAndParser(u,h)),i[h.src]=await this.promiseCache[u].promise,s&&s(++r/a)}catch(c){throw delete this.promiseCache[u],delete i[h.src],new Error(`[Loader.load] Failed to load ${u}.
${c}`)}});return await Promise.all(l),n?i[o[0].src]:i}async unload(e){const s=kt(e,r=>({alias:[r],src:r})).map(async r=>{var o,a;const i=Tt.toAbsolute(r.src),n=this.promiseCache[i];if(n){const l=await n.promise;delete this.promiseCache[i],(a=(o=n.parser)==null?void 0:o.unload)==null||a.call(o,l,r,this)}});await Promise.all(s)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,s)=>(e[s.name]&&console.warn(`[Assets] loadParser name conflict "${s.name}"`),{...e,[s.name]:s}),{})}}var Rs=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(Rs||{});const H0=".json",$0="application/json",V0={extension:{type:$.LoadParser,priority:Rs.Low},name:"loadJson",test(t){return Kr(t,$0)||Zr(t,H0)},async load(t){return await(await ne.ADAPTER.fetch(t)).json()}};Q.add(V0);const q0=".txt",W0="text/plain",j0={name:"loadTxt",extension:{type:$.LoadParser,priority:Rs.Low},test(t){return Kr(t,W0)||Zr(t,q0)},async load(t){return await(await ne.ADAPTER.fetch(t)).text()}};Q.add(j0);const z0=["normal","bold","100","200","300","400","500","600","700","800","900"],X0=[".ttf",".otf",".woff",".woff2"],K0=["font/ttf","font/otf","font/woff","font/woff2"],Z0=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function Q0(t){const e=Tt.extname(t),s=Tt.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(n=>n.charAt(0).toUpperCase()+n.slice(1));let r=s.length>0;for(const n of s)if(!n.match(Z0)){r=!1;break}let i=s.join(" ");return r||(i=`"${i.replace(/[\\"]/g,"\\$&")}"`),i}const Y0=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function J0(t){return Y0.test(t)?t:encodeURI(t)}const eb={extension:{type:$.LoadParser,priority:Rs.Low},name:"loadWebFont",test(t){return Kr(t,K0)||Zr(t,X0)},async load(t,e){var r,i,n;const s=ne.ADAPTER.getFontFaceSet();if(s){const o=[],a=((r=e.data)==null?void 0:r.family)??Q0(t),l=((n=(i=e.data)==null?void 0:i.weights)==null?void 0:n.filter(u=>z0.includes(u)))??["normal"],h=e.data??{};for(let u=0;u<l.length;u++){const c=l[u],d=new FontFace(a,`url(${J0(t)})`,{...h,weight:c});await d.load(),s.add(d),o.push(d)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach(e=>ne.ADAPTER.getFontFaceSet().delete(e))}};Q.add(eb);let Cu=0,Yo;const tb="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",sb={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${tb}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},rb={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let Jo;class ib{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const s=URL.createObjectURL(new Blob([sb.code],{type:"application/javascript"})),r=new Worker(s);r.addEventListener("message",i=>{r.terminate(),URL.revokeObjectURL(s),e(i.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){Yo===void 0&&(Yo=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<Yo&&(Jo||(Jo=URL.createObjectURL(new Blob([rb.code],{type:"application/javascript"}))),this._createdWorkers++,e=new Worker(Jo),e.addEventListener("message",s=>{this.complete(s.data),this.returnWorker(s.target),this.next()})),e}returnWorker(e){this.workerPool.push(e)}complete(e){e.error!==void 0?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(e,s){await this._initWorkers();const r=new Promise((i,n)=>{this.queue.push({id:e,arguments:s,resolve:i,reject:n})});return this.next(),r}next(){if(!this.queue.length)return;const e=this.getWorker();if(!e)return;const s=this.queue.pop(),r=s.id;this.resolveHash[Cu]={resolve:s.resolve,reject:s.reject},e.postMessage({data:s.arguments,uuid:Cu++,id:r})}}const Ru=new ib;function Rl(t,e,s){t.resource.internal=!0;const r=new ge(t),i=()=>{delete e.promiseCache[s],Ws.has(s)&&Ws.remove(s)};return r.baseTexture.once("destroyed",()=>{s in e.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),i())}),r.once("destroyed",()=>{t.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),i())}),r}const nb=[".jpeg",".jpg",".png",".webp",".avif"],ob=["image/jpeg","image/png","image/webp","image/avif"];async function ab(t){const e=await ne.ADAPTER.fetch(t);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${e.status} ${e.statusText}`);const s=await e.blob();return await createImageBitmap(s)}const yo={name:"loadTextures",extension:{type:$.LoadParser,priority:Rs.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(t){return Kr(t,ob)||Zr(t,nb)},async load(t,e,s){var a;const r=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let i;r?this.config.preferWorkers&&await Ru.isImageBitmapSupported()?i=await Ru.loadImageBitmap(t):i=await ab(t):i=await new Promise((l,h)=>{const u=new Image;u.crossOrigin=this.config.crossOrigin,u.src=t,u.complete?l(u):(u.onload=()=>l(u),u.onerror=c=>h(c))});const n={...e.data};n.resolution??(n.resolution=Fi(t)),r&&((a=n.resourceOptions)==null?void 0:a.ownsImageBitmap)===void 0&&(n.resourceOptions={...n.resourceOptions},n.resourceOptions.ownsImageBitmap=!0);const o=new ve(i,n);return o.resource.src=t,Rl(o,s,t)},unload(t){t.destroy(!0)}};Q.add(yo);const lb=".svg",hb="image/svg+xml",ub={extension:{type:$.LoadParser,priority:Rs.High},name:"loadSVG",test(t){return Kr(t,hb)||Zr(t,lb)},async testParse(t){return ja.test(t)},async parse(t,e,s){var n;const r=new ja(t,(n=e==null?void 0:e.data)==null?void 0:n.resourceOptions);await r.load();const i=new ve(r,{resolution:Fi(t),...e==null?void 0:e.data});return i.resource.src=e.src,Rl(i,s,e.src)},async load(t,e){return(await ne.ADAPTER.fetch(t)).text()},unload:yo.unload};Q.add(ub);const cb=[".mp4",".m4v",".webm",".ogv"],db=["video/mp4","video/webm","video/ogg"],fb={name:"loadVideo",extension:{type:$.LoadParser,priority:Rs.High},config:{defaultAutoPlay:!0},test(t){return Kr(t,db)||Zr(t,cb)},async load(t,e,s){var o;let r;const i=await(await ne.ADAPTER.fetch(t)).blob(),n=URL.createObjectURL(i);try{const a={autoPlay:this.config.defaultAutoPlay,...(o=e==null?void 0:e.data)==null?void 0:o.resourceOptions},l=new Ud(n,a);await l.load();const h=new ve(l,{alphaMode:await zv(),resolution:Fi(t),...e==null?void 0:e.data});h.resource.src=t,r=Rl(h,s,t),r.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(n)})}catch(a){throw URL.revokeObjectURL(n),a}return r},unload(t){t.destroy(!0)}};Q.add(fb);class pb{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,s)=>`${e}${this._bundleIdConnector}${s}`,extractAssetIdFromBundle:(e,s)=>s.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(s=>{this._preferredOrder.push(s),s.priority||(s.priority=Object.keys(s.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const s=e;this._defaultSearchParams=Object.keys(s).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(s[r])}`).join("&")}}getAlias(e){const{alias:s,name:r,src:i,srcs:n}=e;return kt(s||r||i||n,o=>typeof o=="string"?o:Array.isArray(o)?o.map(a=>(a==null?void 0:a.src)??(a==null?void 0:a.srcs)??a):o!=null&&o.src||o!=null&&o.srcs?o.src??o.srcs:o,!0)}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(s=>{this.addBundle(s.name,s.assets)})}addBundle(e,s){const r=[];Array.isArray(s)?s.forEach(i=>{const n=i.src??i.srcs,o=i.alias??i.name;let a;if(typeof o=="string"){const l=this._createBundleAssetId(e,o);r.push(l),a=[o,l]}else{const l=o.map(h=>this._createBundleAssetId(e,h));r.push(...l),a=[...o,...l]}this.add({...i,alias:a,src:n})}):Object.keys(s).forEach(i=>{const n=[i,this._createBundleAssetId(e,i)];if(typeof s[i]=="string")this.add({alias:n,src:s[i]});else if(Array.isArray(s[i]))this.add({alias:n,src:s[i]});else{const o=s[i],a=o.src??o.srcs;this.add({...o,alias:n,src:Array.isArray(a)?a:[a]})}r.push(...n)}),this._bundles[e]=r}add(e,s,r,i,n){const o=[];typeof e=="string"||Array.isArray(e)&&typeof e[0]=="string"?(xe("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),o.push({alias:e,src:s,data:r,format:i,loadParser:n})):Array.isArray(e)?o.push(...e):o.push(e);let a;a=l=>{this.hasKey(l)&&console.warn(`[Resolver] already has key: ${l} overwriting`)},kt(o).forEach(l=>{const{src:h,srcs:u}=l;let{data:c,format:d,loadParser:p}=l;const _=kt(h||u).map(y=>typeof y=="string"?U0(y):Array.isArray(y)?y:[y]),w=this.getAlias(l);Array.isArray(w)?w.forEach(a):a(w);const E=[];_.forEach(y=>{y.forEach(v=>{let g={};if(typeof v!="object"){g.src=v;for(let b=0;b<this._parsers.length;b++){const T=this._parsers[b];if(T.test(v)){g=T.parse(v);break}}}else c=v.data??c,d=v.format??d,p=v.loadParser??p,g={...g,...v};if(!w)throw new Error(`[Resolver] alias is undefined for this asset: ${g.src}`);g=this.buildResolvedAsset(g,{aliases:w,data:c,format:d,loadParser:p}),E.push(g)})}),w.forEach(y=>{this._assetMap[y]=E})})}resolveBundle(e){const s=$n(e);e=kt(e);const r={};return e.forEach(i=>{const n=this._bundles[i];if(n){const o=this.resolve(n),a={};for(const l in o){const h=o[l];a[this._extractAssetIdFromBundle(i,l)]=h}r[i]=a}}),s?r[e[0]]:r}resolveUrl(e){const s=this.resolve(e);if(typeof e!="string"){const r={};for(const i in s)r[i]=s[i].src;return r}return s.src}resolve(e){const s=$n(e);e=kt(e);const r={};return e.forEach(i=>{if(!this._resolverHash[i])if(this._assetMap[i]){let n=this._assetMap[i];const o=n[0],a=this._getPreferredOrder(n);a==null||a.priority.forEach(l=>{a.params[l].forEach(h=>{const u=n.filter(c=>c[l]?c[l]===h:!1);u.length&&(n=u)})}),this._resolverHash[i]=n[0]??o}else this._resolverHash[i]=this.buildResolvedAsset({alias:[i],src:i},{});r[i]=this._resolverHash[i]}),s?r[e[0]]:r}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let s=0;s<e.length;s++){const r=e[0],i=this._preferredOrder.find(n=>n.params.format.includes(r.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const s=/\?/.test(e)?"&":"?";return`${e}${s}${this._defaultSearchParams}`}buildResolvedAsset(e,s){const{aliases:r,data:i,loadParser:n,format:o}=s;return(this._basePath||this._rootPath)&&(e.src=Tt.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=r??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...i||{},...e.data},e.loadParser=n??e.loadParser,e.format=o??Tt.extname(e.src).slice(1),e.srcs=e.src,e.name=e.alias,e}}class mb{constructor(){this._detections=[],this._initialized=!1,this.resolver=new pb,this.loader=new G0,this.cache=Ws,this._backgroundLoader=new k0(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){var n,o;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let a=e.manifest;typeof a=="string"&&(a=await this.load(a)),this.resolver.addManifest(a)}const s=((n=e.texturePreference)==null?void 0:n.resolution)??1,r=typeof s=="number"?[s]:s,i=await this._detectFormats({preferredFormats:(o=e.texturePreference)==null?void 0:o.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:i,resolution:r}}),e.preferences&&this.setPreferences(e.preferences)}add(e,s,r,i,n){this.resolver.add(e,s,r,i,n)}async load(e,s){this._initialized||await this.init();const r=$n(e),i=kt(e).map(a=>{if(typeof a!="string"){const l=this.resolver.getAlias(a);return l.some(h=>!this.resolver.hasKey(h))&&this.add(a),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),n=this.resolver.resolve(i),o=await this._mapLoadToResolve(n,s);return r?o[i[0]]:o}addBundle(e,s){this.resolver.addBundle(e,s)}async loadBundle(e,s){this._initialized||await this.init();let r=!1;typeof e=="string"&&(r=!0,e=[e]);const i=this.resolver.resolveBundle(e),n={},o=Object.keys(i);let a=0,l=0;const h=()=>{s==null||s(++a/l)},u=o.map(c=>{const d=i[c];return l+=Object.keys(d).length,this._mapLoadToResolve(d,h).then(p=>{n[c]=p})});return await Promise.all(u),r?n[e[0]]:n}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const s=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(s))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const s=this.resolver.resolveBundle(e);Object.values(s).forEach(r=>{this._backgroundLoader.add(Object.values(r))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return Ws.get(e);const s={};for(let r=0;r<e.length;r++)s[r]=Ws.get(e[r]);return s}async _mapLoadToResolve(e,s){const r=Object.values(e),i=Object.keys(e);this._backgroundLoader.active=!1;const n=await this.loader.load(r,s);this._backgroundLoader.active=!0;const o={};return r.forEach((a,l)=>{const h=n[a.src],u=[a.src];a.alias&&u.push(...a.alias),o[i[l]]=h,Ws.set(u,h)}),o}async unload(e){this._initialized||await this.init();const s=kt(e).map(i=>typeof i!="string"?i.src:i),r=this.resolver.resolve(s);await this._unloadFromResolved(r)}async unloadBundle(e){this._initialized||await this.init(),e=kt(e);const s=this.resolver.resolveBundle(e),r=Object.keys(s).map(i=>this._unloadFromResolved(s[i]));await Promise.all(r)}async _unloadFromResolved(e){const s=Object.values(e);s.forEach(r=>{Ws.remove(r.src)}),await this.loader.unload(s)}async _detectFormats(e){let s=[];e.preferredFormats&&(s=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const r of e.detections)e.skipDetections||await r.test()?s=await r.add(s):e.skipDetections||(s=await r.remove(s));return s=s.filter((r,i)=>s.indexOf(r)===i),s}get detections(){return this._detections}get preferWorkers(){return yo.config.preferWorkers}set preferWorkers(e){xe("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}setPreferences(e){this.loader.parsers.forEach(s=>{s.config&&Object.keys(s.config).filter(r=>r in e).forEach(r=>{s.config[r]=e[r]})})}}const ln=new mb;Q.handleByList($.LoadParser,ln.loader.parsers).handleByList($.ResolveParser,ln.resolver.parsers).handleByList($.CacheParser,ln.cache.parsers).handleByList($.DetectionParser,ln.detections);const yb={extension:$.CacheParser,test:t=>Array.isArray(t)&&t.every(e=>e instanceof ge),getCacheableAssets:(t,e)=>{const s={};return t.forEach(r=>{e.forEach((i,n)=>{s[r+(n===0?"":n+1)]=i})}),s}};Q.add(yb);async function qd(t){if("Image"in globalThis)return new Promise(e=>{const s=new Image;s.onload=()=>{e(!0)},s.onerror=()=>{e(!1)},s.src=t});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(t)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const gb={extension:{type:$.DetectionParser,priority:1},test:async()=>qd("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter(e=>e!=="avif")};Q.add(gb);const vb={extension:{type:$.DetectionParser,priority:0},test:async()=>qd("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter(e=>e!=="webp")};Q.add(vb);const Pu=["png","jpg","jpeg"],_b={extension:{type:$.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...Pu],remove:async t=>t.filter(e=>!Pu.includes(e))};Q.add(_b);const bb="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Pl(t){return bb?!1:document.createElement("video").canPlayType(t)!==""}const xb={extension:{type:$.DetectionParser,priority:0},test:async()=>Pl("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter(e=>e!=="webm")};Q.add(xb);const Ab={extension:{type:$.DetectionParser,priority:0},test:async()=>Pl("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter(e=>e!=="mp4"&&e!=="m4v")};Q.add(Ab);const Tb={extension:{type:$.DetectionParser,priority:0},test:async()=>Pl("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter(e=>e!=="ogv")};Q.add(Tb);const wb={extension:$.ResolveParser,test:yo.test,parse:t=>{var e;return{resolution:parseFloat(((e=ne.RETINA_PREFIX.exec(t))==null?void 0:e[1])??"1"),format:Tt.extname(t).slice(1),src:t}}};Q.add(wb);const Fu=t=>{var s;const e=t.src;return((s=t==null?void 0:t.alias)==null?void 0:s[0])??Tt.basename(e,Tt.extname(e))},Eb={extension:$.Asset,detection:{test:async()=>!0,add:async t=>[...t,...Dn.filter(e=>Gn[e])],remove:async t=>t.filter(e=>t.includes(e))},loader:{extension:{type:[$.LoadParser],priority:Rs.High},test(t){const e=Tt.extname(t).slice(1);return!!Gn[e]||P0.some(s=>t.startsWith(`data:${s}`))},async load(t,e){const s=await new Promise((r,i)=>Hn.from({...e.data,url:t,preload:!0,loaded(n,o){var a,l;n?i(n):r(o),(l=(a=e.data)==null?void 0:a.loaded)==null||l.call(a,n,o)}}));return Ii().add(Fu(e),s),s},async unload(t,e){Ii().remove(Fu(e))}}};Q.add(Eb);const ft=ry(new L0);class Ye{static load(){ft.add("inventoryOpen",{url:"assets/sfx/inventory-open.mp3",preload:!0}),ft.add("inventoryClose",{url:"assets/sfx/inventory-close.mp3",preload:!0}),ft.add("spikes",{url:"assets/sfx/spikes.mp3",preload:!0}),ft.add("click",{url:"assets/sfx/click.wav",preload:!0}),ft.add("confirm",{url:"assets/sfx/confirm.mp3",preload:!0}),ft.add("chest",{url:"assets/sfx/chest.m4a",preload:!0}),ft.add("footstep",{url:"assets/sfx/footstep.m4a",preload:!0}),ft.add("dead",{url:"assets/sfx/dead.m4a",preload:!0}),ft.add("mining",{url:"assets/sfx/mining.m4a",preload:!0}),ft.add("pickup",{url:"assets/sfx/pickup.m4a",preload:!0}),ft.add("potion",{url:"assets/sfx/potion.m4a",preload:!0}),ft.add("login",{url:"assets/sfx/login.m4a",preload:!0}),ft.volumeAll=.2}static play(e){ft.play(e)}}class tt{constructor(e,s=1){G(this,"id");G(this,"quantity");this.id=e,this.quantity=s}getName(){return bt.get(this.id).name}getType(){return bt.get(this.id).type}getAltitude(){return bt.get(this.id).altitude}getSprite(){return bt.get(this.id).sprite}isUsable(){return bt.get(this.id).isUsable}isMovable(){return bt.get(this.id).isMovable}isPickupable(){return bt.get(this.id).isPickupable}isBlockingCreatures(){return bt.get(this.id).isBlockingCreatures}isBlockingItems(){return bt.get(this.id).isBlockingItems}isEquipable(){return bt.get(this.id).isEquipable}}var Vn,Pe,Wd,qn,jd,Wn,zd,jn,Xd,zn,Kd,Xn,Zd,Kn,Qd,Zn,Yd,Qn,Jd,Yn,ef;let br=(Pe=class{static async connect(e){return new Promise(s=>(window.addEventListener("hero-position-changed",Pt(Pe,Wn,zd)),window.addEventListener("update-vitals",r=>{var i;((i=r.detail)==null?void 0:i.health)===0&&X("dead")}),setTimeout(()=>{X("init",{name:"Guest"})},250),s()))}static emit(e,s){var r,i,n,o,a;if(e==="use")return Pt(r=Pe,Vn,Wd).call(r,s);if(e==="request-tiles")return Pt(i=Pe,qn,jd).call(i,s);if(e==="move-item")return Pt(n=Pe,jn,Xd).call(n,s);if(e==="equip")return Pt(o=Pe,Qn,Jd).call(o,s);if(e==="unequip")return Pt(a=Pe,Yn,ef).call(a,s)}},Vn=new WeakSet,Wd=function(e){var s,r,i,n,o,a;if(e.itemId===6){if(e.slot!==null)return;const l=le.getTileStack(e.position);if(l.pop(),Ye.play("chest"),X("update-tiles",{tiles:[{position:e.position,stack:l}]}),X("run-effect",{position:e.position,effect:"yellow-sparkles"}),wt(2)){X("loot",{itemId:9,quantity:1});let h=Re.getFirstSlotWithItem(9)??Re.getFirstSlotWithItem(null),u=((s=Re.getSlot(h).item)==null?void 0:s.quantity)??0;X("update-inventory-slot",{slot:h,itemId:9,quantity:u+1})}else if(wt(2)){X("loot",{itemId:11,quantity:1});let h=Re.getFirstSlotWithItem(11)??Re.getFirstSlotWithItem(null),u=((r=Re.getSlot(h).item)==null?void 0:r.quantity)??0;X("update-inventory-slot",{slot:h,itemId:11,quantity:u+1})}else{X("loot",{itemId:14,quantity:1});let h=Re.getFirstSlotWithItem(14)??Re.getFirstSlotWithItem(null),u=((i=Re.getSlot(h).item)==null?void 0:i.quantity)??0;X("update-inventory-slot",{slot:h,itemId:14,quantity:u+1})}}if(e.itemId===8){if(e.slot!==null)return;Ye.play("mining"),X("run-effect",{position:e.position,effect:"ore-hit"});const l=Om(3);if(wt(3)&&l){X("loot",{itemId:10,quantity:l});let h=Re.getFirstSlotWithItem(10)??Re.getFirstSlotWithItem(null);const u=((n=Re.getSlot(h).item)==null?void 0:n.quantity)??0;X("update-inventory-slot",{slot:h,itemId:10,quantity:u+l})}}if(e.itemId===9){if(e.slot!==null){const h=((o=Re.getSlot(e.slot).item)==null?void 0:o.quantity)??0;h>1?X("update-inventory-slot",{slot:e.slot,itemId:e.itemId,quantity:h-1}):X("update-inventory-slot",{slot:e.slot,itemId:null})}else{const h=le.getTileTopItem(e.position);h.quantity>1?h.quantity--:le.getTileStack(e.position).pop()}let l=gs.health+1e3;l>gs.maxHealth&&(l=gs.maxHealth),X("update-vitals",{health:l}),X("run-effect",{position:K.position,effect:"red-sparkles"}),Ye.play("potion")}if(e.itemId===11){if(e.slot!==null){const h=((a=Re.getSlot(e.slot).item)==null?void 0:a.quantity)??0;h>1?X("update-inventory-slot",{slot:e.slot,itemId:e.itemId,quantity:h-1}):X("update-inventory-slot",{slot:e.slot,itemId:null})}else{const h=le.getTileTopItem(e.position);h.quantity>1?h.quantity--:le.getTileStack(e.position).pop()}let l=gs.mana+50;l>gs.maxMana&&(l=gs.maxMana),X("update-vitals",{mana:l}),X("run-effect",{position:K.position,effect:"blue-sparkles"}),Ye.play("potion")}Ct.refreshPointer()},qn=new WeakSet,jd=function(e){for(const s of e.positions){const r=[];wt(40)?r.push(new tt(2)):wt(40)?r.push(new tt(3)):wt(30)?r.push(new tt(4)):r.push(new tt(1)),ws(s,K.position)||(wt(100)?r.push(new tt(6)):wt(100)?r.push(new tt(8)):wt(100)?r.push(new tt(5)):wt(100)?r.push(new tt(7)):wt(100)&&r.push(new tt(12))),X("update-tiles",{tiles:[{position:s,stack:r}]}),wt(350)&&X("add-creature",{position:s,name:"NPC #"+Ac(4)})}},Wn=new WeakSet,zd=function(){const e=le.getTileStack(K.position);e.forEach((s,r)=>{if(s.id===12){let i=gs.health-15;i<0&&(i=0),e[r]=new tt(13),le.update(),X("run-effect",{position:K.position,effect:"blood",onCreature:!0}),X("update-vitals",{health:i}),Ye.play("spikes"),setTimeout(()=>{e[r]=new tt(12)},1e3)}})},jn=new WeakSet,Xd=function(e){var s,r,i,n;if(e.action==="move")return Pt(s=Pe,zn,Kd).call(s,e);if(e.action==="loot")return Pt(r=Pe,Xn,Zd).call(r,e);if(e.action==="drop")return Pt(i=Pe,Kn,Qd).call(i,e);if(e.action==="swap")return Pt(n=Pe,Zn,Yd).call(n,e)},zn=new WeakSet,Kd=function(e){const s=le.getTileStack(e.fromPosition);s.pop();const r=le.getTileStack(e.toPosition);r.push(new tt(e.itemId,e.quantity)),X("update-tiles",{tiles:[{position:e.fromPosition,stack:s},{position:e.toPosition,stack:r}]})},Xn=new WeakSet,Zd=function(e){const s=le.getTileStack(e.fromPosition);s.pop(),X("update-tiles",{tiles:[{position:e.fromPosition,stack:s}]}),e.toSlot=e.toSlot??Re.getFirstSlotWithItem(e.itemId)??Re.getFirstSlotWithItem(null);const r=Re.getSlot(e.toSlot).item;r?r.id===e.itemId?X("update-inventory-slot",{slot:e.toSlot,itemId:e.itemId,quantity:r.quantity+e.quantity}):(s.push(r),X("update-inventory-slot",{slot:e.toSlot,itemId:e.itemId,quantity:e.quantity})):X("update-inventory-slot",{slot:e.toSlot,itemId:e.itemId,quantity:e.quantity}),X("loot",{itemId:e.itemId,quantity:e.quantity})},Kn=new WeakSet,Qd=function(e){const s=Re.getSlot(e.fromSlot).item.quantity-e.quantity;X("update-inventory-slot",{slot:e.fromSlot,itemId:e.itemId,quantity:s});const r=e.toPosition??K.position,i=le.getTileStack(r);i.push(new tt(e.itemId,e.quantity)),X("update-tiles",{tiles:[{position:r,stack:i}]})},Zn=new WeakSet,Yd=function(e){var o,a,l,h;const s=(o=Re.getSlot(e.fromSlot).item)==null?void 0:o.id,r=((a=Re.getSlot(e.fromSlot).item)==null?void 0:a.quantity)??0,i=(l=Re.getSlot(e.toSlot).item)==null?void 0:l.id,n=((h=Re.getSlot(e.toSlot).item)==null?void 0:h.quantity)??0;s===i?(e.quantity===r?X("update-inventory-slot",{slot:e.fromSlot,itemId:null}):X("update-inventory-slot",{slot:e.fromSlot,itemId:e.itemId,quantity:r-e.quantity}),X("update-inventory-slot",{slot:e.toSlot,itemId:e.itemId,quantity:n+e.quantity})):e.quantity===r&&(X("update-inventory-slot",{slot:e.fromSlot,itemId:i,quantity:n}),X("update-inventory-slot",{slot:e.toSlot,itemId:s,quantity:r}))},Qn=new WeakSet,Jd=function(e){var r;const s=Re.getSlot(e.fromSlot).item.quantity-1;(r=fn.getSlot("equipment-armor").item)!=null&&r.id||(X("update-inventory-slot",{slot:e.fromSlot,itemId:e.itemId,quantity:s}),X("update-equipment-slot",{slot:"equipment-armor",itemId:e.itemId,quantity:1}))},Yn=new WeakSet,ef=function(e){var r;if(!((r=fn.getSlot(e.fromSlot).item)!=null&&r.id))return;const s=fn.getSlot(e.fromSlot).item;X("update-equipment-slot",{slot:e.fromSlot,itemId:null}),X("update-inventory-slot",{slot:Re.getFirstSlotWithItem(null),itemId:s.id,quantity:1})},at(Pe,Vn),at(Pe,qn),at(Pe,Wn),at(Pe,jn),at(Pe,zn),at(Pe,Xn),at(Pe,Kn),at(Pe,Zn),at(Pe,Qn),at(Pe,Yn),Pe);class Bt{static moveItem(e){e.fromPosition=e.fromPosition??null,e.fromSlot=e.fromSlot??null,e.toPosition=e.toPosition??null,e.toSlot=e.toSlot??null,["move","loot","drop","swap"].includes(e.action)&&(e.action==="move"&&(e.fromPosition===null||e.toPosition===null||ws(e.fromPosition,e.toPosition)||!Yt(K.position,e.fromPosition)||le.getTileTopItem(e.fromPosition).id!==e.itemId||le.getTileStack(e.toPosition).find(s=>s.isBlockingItems()))||e.action==="loot"&&(e.fromPosition===null||le.getTileTopItem(e.fromPosition).id!==e.itemId||!Yt(K.position,e.fromPosition))||e.action==="drop"&&(e.fromSlot===null||le.getTileStack(e.toPosition).find(s=>s.isBlockingItems()))||e.action==="swap"&&(e.fromSlot===null||e.toSlot===null||e.fromSlot===e.toSlot)||br.emit("move-item",e))}static use(e,s=null,r=null){var i;s!==null&&(((i=le.getTileTopItem(s))==null?void 0:i.id)!==e||!Yt(K.position,s))||br.emit("use",{itemId:e,position:s,slot:r})}static requestTiles(e){br.emit("request-tiles",{positions:e})}static equip(e,s){br.emit("equip",{itemId:e,fromSlot:s})}static unequip(e){br.emit("unequip",{fromSlot:e})}}var Ib=function(){this.pointsToAvoid={},this.startX,this.callback,this.startY,this.endX,this.endY,this.nodeHash={},this.openList},Sb=function(t,e,s,r,i){this.parent=t,this.x=e,this.y=s,this.costSoFar=r,this.simpleDistanceToTarget=i,this.bestGuessDistance=function(){return this.costSoFar+this.simpleDistanceToTarget}},tf={exports:{}};(function(t,e){(function(){var s,r,i,n,o,a,l,h,u,c,d,p,_,w,E;i=Math.floor,c=Math.min,r=function(y,v){return y<v?-1:y>v?1:0},u=function(y,v,g,b,T){var A;if(g==null&&(g=0),T==null&&(T=r),g<0)throw new Error("lo must be non-negative");for(b==null&&(b=y.length);g<b;)A=i((g+b)/2),T(v,y[A])<0?b=A:g=A+1;return[].splice.apply(y,[g,g-g].concat(v)),v},a=function(y,v,g){return g==null&&(g=r),y.push(v),w(y,0,y.length-1,g)},o=function(y,v){var g,b;return v==null&&(v=r),g=y.pop(),y.length?(b=y[0],y[0]=g,E(y,0,v)):b=g,b},h=function(y,v,g){var b;return g==null&&(g=r),b=y[0],y[0]=v,E(y,0,g),b},l=function(y,v,g){var b;return g==null&&(g=r),y.length&&g(y[0],v)<0&&(b=[y[0],v],v=b[0],y[0]=b[1],E(y,0,g)),v},n=function(y,v){var g,b,T,A,x,N;for(v==null&&(v=r),A=(function(){N=[];for(var V=0,W=i(y.length/2);0<=W?V<W:V>W;0<=W?V++:V--)N.push(V);return N}).apply(this).reverse(),x=[],b=0,T=A.length;b<T;b++)g=A[b],x.push(E(y,g,v));return x},_=function(y,v,g){var b;if(g==null&&(g=r),b=y.indexOf(v),b!==-1)return w(y,0,b,g),E(y,b,g)},d=function(y,v,g){var b,T,A,x,N;if(g==null&&(g=r),T=y.slice(0,v),!T.length)return T;for(n(T,g),N=y.slice(v),A=0,x=N.length;A<x;A++)b=N[A],l(T,b,g);return T.sort(g).reverse()},p=function(y,v,g){var b,T,A,x,N,V,W,ue,ie;if(g==null&&(g=r),v*10<=y.length){if(A=y.slice(0,v).sort(g),!A.length)return A;for(T=A[A.length-1],W=y.slice(v),x=0,V=W.length;x<V;x++)b=W[x],g(b,T)<0&&(u(A,b,0,null,g),A.pop(),T=A[A.length-1]);return A}for(n(y,g),ie=[],N=0,ue=c(v,y.length);0<=ue?N<ue:N>ue;0<=ue?++N:--N)ie.push(o(y,g));return ie},w=function(y,v,g,b){var T,A,x;for(b==null&&(b=r),T=y[g];g>v;){if(x=g-1>>1,A=y[x],b(T,A)<0){y[g]=A,g=x;continue}break}return y[g]=T},E=function(y,v,g){var b,T,A,x,N;for(g==null&&(g=r),T=y.length,N=v,A=y[v],b=2*v+1;b<T;)x=b+1,x<T&&!(g(y[b],y[x])<0)&&(b=x),y[v]=y[b],v=b,b=2*v+1;return y[v]=A,w(y,N,v,g)},s=function(){y.push=a,y.pop=o,y.replace=h,y.pushpop=l,y.heapify=n,y.updateItem=_,y.nlargest=d,y.nsmallest=p;function y(v){this.cmp=v??r,this.nodes=[]}return y.prototype.push=function(v){return a(this.nodes,v,this.cmp)},y.prototype.pop=function(){return o(this.nodes,this.cmp)},y.prototype.peek=function(){return this.nodes[0]},y.prototype.contains=function(v){return this.nodes.indexOf(v)!==-1},y.prototype.replace=function(v){return h(this.nodes,v,this.cmp)},y.prototype.pushpop=function(v){return l(this.nodes,v,this.cmp)},y.prototype.heapify=function(){return n(this.nodes,this.cmp)},y.prototype.updateItem=function(v){return _(this.nodes,v,this.cmp)},y.prototype.clear=function(){return this.nodes=[]},y.prototype.empty=function(){return this.nodes.length===0},y.prototype.size=function(){return this.nodes.length},y.prototype.clone=function(){var v;return v=new y,v.nodes=this.nodes.slice(0),v},y.prototype.toArray=function(){return this.nodes.slice(0)},y.prototype.insert=y.prototype.push,y.prototype.top=y.prototype.peek,y.prototype.front=y.prototype.peek,y.prototype.has=y.prototype.contains,y.prototype.copy=y.prototype.clone,y}(),function(y,v){return t.exports=v()}(this,function(){return s})}).call(fi)})(tf);var Cb=tf.exports,Rb=Cb,je={},Pb=Ib,Fb=Sb,Ob=Rb;const Mb=0,Nb=1;var Bb=je,Lb=1;je.js=function(){var t=1,e=1.4,s=!1,r={},i,n={},o={},a={},l=!0,h,u={},c=[],d=Number.MAX_VALUE,p,_=!1;this.setAcceptableTiles=function(T){T instanceof Array?p=T:!isNaN(parseFloat(T))&&isFinite(T)&&(p=[T])},this.enableSync=function(){s=!0},this.disableSync=function(){s=!1},this.enableDiagonals=function(){_=!0},this.disableDiagonals=function(){_=!1},this.setGrid=function(T){i=T;for(var A=0;A<i.length;A++)for(var x=0;x<i[0].length;x++)n[i[A][x]]||(n[i[A][x]]=1)},this.setTileCost=function(T,A){n[T]=A},this.setAdditionalPointCost=function(T,A,x){o[A]===void 0&&(o[A]={}),o[A][T]=x},this.removeAdditionalPointCost=function(T,A){o[A]!==void 0&&delete o[A][T]},this.removeAllAdditionalPointCosts=function(){o={}},this.setDirectionalCondition=function(T,A,x){a[A]===void 0&&(a[A]={}),a[A][T]=x},this.removeAllDirectionalConditions=function(){a={}},this.setIterationsPerCalculation=function(T){d=T},this.avoidAdditionalPoint=function(T,A){r[A]===void 0&&(r[A]={}),r[A][T]=1},this.stopAvoidingAdditionalPoint=function(T,A){r[A]!==void 0&&delete r[A][T]},this.enableCornerCutting=function(){l=!0},this.disableCornerCutting=function(){l=!1},this.stopAvoidingAllAdditionalPoints=function(){r={}},this.findPath=function(T,A,x,N,V){var W=function(pe){s?V(pe):setTimeout(function(){V(pe)})};if(p===void 0)throw new Error("You can't set a path without first calling setAcceptableTiles() on EasyStar.");if(i===void 0)throw new Error("You can't set a path without first calling setGrid() on EasyStar.");if(T<0||A<0||x<0||N<0||T>i[0].length-1||A>i.length-1||x>i[0].length-1||N>i.length-1)throw new Error("Your start or end point is outside the scope of your grid.");if(T===x&&A===N){W([]);return}for(var ue=i[N][x],ie=!1,be=0;be<p.length;be++)if(ue===p[be]){ie=!0;break}if(ie===!1){W(null);return}var fe=new Pb;fe.openList=new Ob(function(pe,Ae){return pe.bestGuessDistance()-Ae.bestGuessDistance()}),fe.isDoneCalculating=!1,fe.nodeHash={},fe.startX=T,fe.startY=A,fe.endX=x,fe.endY=N,fe.callback=W,fe.openList.push(g(fe,fe.startX,fe.startY,null,t));var He=Lb++;return u[He]=fe,c.push(He),He},this.cancelPath=function(T){return T in u?(delete u[T],!0):!1},this.calculate=function(){if(!(c.length===0||i===void 0||p===void 0))for(h=0;h<d;h++){if(c.length===0)return;s&&(h=0);var T=c[0],A=u[T];if(typeof A>"u"){c.shift();continue}if(A.openList.size()===0){A.callback(null),delete u[T],c.shift();continue}var x=A.openList.pop();if(A.endX===x.x&&A.endY===x.y){var N=[];N.push({x:x.x,y:x.y});for(var V=x.parent;V!=null;)N.push({x:V.x,y:V.y}),V=V.parent;N.reverse();var W=N;A.callback(W),delete u[T],c.shift();continue}x.list=Mb,x.y>0&&w(A,x,0,-1,t*v(x.x,x.y-1)),x.x<i[0].length-1&&w(A,x,1,0,t*v(x.x+1,x.y)),x.y<i.length-1&&w(A,x,0,1,t*v(x.x,x.y+1)),x.x>0&&w(A,x,-1,0,t*v(x.x-1,x.y)),_&&(x.x>0&&x.y>0&&(l||E(i,p,x.x,x.y-1,x)&&E(i,p,x.x-1,x.y,x))&&w(A,x,-1,-1,e*v(x.x-1,x.y-1)),x.x<i[0].length-1&&x.y<i.length-1&&(l||E(i,p,x.x,x.y+1,x)&&E(i,p,x.x+1,x.y,x))&&w(A,x,1,1,e*v(x.x+1,x.y+1)),x.x<i[0].length-1&&x.y>0&&(l||E(i,p,x.x,x.y-1,x)&&E(i,p,x.x+1,x.y,x))&&w(A,x,1,-1,e*v(x.x+1,x.y-1)),x.x>0&&x.y<i.length-1&&(l||E(i,p,x.x,x.y+1,x)&&E(i,p,x.x-1,x.y,x))&&w(A,x,-1,1,e*v(x.x-1,x.y+1)))}};var w=function(T,A,x,N,V){var W=A.x+x,ue=A.y+N;if((r[ue]===void 0||r[ue][W]===void 0)&&E(i,p,W,ue,A)){var ie=g(T,W,ue,A,V);ie.list===void 0?(ie.list=Nb,T.openList.push(ie)):A.costSoFar+V<ie.costSoFar&&(ie.costSoFar=A.costSoFar+V,ie.parent=A,T.openList.updateItem(ie))}},E=function(T,A,x,N,V){var W=a[N]&&a[N][x];if(W){var ue=y(V.x-x,V.y-N),ie=function(){for(var fe=0;fe<W.length;fe++)if(W[fe]===ue)return!0;return!1};if(!ie())return!1}for(var be=0;be<A.length;be++)if(T[N][x]===A[be])return!0;return!1},y=function(T,A){if(T===0&&A===-1)return je.TOP;if(T===1&&A===-1)return je.TOP_RIGHT;if(T===1&&A===0)return je.RIGHT;if(T===1&&A===1)return je.BOTTOM_RIGHT;if(T===0&&A===1)return je.BOTTOM;if(T===-1&&A===1)return je.BOTTOM_LEFT;if(T===-1&&A===0)return je.LEFT;if(T===-1&&A===-1)return je.TOP_LEFT;throw new Error("These differences are not valid: "+T+", "+A)},v=function(T,A){return o[A]&&o[A][T]||n[i[A][T]]},g=function(T,A,x,N,V){if(T.nodeHash[x]!==void 0){if(T.nodeHash[x][A]!==void 0)return T.nodeHash[x][A]}else T.nodeHash[x]={};var W=b(A,x,T.endX,T.endY);if(N!==null)var ue=N.costSoFar+V;else ue=0;var ie=new Fb(N,A,x,ue,W);return T.nodeHash[x][A]=ie,ie},b=function(T,A,x,N){if(_){var V=Math.abs(T-x),W=Math.abs(A-N);return V<W?e*V+W:e*W+V}else{var V=Math.abs(T-x),W=Math.abs(A-N);return V+W}}};je.TOP="TOP";je.TOP_RIGHT="TOP_RIGHT";je.RIGHT="RIGHT";je.BOTTOM_RIGHT="BOTTOM_RIGHT";je.BOTTOM="BOTTOM";je.BOTTOM_LEFT="BOTTOM_LEFT";je.LEFT="LEFT";je.TOP_LEFT="TOP_LEFT";const D=class D{static init(){D.easyStar=new Bb.js,window.addEventListener("move-north",()=>{D.clearPath(),D.walk("north")}),window.addEventListener("move-south",()=>{D.clearPath(),D.walk("south")}),window.addEventListener("move-west",()=>{D.clearPath(),D.walk("west")}),window.addEventListener("move-east",()=>{D.clearPath(),D.walk("east")})}static walk(e){if(D.isBlocked)return!1;if(K.movement.isMoving)return K.movement.currentFrame>oe-oe/3?(D.queuedMove=e,!0):!1;const s=D.getTargetPosition(K,e);return le.isWalkable(s)?(D.move(K,s,e),!0):(K.sprite.loop("idle-"+e),!1)}static move(e,s,r){Ye.play("footstep"),e.movement.timeouts.forEach(i=>clearTimeout(i)),e.movement.timeouts=[],e.currentFrame=0,e.offset={x:0,y:0},e.movement.isMoving=!0;for(let i=0;i<oe;i++){const n=setTimeout(()=>{D.handleMovingFrame(e,s,r)},1e4/e.speed/oe*i);e.movement.timeouts.push(n)}}static handleMovingFrame(e,s,r){if(e.sprite.loop("walk-"+r),e.movement.currentFrame++,D.updateOffsetAfterAnimationFrameChange(e,r),e.movement.currentFrame===oe/2&&(e.position=s,X("hero-position-changed"),D.updateOffsetAfterPositionChange(e,r)),e.movement.currentFrame===oe){if(e.movement.isMoving=!1,e.movement.currentFrame=0,e.movement.timeouts.forEach(i=>clearTimeout(i)),e.movement.timeouts=[],e.isHero()&&D.queuedMove&&(r=D.queuedMove,D.queuedMove=null,D.walk(r)))return;if(D.path)if(ws(D.path.destination,s))D.clearPath();else{D.makePathStep();return}e.sprite.loop("idle-"+r)}}static getDirection(e,s){if(e.x<s.x)return"east";if(e.x>s.x)return"west";if(e.y>s.y)return"north";if(e.y<s.y)return"south"}static getTargetPosition(e,s){const r={north:{x:0,y:-1},south:{x:0,y:1},west:{x:-1,y:0},east:{x:1,y:0}};return{x:e.position.x+r[s].x,y:e.position.y+r[s].y}}static updateOffsetAfterAnimationFrameChange(e,s){({north:()=>e.offset.y--,south:()=>e.offset.y++,west:()=>e.offset.x--,east:()=>e.offset.x++})[s]()}static updateOffsetAfterPositionChange(e,s){({north:()=>e.offset.y=oe/2,south:()=>e.offset.y=-(oe/2),west:()=>e.offset.x=oe/2,east:()=>e.offset.x=-(oe/2)})[s]()}static clearPath(){D.path=null}static setPath(e,s,r=null){D.path={destination:{...e},action:s,actionData:r},K.movement.isMoving||D.makePathStep()}static makePathStep(){if(!D.path||ws(D.path.destination,K.position)){D.path=null,K.sprite.loop("idle-south");return}const e=[],s=le.positionServerToClient(K.position),r=le.positionServerToClient(D.path.destination);for(let i=le.firstTilePosition.y;i<=le.lastTilePosition.y;i++){const n=[];for(let o=le.firstTilePosition.x;o<=le.lastTilePosition.x;o++){const a={x:o,y:i};let l=ws(D.path.destination,a)?!0:le.isWalkable(a);n.push(Number(l))}e.push(n)}D.easyStar.setGrid(e),D.easyStar.setAcceptableTiles([1]),D.easyStar.findPath(s.x,s.y,r.x,r.y,i=>{var n,o;if(i===null){console.log("Path was not found.");return}if(D.path!==null){if(D.path.action==="use"&&(i.length===2||Yt(K.position,D.path.destination))){K.sprite.loop("idle-south"),Bt.use(D.path.actionData.itemId,D.path.destination),D.clearPath();return}if(D.path.action==="move"&&(i.length===2||Yt(K.position,D.path.destination))){K.sprite.loop("idle-south"),D.path.actionData.itemId===((n=le.getTileTopItem(D.path.actionData.fromPosition))==null?void 0:n.id)&&(Ct.grabItemFromFloor(D.path.actionData.fromPosition),Ct.releaseItemOnFloor(D.path.actionData.toPosition)),D.clearPath();return}if(D.path.action==="loot"&&(i.length===2||Yt(K.position,D.path.destination))){K.sprite.loop("idle-south"),D.path.actionData.itemId===((o=le.getTileTopItem(D.path.actionData.fromPosition))==null?void 0:o.id)&&(Ct.grabItemFromFloor(D.path.actionData.fromPosition),Ct.releaseItemOnInventory(D.path.actionData.slot??null)),D.clearPath();return}D.walk(D.getDirection(s,i[1]))||D.clearPath()}}),D.easyStar.calculate()}};G(D,"queuedMove",null),G(D,"easyStar",null),G(D,"path",null),G(D,"isBlocked",!1);let Et=D;class Fl{constructor(e,s){G(this,"name",null);G(this,"position",{x:null,y:null});G(this,"offset",{x:null,y:null});G(this,"sprite",null);G(this,"speed",25);G(this,"healthPercent",100);G(this,"movement",{isMoving:!1,currentFrame:0,timeouts:[]});le.creatures[e]=this,this.name=e,this.position=s,this.offset={x:0,y:0},this.sprite=ds.get("outfit").clone(),this.sprite.dye([Wi(),Wi(),Wi(),Wi()]),this.sprite.loop("idle-south")}isHero(){return this===K}move(e,s){Et.move(this,s,e)}}const Y=class Y{static init(){Y.width=ni,Y.height=oi,window.addEventListener("update-tiles",e=>{e.detail.tiles.forEach(s=>{Y.updateTile(s.position,s.stack)}),Ct.refreshPointer()}),window.addEventListener("add-creature",e=>{new Fl(e.detail.name,e.detail.position)}),window.addEventListener("hero-position-changed",Y.update),Y.update()}static update(){Y.firstTilePosition={x:K.position.x-Math.floor(Y.width/2),y:K.position.y-Math.floor(Y.height/2)},Y.lastTilePosition={x:K.position.x+Math.floor(Y.width/2),y:K.position.y+Math.floor(Y.height/2)};for(const[r,i]of Object.entries(Y.creatures))Y.isOnArea(i.position)||delete Y.creatures[r];const e=[],s={};for(let r=Y.firstTilePosition.y;r<=Y.lastTilePosition.y;r++)for(let i=Y.firstTilePosition.x;i<=Y.lastTilePosition.x;i++)s[r]=s[r]||{},Y.tiles[r]&&Y.tiles[r][i]?s[r][i]=Y.tiles[r][i]:(s[r][i]=[],e.push({x:i,y:r}));Y.tiles=s,Bt.requestTiles(e)}static getTileStack(e){return typeof Y.tiles[e.y]>"u"||typeof Y.tiles[e.y][e.x]>"u"?[]:Y.tiles[e.y][e.x]}static getTileTopItem(e){const s=Y.getTileStack(e);return s[s.length-1]??null}static updateTile(e,s){typeof Y.tiles[e.y]<"u"&&typeof Y.tiles[e.y][e.x]<"u"&&(Y.tiles[e.y][e.x]=s)}static isWalkable(e){const s=Y.getTileStack(e);return!(!s.find(r=>r.getType()==="ground")||s.find(r=>r.isBlockingCreatures()))}static isOnArea(e){return e.x>=Y.firstTilePosition.x&&e.x<=Y.lastTilePosition.x&&e.y>=Y.firstTilePosition.y&&e.y<=Y.lastTilePosition.y}static positionClientToServer(e){return{x:e.x+Y.firstTilePosition.x,y:e.y+Y.firstTilePosition.y}}static positionServerToClient(e){return{x:e.x-Y.firstTilePosition.x,y:e.y-Y.firstTilePosition.y}}};G(Y,"width",null),G(Y,"height",null),G(Y,"firstTilePosition",{}),G(Y,"lastTilePosition",{}),G(Y,"tiles",{}),G(Y,"creatures",{});let le=Y;const M=class M{static init(){const e=document.createElement("canvas");e.id="board",e.width=oe*ni,e.height=oe*oi,e.style.transform="scale("+M.scale+")",document.querySelector("#app").append(e);const s=document.createElement("canvas");s.id="hud",s.width=oe*ni*M.scale,s.height=oe*oi*M.scale,document.querySelector("#app").append(s);const r=document.createElement("canvas");r.width=oe*ni,r.height=oe*oi,M.ctx=e.getContext("2d",{alpha:!1}),M.ctx.fillStyle="#25131a",M.hudCtx=s.getContext("2d"),M.tempCtx=r.getContext("2d"),M.tempCtx.fillStyle="#25131a",window.addEventListener("resize",M.onResize),M.render()}static render(){M.tempCtx.fillRect(0,0,M.tempCtx.canvas.width,M.tempCtx.canvas.height),M.hudCtx.clearRect(0,0,M.hudCtx.canvas.width,M.hudCtx.canvas.height);for(let e of["ground","objects"]){let s=0;for(let[r,i]of Object.entries(le.tiles)){let n=0;for(let[o,a]of Object.entries(i)){const l={x:n,y:s},h={x:Number(o),y:Number(r)};M.renderTile(l,h,e,a),n++}s++}}M.renderTexts(),M.renderPointerEffect(),M.ctx.drawImage(M.tempCtx.canvas,-K.offset.x,-K.offset.y),window.requestAnimationFrame(M.render)}static renderTile(e,s,r,i){if(r==="ground"){i.filter(n=>n.getType()==="ground").forEach(n=>{M.drawSprite(e,n.getSprite())});return}if(r==="objects"){let n=0;i.filter(o=>o.getType()!=="ground").forEach(o=>{M.drawSprite(e,o.getSprite(),n),n+=o.getAltitude()}),Object.values(le.creatures).filter(o=>ws(s,o.position)).forEach(o=>{M.drawCreature(e,o,n),M.drawNickname(e,o,n),M.drawHealthBar(e,o,n)}),Ur.getRunning(s).forEach(o=>{o.customData.onCreature??!1?M.drawSprite(e,o,n+Math.ceil(oe/8)):M.drawSprite(e,o,n)});return}}static drawSprite(e,s,r=0){const i=s.getFrame(),n=e.y*oe+(oe-i.height)-r,o=e.x*oe+(Math.ceil(oe/2)-Math.ceil(i.width/2));M.tempCtx.drawImage(i,o,n)}static drawCreature(e,s,r=0){const i=s.sprite.getFrame(),n=e.y*oe+(oe-i.height)-Math.ceil(oe/8)+s.offset.y-r,o=e.x*oe+(Math.ceil(oe/2)-Math.ceil(i.width/2))+s.offset.x;M.tempCtx.drawImage(i,o,n)}static drawNickname(e,s,r=0){let i=e.y*oe-r,n=e.x*oe;s.isHero()||(n=n-(K.offset.x-s.offset.x),i=i-(K.offset.y-s.offset.y)),i*=M.scale,n*=M.scale,M.hudCtx.fillStyle="#dce1e3",M.hudCtx.strokeStyle="#000000",M.hudCtx.font="15px Hind Vadodara",M.hudCtx.lineWidth=2,i=i-26*M.scale,n=n+oe*M.scale/2-Math.ceil(M.hudCtx.measureText(s.name).width/2),M.hudCtx.strokeText(s.name,n,i),M.hudCtx.fillText(s.name,n,i)}static drawHealthBar(e,s,r=0){const i=ds.get("hp-bar").getFrame();let n=e.y*oe-r,o=e.x*oe;s.isHero()||(o=o-(K.offset.x-s.offset.x),n=n-(K.offset.y-s.offset.y)),n*=M.scale,o*=M.scale,n=n-23*M.scale,o=o+oe*M.scale/2-Math.ceil(i.width/2),M.hudCtx.fillStyle="#000000",M.hudCtx.globalAlpha=.5,M.hudCtx.fillRect(o-1,n-1,i.width+2,i.height+2),M.hudCtx.globalAlpha=1,M.hudCtx.drawImage(i,o,n,Math.ceil(i.width*s.healthPercent/100),i.height)}static renderTexts(){M.hudCtx.font="bold 18px Hind Vadodara",M.hudCtx.lineWidth=2;for(let e of Object.values(M.texts)){const s=le.positionServerToClient(e.position),r=(s.y*oe-K.offset.y)*M.scale+e.offset.y;let i=(s.x*oe-K.offset.x)*M.scale+e.offset.x;i=i+oe*M.scale/2-Math.ceil(M.hudCtx.measureText(e.content).width/2),M.hudCtx.fillStyle=e.color,M.hudCtx.strokeText(e.content,i,r),M.hudCtx.fillText(e.content,i,r)}}static renderPointerEffect(){if(!Ct.effect)return;const e=Ct.effect.sprite.getFrame(),s=Ct.effect.position,r=K.offset;M.tempCtx.drawImage(e,s.x+r.x-e.width/2,s.y+r.y-e.height/2)}static addFloatingText(e,s){const r=Ac(8);M.texts[r]={position:{...K.position},content:e,offset:{x:0,y:-(oe/2)},color:s,iteration:0};const i=setInterval(()=>{M.texts[r].offset.y--,M.texts[r].iteration++,M.texts[r].iteration>=30&&(delete M.texts[r],clearInterval(i))},25)}static onResize(){const e=window.innerWidth<=vh?gh:yh;M.scale!==e&&(M.scale=e,M.ctx.canvas.style.transform="scale("+M.scale+")",M.hudCtx.canvas.width=oe*ni*M.scale,M.hudCtx.canvas.height=oe*oi*M.scale)}};G(M,"ctx",null),G(M,"tempCtx",null),G(M,"hudCtx",null),G(M,"scale",window.innerWidth<=vh?gh:yh),G(M,"texts",{});let Js=M;const F=class F{static init(){document.addEventListener("mousemove",e=>{F.recalcMousePosition(e),F.isLeftButtonPressed&&!F.grabbing.item&&(e.target.id==="board"?F.grabItemFromFloor({...F.positionServer}):e.target.classList&&e.target.classList.contains("slot")&&e.target.closest("#inventory")&&F.grabItemFromInventory(e.target.dataset.slotId))},!1),document.addEventListener("mousedown",e=>{F.recalcMousePosition(e),(e.which===1||e.button===0)&&(F.isLeftButtonPressed=!0)},!1),document.addEventListener("mouseup",e=>{F.recalcMousePosition(e),(e.which===1||e.button===0)&&(F.isLeftButtonPressed=!1,F.onLeftButtonRelease(e))},!1),document.addEventListener("contextmenu",e=>(e==null?void 0:e.cancelable)&&e.preventDefault())}static recalcMousePosition(e){const s=Js.ctx.canvas.getBoundingClientRect(),r={...F.positionClient};F.positionWindow={x:e.clientX,y:e.clientY},F.positionCanvas={x:(e.clientX-s.left)/(s.right-s.left)*Js.ctx.canvas.width,y:(e.clientY-s.top)/(s.bottom-s.top)*Js.ctx.canvas.height},F.positionClient={x:Math.floor((F.positionCanvas.x+K.offset.x)/oe),y:Math.floor((F.positionCanvas.y+K.offset.y)/oe)},ws(F.positionClient,r)?F.positionServer=le.positionClientToServer(F.positionClient):F.refreshPointer()}static refreshPointer(){if(F.positionServer=le.positionClientToServer(F.positionClient),F.grabbing.item)return;const e=le.getTileTopItem(F.positionServer);if(!e){F.setCursor("default");return}if(e.isPickupable()){F.setCursor("hand");return}if(!e.isUsable()){F.setCursor("default");return}if(e.getType()==="ore"){F.setCursor("pick");return}if(e.getType()==="chest"){F.setCursor("chest");return}F.setCursor("gears")}static onLeftButtonPress(e){}static onLeftButtonRelease(e){if(F.grabbing.item){if(e.target.id==="board")return F.releaseItemOnFloor({...F.positionServer});if(e.target.classList&&e.target.classList.contains("slot")&&e.target.closest("#inventory"))return F.releaseItemOnInventory(e.target.dataset.slotId);F.cleanGrab(),F.refreshPointer();return}if(e.target.id!=="board")return;const s={...F.positionServer},r=le.getTileTopItem(s);if(r){if(r.isPickupable()){F.runEffect("pointer-cross-red"),Yt(K.position,s)?Bt.moveItem({action:"loot",itemId:r.id,quantity:r.quantity,fromPosition:s}):Et.setPath(F.positionServer,"loot",{itemId:r.id,fromPosition:s});return}if(r.isUsable()){F.runEffect("pointer-cross-red"),Yt(K.position,s)?Bt.use(r.id,s):Et.setPath(F.positionServer,"use",{itemId:r.id});return}F.runEffect("pointer-cross-yellow"),Et.setPath(F.positionServer,"walk")}}static grabItemFromFloor(e){const s=le.getTileTopItem(e);s&&s.isMovable()&&(F.grabbing.item=s,F.grabbing.fromPosition=e,F.setCursor("crosshair"))}static grabItemFromInventory(e){const s=Re.getSlot(e).item;s&&(F.grabbing.item=s,F.grabbing.fromSlot=e,F.setCursor("crosshair"))}static releaseItemOnFloor(e){const s=F.grabbing.item;if(F.grabbing.fromPosition){const r={...F.grabbing.fromPosition};if(F.cleanGrab(),F.refreshPointer(),ws(r,e))return;Yt(K.position,r)?Bt.moveItem({action:"move",itemId:s.id,quantity:s.quantity,fromPosition:r,toPosition:e}):Et.setPath(r,"move",{itemId:s.id,fromPosition:r,toPosition:e})}else{const r=F.grabbing.fromSlot;F.cleanGrab(),F.refreshPointer(),Bt.moveItem({action:"drop",itemId:s.id,quantity:s.quantity,fromSlot:r,toPosition:e})}}static releaseItemOnInventory(e){const s=F.grabbing.item;if(F.grabbing.fromPosition){const r={...F.grabbing.fromPosition};if(F.cleanGrab(),F.refreshPointer(),!s.isPickupable())return;Yt(K.position,r)?Bt.moveItem({action:"loot",itemId:s.id,quantity:s.quantity,fromPosition:r,toSlot:e}):Et.setPath(r,"loot",{itemId:s.id,fromPosition:r,slot:e})}else{const r=F.grabbing.fromSlot;F.cleanGrab(),F.refreshPointer(),Bt.moveItem({action:"swap",itemId:s.id,quantity:s.quantity,fromSlot:r,toSlot:e})}}static cleanGrab(){F.grabbing.item=null,F.grabbing.fromSlot=null,F.grabbing.fromPosition=null}static runEffect(e){const s=ds.get(e).clone(),r={sprite:s,position:{...F.positionCanvas}};s.play().then(()=>{F.effect===r&&(F.effect=null)}),F.effect=r}static setCursor(e){e==="default"?fa.removeAttribute("cursor"):fa.setAttribute("cursor",e)}};G(F,"positionWindow",{x:null,y:null}),G(F,"positionCanvas",{x:null,y:null}),G(F,"positionClient",{x:null,y:null}),G(F,"positionServer",{x:null,y:null}),G(F,"isLeftButtonPressed",!1),G(F,"isRightButtonPressed",!1),G(F,"grabbing",{item:null,source:null}),G(F,"effect",null);let Ct=F;const _t=class _t{static async connect(e){return new Promise(function(s,r){_t.websocket=new WebSocket(sy+"?"+e),_t.websocket.onmessage=_t.onMessage,_t.websocket.onclose=_t.onClose,_t.websocket.onopen=()=>{_t.websocket.onerror=_t.onError,s()},_t.websocket.onerror=i=>{r(i)}})}static onMessage(e){let s=JSON.parse(e.data);X(s.event,s.params)}static onClose(){}static onError(e){console.log(e)}static emit(e,s){_t.websocket.send(JSON.stringify({event:e,params:s}))}};G(_t,"websocket",null);let Qa=_t;const or=(t,e)=>{const s=t.__vccOpts||t;for(const[r,i]of e)s[r]=i;return s},kb={name:"Slot",props:{id:String},data(){return{item:null,sprite:null}},methods:{onClick(){if(this.item){if(this.item.isUsable()){Bt.use(this.item.id,null,this.id);return}if(this.item.isEquipable()){this.id.includes("equipment-")?Bt.unequip(this.id):Bt.equip(this.item.id,this.id);return}}},set(t){var s;this.item=t,(s=this.$el.querySelector("canvas"))==null||s.remove();const e=this.item.getSprite().clone();e.getFrame(),this.$el.appendChild(e.canvas)},clear(){var t;this.item=null,(t=this.$el.querySelector("canvas"))==null||t.remove()}}},Ub=["data-slot-id"],Db={key:0,class:"quantity"};function Gb(t,e,s,r,i,n){return st(),Jt("div",{class:"slot","data-slot-id":s.id,onClick:e[0]||(e[0]=o=>n.onClick())},[i.item&&i.item.quantity>1?(st(),Jt("div",Db,fr(i.item.quantity),1)):$s("",!0)],8,Ub)}const sf=or(kb,[["render",Gb]]),Hb="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAApCAYAAAAmukmKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAhKSURBVHjapJh7cFTVHcc/9+7uXfa9mwchIUB5FMIQA04oPrACpogErIpTtTPa0Y7UWv+o9Q8dB6ft6LR/+EedTmfqTFtbHVrt1IKCFBtAfCAhGLQhD8mDPDDkRTAJbDbZe+7j9I/cDbvLJmh7Zu7embPnns89v8f3/M5VKisr+ZrN/esXX9ru9XqrvB5tLShRr9dbJm0byzQYH48P6vrE6KSebNR1/XBHR8fefW/tHQMkgPIVga5dv3ihsqCw8PFgIHS3qqpRpETaEiklSIllmQg9iS6SWJY5NTsgpdQTE+P//NXzz+8EJt3XAKk/e/rZ1YuXLH0pGAhuQDINSN2REtu2MYRAGHoGDEBRFW9ifGIlUAD0zgisvvOuyIZNVbsKCuc+qaB4mAYwfUkHbBoCw9AxzUxYqh0/fuxzQAOYCRi8/Y5teyLRSJWUTIGQU5M5kGmYaSAMHcM0UiPSlgd9fX3x+pMnjwJjOYHrv70h/977v/9mJBrZNA2TKWYmzLIsDKFjGgIp7atgKAqHa2reAxqBSwBqFi+w474H/haLxbJgV/tNWhamoWOYAsu2MtemTP18Wl/f39Z65i2gBzCzV6jt+uULz+bl5W1Jh00DHL8ZhsFnn51K9vR0JgxD2D6fzzU0NJT0+XwuTdNctm2jqqqieb0TH7x/9DWgPmXOdKByy60bVyxesuxpmfGqV0BIyftHD4+3NDcObdpUFa3eui1fGDq2lDlNeb63d6Tm3YOHgHOAlQ30baza/IzLpXpy+W1sbFTue3vPwNq169Rbbrl1qdAn0YU+ZeIcMICPP/qwBjgPTGSohnOfu2Dhgrtz+W1gsN/a//aergcffHiRpnm1S2MjRlNTw/iXI19KKaWaDtO8Xk/ZypW+0ZGRsdMNDZ+kmzId6Nn5+BMPeDzeQDYskUjImncPdD7yyI+WdnWdvdjcdHoyFosGlyxdEl513XVaZpBAMpk0Pm9pGWxpbjoCNAGXr5KskpKS2JbqO5/Ozy9Y4mjRdGK/vvvVrtu3bI0dP/7R2cLCuXkVFRXFhXML/R5Nc+UypdvjcRWXlITKK1avWlNZ6bel/X5fb28yQ7qAWF5+fvn06hxod3fnZCgU7m9ubmzbtLHqunlFRXmmKWYMkithBoqqusORyMNr1924BwhmA8ORcKQwO99O1tW2qqo6vGHDbTdKabsMU2Db9jVhErAsC10XaF7vbT94dOefAF860Od2uV3pMEMI2fvFuTNb7ti2zTJNVy5RTiV3OgzAtm10IRBCx7ZtotHY/dvv3vFQKkBVwJ0tym1tZ0Y2b76jQlXwzibKabwpGCAMA6HrmKY1LYFF84p3AXkpoJItyu1trRe+uXzFytlEOZcpDQcmhOHMNdU/x+9b+K2bbt4IuFRAmoawU7DPW5ovD1+8MCxtyzWbKGfDTNOcgukiDXZFqQrnFm0H/G7AvDg8HA/4A+GD/3qn79Chgweqq+9cPJsom6ZJe2ur3t3TPR4MBpXR0VErlpfnX7hosX+O3z9lMSRDAwNmT1dnwh8IxotLS68HIm5gvOE/n9Uf++iD5OBg/wfAmVA49GPTNHLAIDGRkEdqas7Vnah9D+gFhPPv/A1V39luCBGtXHdDeKC/3zjf+0V3fd2Jo1u2f3e9oQsLCLiB4Tf/8fqLjmU6AE8sGp2XO0gUmpsa++tO1L4MfAgMpQlz8YfvHWlZuar8exI22tIer/v42MtAc82B/aeq79pxTypoLgKfALXOG2Napmcmv0Wjsclndj23A2h39rle52oEjkRjsV4pJQUFcwNAA3AKaAyEgipguR2TiHQxkBJ1piBZXla2bKC/f2LnT554zuv1qoZplrhU98Lf//Y3m4GhEx8fO7xq9ZoHNM2rAboj4PFgMFwOuNVZa7asPEuZuai4uKJo3rynvHN8TyqKWj05OVH8w8ce3+c8MagndV0C2++591Gg6LGfPtVo27YG+NRrVqSKchVUCIGuC0zTRNO0YDAUWuQPBG+778GHfg4kzal8wjCMAqDcMEzTsixtphWa5/vOd/ac656YKbl1XWAYmcktkcQvxxcB8o3X/vJKPH55vObA/hogpCcnDVva6kxlYrzm3YO7geEbb7p56107dizIFmUhpoR8unh0bO33B5Y51dmhv77yx27gNOC+MuLqqg3ngVrg1boTtX8eHRsTuUQ5fe9MKUogFCx1qrOTwH5nE55UFKTiQHMBhZNfnwLHJhKJ+EyinCFfQCAQzAtHIvnAONAHxAE7funyqDbHFwDU2YJGAGP+QMA9kyinw6SckviV5RU3ZLlKoCi22+32XDstQJFSumYT5RQs1cLR2BrAn7lrKakB1wQan9Z/0qzrAkumNqnpOoS0E8d0zRyORFYDoXSg0JOT04epawAvHj18ePf+vXuaEvG4TQ6/kR6CQDgcWQKE09NMCD0+W5RmAIEjZ9vbfvfG7tcOdnd1TubyWypgATxeLVA8v7Q0TadMRVHNrwrUgS7gwEQi8fKBt/b+4d/v7G8fHRmxcsFSPQu+sfh6wJOlGcx2PsxQHmAQOAb0d3a0n+nsaF+/bEXZ+vLVaxYUFc/3pMOQEAyFVzmBIwDr0thovyFEErC/CjD1lnGgGegHTp9ta60929a6tnh+6bqly1csXraiLKBpXkUCwVCoDAg4O4XhdrvjFwYHWgDdVVJS8nW+YNhAwhGGbqBjPH659Yue7nMNp+rHxkZHvYqCHQpHtJbTDX8HvgTmFBWXlJ5pOl03kUg0K//DZ5OMo4JTWRcCpcByYKFzajrk+D8IFDtWGnTz/zXL0d5LzjmwGYg5/RecMUmnIrAB478DANU4CNr1bvK3AAAAAElFTkSuQmCC";const $b={name:"Equipment",components:{Slot:sf},data(){return{visible:!1}},methods:{getSlot(t){return this.$refs[t]},getSlots(){return this.$refs},toggle(){this.visible=!this.visible,this.visible?Ye.play("inventoryOpen"):Ye.play("inventoryClose")}},mounted(){jr().setEquipment(this),window.addEventListener("update-equipment-slot",t=>{t.detail.itemId&&t.detail.quantity>0?this.getSlot(t.detail.slot).set(new tt(t.detail.itemId,t.detail.quantity)):this.getSlot(t.detail.slot).clear()}),window.addEventListener("equipment-toggle",this.toggle)}},Vb=_e("img",{src:Hb,alt:"Eq"},null,-1),qb=[Vb],Wb={class:"header"},jb=_e("div",{class:"header-icon"},null,-1),zb=_e("span",{class:"header-title"},"Equipment",-1),Xb={class:"container"},Kb={class:"slots"};function Zb(t,e,s,r,i,n){const o=Hs("Slot");return st(),Jt(xt,null,[_e("button",{class:ki(["bookmark-equipment",{active:i.visible}]),onClick:e[0]||(e[0]=a=>this.toggle())},qb,2),_e("div",{id:"equipment",style:er({display:i.visible?"block":"none"})},[_e("div",Wb,[jb,zb,_e("button",{onClick:e[1]||(e[1]=a=>n.toggle()),class:"button-close"},"✕")]),_e("div",Xb,[_e("div",Kb,[se(o,{ref:"equipment-helmet",id:"equipment-helmet"},null,512),se(o,{ref:"equipment-armor",id:"equipment-armor"},null,512),se(o,{ref:"equipment-belt",id:"equipment-belt"},null,512),se(o,{ref:"equipment-boots",id:"equipment-boots"},null,512),se(o,{ref:"equipment-amulet",id:"equipment-amulet"},null,512),se(o,{ref:"equipment-cape",id:"equipment-cape"},null,512),se(o,{ref:"equipment-weapon",id:"equipment-weapon"},null,512),se(o,{ref:"equipment-shield",id:"equipment-shield"},null,512),se(o,{ref:"equipment-glove",id:"equipment-glove"},null,512),se(o,{ref:"equipment-ring",id:"equipment-ring"},null,512)])])],4)],64)}const Qb=or($b,[["render",Zb]]),Yb="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAApCAYAAAC/QpA/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAA31SURBVHjazJhpbFzndYaf726zcWbI4ZDDGXK4iZJIiqIWapelOo6t2LFsN04cu02CNkECFAWaomjS1vlRoGmBBkGLtkgaZGus2K5jC97iWJYdRUpiqVIsS4ooURuphaQk7stwOMvdv/4gozJJ5coFCvQFzr33x73nvPfcc97zfVf09PRwhwjv2PXAnmAo9FihULgQ0rXPXB64qjc1Zs8d/umB2dVbtsqzvzimdG3enNU0fXNtOv2NTEND9djIza+/uXfvF9vW95iqqv6W00vvHr91rWYymTslU2Pb7s5t27ev7V7VUROMRD6rCPXTiaqq2miiunpmdiZaW5OUja3LftbQ1Pi55uamcCRcQTAU3DSbn6++2nv6YLy21vV9n6U2Ozb2vyITKuRzsVCk4u76upQRCIZobm6hJplYJwWPaJqWqK1LtXWvWfvhyngc0zQBSVU8jhEIrZ+dnnr9ev+lkc41a4lWVNyy61cu3wqgcOfIAb0X+84czs+XpCqgWJjHcRxWtrUR0vWGK/0DrZ7jIKQkHAggHY9yocCy5mZ13abN/wJEa5I1LLWleD9kbGAgNzP9o9zMjCUQ6JqGUFSkL0mlUmuAB+dnc4SNALqiEtB1yqUSk2PjvlU224Bas1RiqS2FxvvD/HyxLA689caRP/rjz9/r46MAnuvR0tyiDQ0OajMzMyxrbaVQKOA6Dj/Zv//q5UuXzgshjgFKwDBu6/z9kglMTs+s8zx/2ejITZpbWrBME0PXUXWNdKoOKSW+76EoCs//+7N9YyM39wCnpZSjwOiN69dv6/z9FDBANB6NFEqlYt3w8FBy1apVkXg8jmEYICWxaBQ9YOBLnxeee+7s2MhIb20qlS8UCnvrss0jUlHt3GyOmemZW2aVireci9vpzI57dwVt2w6mampUVVHuO3/hwg9Wr+r8s0OHDm0++e6JdZFwuK4iGo/XJJMkk0myjY30bOghGAzw7DPfP16YLxzbtHX7ny5ra5sMBoOzL7/yyrXhK/0fzTS1FpfGGRm6+j9+pnCiuvrfCsXiE91r15wbuno1mkqlPMfzvzoxMaV3dq3m4d27OdN7hgMHDnD9+jBCVQgGA8TicSzbPup4XnF6eurCgTf3Hdm8fcfvdXd31Q9f6U/v2HnX5aWBXnjmvcmEVnSt29OzYeMj3/j613oP7fvRK7V16Y7xsfGVsVjUBjY2NjaKrdu28YG7P4Dj2EQqKvjUpz6F7ThIoCIe+5OfvPXmP5x6951/AhK5uTlq03UGUG1a1uU7LWAlHKu6q72z47EXf/Dc6WsDl/oUoeTGR0deAmX7ujXrNk/PzjpzuTnDNi10VSUer6RULuG6LlJKhKLSvnKlqgjx50fe/vlnc7lcsCGbrTh5/PhpwD99uveOuynWtqLjqw31Dbz+6stlCb0eYsvK9s6Xtm/d9snRsbHq/oHLfOITv08oGMD3JfF4nPx8fsGZpiEBwzBY37Ne8zz/X48dO/rzs7889dLE2OhhYCIQCNyWzK+Jnqqq6cbGxjbXddGNQCxsGBfv33XfzEMPP/I9PWBU/8fRI+z60H20d7bjOA6ua1NZGcdxHIQAoYCigud75HNzZDKZyMr29rsd2z4G/BgYDxoBkIJCoUQ+X7h9a0spa0duDMdT6fSKdH06UioWzzc0ZJdHwpH1z//geR796MfYuXMH+Xwe23UJGAalcplz58+zcdNGdF1HCIFjO8zMzKCogqrqhB6Nxj9oBILvTIyNnq2rz/qu61I2TXzfp5TP3VZnPNu2ShfP9Y1f7e9/OxSpCI+MjS7/ycFDrY9+5FGRrKlhZGyURCKBEAqe7xMKhxgcHCSZTNJQX09uNkepWMT3PTzfQ0WQTmcU1/d224575WJf74Xq2jrftm0Aiu9BxgLGgUFVD7bu/t2P/PWWbVuXNzRkxdXBa5ztO8u2bXcRr6xE1RR83yccChGJhDnT20vrsmVMT0/hs6DAQgCKQEqoTdaorus9ZNrOxWv9Fy5VVCZ8KeWvkfnNQekvTucbKzo6N+zc+Tt6c1MLJ949QW/vaR5/4gkymTSmaeJ5EkVV0RSV1V1dZBuzHD/+DoZhIJEIIVEEKAI810UoChs2btA7V3U9m0zXPzQ2dEVbYPve40CrzTQ+8eCDDz/Z1NLEl/7qSQYGBvjiF77Iqs5OioUCSAm+BMD1XEolE13TcDyXeDxOJBxGSgGLrS5QkD6oqkq6PqPMF0qPTs3M9s1NjA4sJuC2S4iKbLbx4R077mLv83s5d+4cn/7Dz9DVtRrbMlGFQFc1dFUFKTFNi3K5TCgcJpPOMDo6xuTENIFAEEUzUDVtYXhKn1KpRKlYom15m96yrO27qqYl3yszSrapdedHPvrY383N5fjK33+FBz78YR7/+GOoykJCkOBLHyEkpmlSKhaxHItwOIJpWuz70WvO24ePKImqhEil6nBcByEEZbOMZVuUTROkIFWXCgZDIffm8NBhwPvvyMTu2XX/tzdu2pD98t/8LdXVVTz5l39BMBDAsR0cxwN8pO9huw6OY1Mumxi6gZSSo0ePlE6eOHHALJcmJicnoxWxilB9QwPz+XlKpRI+El8KBAJNVdEDwbu0QDAfq0pcmpmcMJcqsEjXZ9vv2rFj7bGjR3EciyeffJJ4ZRX52TkEKrqm4DhlTLOMZdt4rktFJAwI3jl+3D544MAe4C1VVcXkxPjWt/bv/2Q+P1/f3NyMoqr4i6n1AVVRqayqQtG0R8qW2QccXJqZ2IcefOSljvaObCwW54P3fJCGhgbKZRNVVcCX2I6F5VhYtoVlWgAkqqoYHLzGG2/sGyqXSv8MHAauASOWaeZv3Li5Qg8EY9XJaoSqYDs2mrpQR6FgENf3Gx3HuWdi5MZTSwu4VlVE4qk9e5icnCSdyVAqlhbaUgh8fGzbwrVthC/RVIVQMMDQ0BD7Xn99enpq6tvA+cZsNm877jxwAfihWSp+89SJd4fO9Z11PNdb8CUlUkpsxyEWjVKXTkeBuqVkIv0DA8bPDh1iz/efwnYsjGBgQd4dm1KpiONYC5NZqASMILbtcujQwelr1659BzgETHiqjuv5bN663QL6gdeK+bl/PHPql4eHh4cRQllUBoll2xiGQWU8rgIVS8mYV/sv/vi+XffJ2dkcJ06coDqZwPEciqUSpVIBz/EQQkEogkhFhJMnT3Hh4sWjwGtAX0f32nLZttmwZSsz+TzZthW/IvR6IBh8JxaPLYiilAghUIWCYQQwDP2WzohEKhOJxCoV13VOZLNZJ5Go4uVXXsb3fTRNpVAsgFCQCFzpI4WgZJqs7VlHV/eaXXWZ+nrADkciSM+juqYGy3FwPQ/AaVvZUduzecvn4rE4tmWjKgKBRNU1pBDYtntLZ/Rsc8t9lYnqL6UzmWhra+uKjo7OwDNPP41pW6ztXoNt25hlE4RESoHn+7i+RzAUIl1Xp5XK5kPJVOr0yV8cuxKOxmRVZSWlUonrl/uVqpra7pXtnftbW1trpJRID4RQkRIMI0C+MM/ExIQzdLn/aTWTyYTrs43bVqxs325bpoxEY80PPPBAIB6P8p1vfQvHdeno7ERRFYSi4HourudhOTa52Ry+D6m6Wj0YCN5bLJvpfD4/fe3ShfHc1KSIxCtXp+sb9nevWZsKBAK/yhRIH4RAKArDQ0P+0OC1S7mpyZfUTCZTVdvQ/I1VXV3rxkduXHY8r3llR3tgTfcaNE3nhRf2EolEWN3dtaCk5TJl08Q0TcplE9+X6AGDaCwWicXjW2ZnZ+8NRyremM/PlRuamj6/vmfjh6LRGKZlIYSCLyW+76OoGqVyif6L58cnR27utS3ziJrJZJru3737C83NLUbzstb6ffveCJ/vOydWLF9Oz6aNBAIGb+7fTzqVprVtGdPT05jWAomFtxPYjo0vJam6OqqTySopxI54ZWK+s6vry7WpOq1ULqOqKqquAwJN0zEti/5LF8oXTp/6rmWWXwUG1Uwm07Jm/cZPVyUSektLi1FfXy/6zp7l6NGjVCWquHvHTnK5HKOjo7S3dzA+PobnSzzfRyJBgKIoSCmxLItIJEJFRTRVVZ3cXZOsNVzXQdU0FEXFlz6aqjM/X6DvzBmz79Q7z/q+/yJwBiipmUwmW5tp+IOKiqieqqsjGo2yZctWpqYm+OGrP0TTNFa2t3PmzBlSqRSu6+G6C3WDlKjKQqtLH3x/YTprui4ioYjiSx/f9wgEDKQEVVGYGBvzj//i2NzwlUuvuI7zHHASmAekBjBy8yZNTU1UVITJz80hfZ/du3fT1bWanx48yMClfgKGwXw+TzQWQ9M0XE8uLCvVhaxI6aNpAiEEnucBEkM30DUDVVUxzQI3rl/3Th57+9j01ORB4OfAL4H80q1K+frg1SM1NcmdDz60OxiPV2KWy+iqivQ9TMvi8sWLnu9aQ0JQX1WdDGi6jucvFKIQYoEMEuTixBUCH1AkIBZaeejasD9x88rB+fzc08C7wAhQ/M1903h+dvp7P/vx/tFMJv2x1uUrI02NjVy+MsAze54anRgduaIo6qDnuefPn+ldJhTRKaU0FuPcFvLWAYQQ0nXdQc91XlzMyET3ph1+ZVWMt9/a92tkphfnytQbr72qZJpaH//4xx833v7podHxkZvfBE55njsCzFiWWQmkAeO/Qt0R5GKcy8BUz/Z7fMdxfuumpX8hYsAWYDdQt1hY+xYd/OpJAaiLZ/k+/+34iys6/062twXgOHATCANTwChg/sYzLv9HEFJK/r/gPwcAv4uqaq254TAAAAAASUVORK5CYII=";const Jb={name:"Inventory",components:{Slot:sf},data(){return{visible:!1}},methods:{getSlot(t){return this.$refs[t]},getSlots(){return this.$refs},getFirstSlotWithItem(t){for(const[e,s]of Object.entries(this.getSlots()))if(s.item?s.item.id===t:t===null)return e;return null},toggle(){this.visible=!this.visible,this.visible?Ye.play("inventoryOpen"):Ye.play("inventoryClose")}},mounted(){jr().setInventory(this),window.addEventListener("update-inventory-slot",t=>{t.detail.itemId&&t.detail.quantity>0?this.getSlot(t.detail.slot).set(new tt(t.detail.itemId,t.detail.quantity)):this.getSlot(t.detail.slot).clear()}),window.addEventListener("inventory-toggle",this.toggle)}},ex=_e("img",{src:Yb,alt:"Inv"},null,-1),tx=[ex],sx={class:"header"},rx=_e("div",{class:"header-icon"},null,-1),ix=_e("span",{class:"header-title"},"Inventory",-1),nx={class:"container"};function ox(t,e,s,r,i,n){const o=Hs("Slot");return st(),Jt(xt,null,[_e("button",{class:ki(["bookmark-inventory",{active:i.visible}]),onClick:e[0]||(e[0]=a=>this.toggle())},tx,2),_e("div",{id:"inventory",style:er({display:i.visible?"block":"none"})},[_e("div",sx,[rx,ix,_e("button",{onClick:e[1]||(e[1]=a=>n.toggle()),class:"button-close"},"✕")]),_e("div",nx,[se(o,{ref:"inventory-1",id:"inventory-1"},null,512),se(o,{ref:"inventory-2",id:"inventory-2"},null,512),se(o,{ref:"inventory-3",id:"inventory-3"},null,512),se(o,{ref:"inventory-4",id:"inventory-4"},null,512),se(o,{ref:"inventory-5",id:"inventory-5"},null,512),se(o,{ref:"inventory-6",id:"inventory-6"},null,512),se(o,{ref:"inventory-7",id:"inventory-7"},null,512),se(o,{ref:"inventory-8",id:"inventory-8"},null,512),se(o,{ref:"inventory-9",id:"inventory-9"},null,512),se(o,{ref:"inventory-10",id:"inventory-10"},null,512),se(o,{ref:"inventory-11",id:"inventory-11"},null,512),se(o,{ref:"inventory-12",id:"inventory-12"},null,512),se(o,{ref:"inventory-13",id:"inventory-13"},null,512),se(o,{ref:"inventory-14",id:"inventory-14"},null,512),se(o,{ref:"inventory-15",id:"inventory-15"},null,512),se(o,{ref:"inventory-16",id:"inventory-16"},null,512),se(o,{ref:"inventory-17",id:"inventory-17"},null,512),se(o,{ref:"inventory-18",id:"inventory-18"},null,512),se(o,{ref:"inventory-19",id:"inventory-19"},null,512),se(o,{ref:"inventory-20",id:"inventory-20"},null,512),se(o,{ref:"inventory-21",id:"inventory-21"},null,512),se(o,{ref:"inventory-22",id:"inventory-22"},null,512),se(o,{ref:"inventory-23",id:"inventory-23"},null,512),se(o,{ref:"inventory-24",id:"inventory-24"},null,512)])],4)],64)}const ax=or(Jb,[["render",ox]]),lx={name:"Vitality",data(){return{health:0,mana:0,maxHealth:0,maxMana:0,healthPercent:0,manaPercent:0,states:[]}},mounted(){jr().setVitality(this),window.addEventListener("update-vitals",t=>{if(typeof t.detail.health<"u"){const e=t.detail.health-this.health;e&&(Js.addFloatingText(Math.abs(e),e>0?"#00ff00":"#ff0000"),this.health=t.detail.health)}typeof t.detail.mana<"u"&&(this.mana=t.detail.mana),typeof t.detail.maxHealth<"u"&&(this.maxHealth=t.detail.maxHealth),typeof t.detail.maxMana<"u"&&(this.maxMana=t.detail.maxMana),typeof t.detail.states<"u"&&(this.states=t.detail.states),this.healthPercent=Math.ceil(this.health/this.maxHealth*100),this.manaPercent=Math.ceil(this.mana/this.maxMana*100),K.healthPercent=this.healthPercent})}};const hx={id:"vitality"},ux=_e("div",{class:"icon"},null,-1),cx={class:"health-bar"},dx={class:"label"},fx={class:"mana-bar"},px={class:"label"};function mx(t,e,s,r,i,n){return st(),Jt("div",hx,[ux,_e("div",cx,[_e("div",{class:"indicator",style:er({width:i.healthPercent+"%"})},null,4),_e("div",dx,fr(i.health)+" / "+fr(i.maxHealth),1)]),_e("div",fx,[_e("div",{class:"indicator",style:er({width:i.manaPercent+"%"})},null,4),_e("div",px,fr(i.mana)+" / "+fr(i.maxMana),1)]),_e("div",null,[(st(!0),Jt(xt,null,wp(i.states,o=>(st(),Jt("span",null,fr(o),1))),256))])])}const yx=or(lx,[["render",mx]]);const gx={name:"DeadDisplay",computed:{SoundEffect(){return Ye}},data(){return{visible:!1,disabled:!1}},methods:{respawn(){Ye.play("confirm"),this.disabled=!0,setTimeout(()=>{const t=new Fl("Guest",{x:100,y:100});jr().setHero(t),Ur.get("energy").run(K.position,!0),Ye.play("login"),X("hero-position-changed"),X("update-vitals",{health:1}),Et.isBlocked=!1,this.visible=!1,this.disabled=!1},500)}},mounted(){window.addEventListener("dead",()=>{this.visible=!0,Et.clearPath(),Et.isBlocked=!0,delete le.creatures[K.name],Ye.play("dead")})}},vx={key:0,id:"dead-display"},_x={class:"container"},bx=_e("h2",{class:"title"},"You are dead",-1),xx=_e("div",{class:"subtitle"},"Your deeds of valor will be remembered.",-1),Ax={class:"buttons"},Tx=["disabled"];function wx(t,e,s,r,i,n){return i.visible?(st(),Jt("div",vx,[_e("div",_x,[bx,xx,_e("div",Ax,[_e("button",{onMouseenter:e[0]||(e[0]=o=>n.SoundEffect.play("click")),onClick:e[1]||(e[1]=o=>n.respawn()),disabled:i.disabled},"Respawn",40,Tx)])])])):$s("",!0)}const Ex=or(gx,[["render",wx]]);const Ix={name:"Loot",methods:{addItem(t){const e=document.createElement("div");e.classList.add("entry");const s=document.createElement("div");s.classList.add("content"),s.innerText=t.getName()+" ("+t.quantity+")";const r=t.getSprite().clone().getFrame();r.classList.add("image"),e.appendChild(r),e.appendChild(s),document.querySelector("#loot").appendChild(e),setTimeout(()=>{e.classList.add("hiding")},2500),setTimeout(()=>{e.remove()},3e3),Ye.play("pickup")}},mounted(){window.addEventListener("loot",t=>{this.addItem(new tt(t.detail.itemId,t.detail.quantity))})}},Sx={id:"loot"};function Cx(t,e,s,r,i,n){return st(),Jt("div",Sx)}const Rx=or(Ix,[["render",Cx]]);const Px={components:{DeadDisplay:Ex,Inventory:ax,Equipment:Qb,Vitality:yx,Loot:Rx},data(){return{initialized:!1}},methods:{async load(){await Ye.load(),await ds.load(Jm),await bt.load(ey),await Ur.load(ty)}},async mounted(){await this.load(),window.addEventListener("init",t=>{jr().setHero(new Fl(t.detail.name,{x:100,y:100})),ga.init(),Ct.init(),Et.init(),le.init(),Js.init(),Ur.get("energy").run(K.position,!0),Ye.play("login"),this.initialized=!0,setTimeout(()=>{X("update-vitals",{health:100,mana:50,maxHealth:100,maxMana:100})})});try{await Qa.connect("token")}catch{await br.connect("token")}}};function Fx(t,e,s,r,i,n){const o=Hs("Inventory"),a=Hs("Equipment"),l=Hs("Vitality"),h=Hs("DeadDisplay"),u=Hs("Loot");return st(),Jt(xt,null,[i.initialized?(st(),pr(o,{key:0})):$s("",!0),i.initialized?(st(),pr(a,{key:1})):$s("",!0),i.initialized?(st(),pr(l,{key:2})):$s("",!0),i.initialized?(st(),pr(h,{key:3})):$s("",!0),i.initialized?(st(),pr(u,{key:4})):$s("",!0)],64)}const Ox=or(Px,[["render",Fx]]);jr().setApp(document.querySelector("#app"));Pm(Ox).mount("#app");
